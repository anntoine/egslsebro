WP.globalVars={},WP.contents={},WPClass={};var webpublicationNamespace={Class:{},Main:{},Param:{viewBody:document.body},Utils:{}};!function(e){function t(){this.os={name:r,version:r},this.device={type:r},this.browser={name:r,version:r},h.call(this),c[this.os.name]&&(this.os.version=c[this.os.name]()),l[this.browser.name]&&(this.browser.version=l[this.browser.name]())}var n={IOS:"iOS",ANDROID:"android",BLACKBERRY:"blackberry",FIREFOX:"firefox",TIZEN:"tizen",WINDOWS:"windows",MAC:"mac",LINUX:"linux"},i={SAFARI:"safari",CHROME:"chrome",FIREFOX:"firefox",ANDROID:"android",TIZEN:"tizen",BLACKBERRY:"blackberry",IE:"ie",EDGE:"edge"},a={PHABLET:"phablet",TABLET:"tab",PHONE:"phone",DESKTOP:"desktop"},r="unknown",o=["android","blackberry","chrome","edge","firefox","ipad","iphone","linux","mac os","mobile","phone","safari","tablet","tizen","touch","trident","windows"],s={},p=navigator.userAgent.toLowerCase();for(var d in o)s[o[d]]=-1!==p.indexOf(o[d]);var c={iOS:function(){return(/CPU.*OS ([0-9]{1,5})/i.exec(navigator.userAgent)||["",r])[1]},android:function(){return(/Android ([0-9.]+)/i.exec(navigator.userAgent)||["",r])[1]},windows:function(){var e=(/Windows Phone ([0-9.]+)/i.exec(navigator.userAgent)||["",r])[1];if(e!==r)return e;var t=(/Windows NT ([0-9.]+)/i.exec(navigator.userAgent)||["",r])[1];switch(t){case"10.0":return"10";case"6.3":return"8.1";case"6.2":return"8";case"6.1":return"7";case"6.0":return"Vista";case"5.2":case"5.1":return"XP";case"5.0":return"2000";default:return r}},mac:function(){var e=/Mac OS.* ([0-9_]+)/i.exec(navigator.userAgent);return e[1]?e[1].split("_").slice(0,2).join("."):r}},l={chrome:function(){return parseInt((/Chrome\/([0-9]+)/.exec(navigator.userAgent)||["",r])[1])},firefox:function(){return parseInt((/Firefox\/([0-9]+)/.exec(navigator.userAgent)||["",r])[1])},ie:function(){var e=(/rv\:([0-9]+)/.exec(navigator.userAgent)||["",r])[1];return e===r&&(e=(/IEMobile\/([0-9]+)/.exec(navigator.userAgent)||["",r])[1]),e===r&&(e=(/MSIE\s([0-9]+)/.exec(navigator.userAgent)||["",r])[1]),parseInt(e,10)},edge:function(){var e=(/Edge\/([0-9]+)\./.exec(navigator.userAgent)||["",r])[1];return parseInt(e,10)},safari:function(){return parseFloat((/Version\/([0-9]+\.[0-9]+)/.exec(navigator.userAgent)||["",r])[1])}},h=function(){var t=Math.max(e.Param.viewBody.getBoundingClientRect().width,e.Param.viewBody.getBoundingClientRect().height);return!s.iphone&&!s.ipad||s.trident?s["mac os"]&&!s.trident?(this.os.name=n.MAC,this.device.type=a.DESKTOP,void(this.browser.name=s.chrome?i.CHROME:s.firefox?i.FIREFOX:i.SAFARI)):(s.windows&&(this.os.name=n.WINDOWS,s.edge?(this.os.name=n.WINDOWS,this.browser.name=i.EDGE):this.browser.name=s.chrome?i.CHROME:s.firefox?i.FIREFOX:i.IE,this.device.type=s.mobile||s.phone?a.PHONE:a.DESKTOP),s.linux&&(this.os.name=n.LINUX,s.chrome?this.browser.name=i.CHROME:s.firefox&&(this.browser.name=i.FIREFOX),this.device.type=a.DESKTOP),s.tizen?(this.os.name=n.TIZEN,void(this.browser.name=i.TIZEN)):s.blackberry?(this.os.name=n.BLACKBERRY,void(this.browser.name=i.BLACKBERRY)):(s.android&&!s.trident?(this.os.name=n.ANDROID,this.device.type=a.TABLET,this.browser.name=s.chrome?i.CHROME:s.firefox?i.FIREFOX:i.ANDROID):s.firefox&&(s.mobile||s.tablet)&&(this.os.name=n.FIREFOX,this.browser.name=i.FIREFOX),void(s.mobile?this.device.type=a.PHONE:this.device.type!==a.DESKTOP&&(this.device.type=t/window.devicePixelRatio<750?a.PHABLET:t/window.devicePixelRatio<=1280?a.TABLET:a.DESKTOP)))):(this.os.name=n.IOS,this.device.type=a.TABLET,this.browser.name=i.SAFARI,void(s.iphone?(this.device.type=a.PHONE,t>750&&!s.safari&&(this.device.type=a.TABLET)):750>t&&(this.device.type=a.PHABLET)))};t.prototype.isDesktop=function(){return this.device.type===a.DESKTOP},t.prototype.isPhone=function(){return this.device.type===a.PHONE},t.prototype.isTablet=function(){return this.device.type===a.TABLET||this.device.type===a.PHABLET},t.prototype.isPhablet=function(){return this.device.type===a.PHABLET},t.prototype.isUnknown=function(){return this.device.type===r},t.prototype.isIE=function(){return this.browser.name===i.IE},t.prototype.OS=n,t.prototype.BROWSER=i,t.prototype.FORMAT=a,t.prototype.UNKNOWN=r,e.Class.UserAgentManager=t}(webpublicationNamespace),function(e){WP.getUrlData=function(){for(var e={},t=location.search.replace("?","").split("&"),n=0;n<t.length;n++){var i=t[n].split("=");e[i[0]]=i[1]}return e},WP.addUtm=function(e){var t=WP.getUrlData();for(var n in t)0===n.indexOf("utm_")&&(e+=-1!==e.indexOf("?")?"&"+n+"="+t[n]:"?"+n+"="+t[n]);return e},WP.replaceFunction=function(e,t){return"undefined"!=typeof WP.globalVars[t]?WP.globalVars[t]:e},WP.metaViewportDefiner=function(){var e=[],t=window.devicePixelRatio;if(t||(t=window.screen.deviceXDPI/window.screen.logicalXDPI),"chrome"===WP.userAgent.browser.name)this.defaultViewportScale="phone"===WP.userAgent.device.type?1/Math.min(t,2):1;else if("android"===WP.userAgent.os.name){var n;n="phone"===WP.userAgent.device.type?this.getBestDPIAndroid():this.getBestDPIAndroid(!0),this.defaultViewportScale=1/Math.round(n.scale),e.push("target-densitydpi="+n.dpi),document.querySelector("html").style.fontSize=13.5*n.scale+"px"}else this.defaultViewportScale=1/t;this.defaultViewportScale=1,e.push("initial-scale="+this.defaultViewportScale),e.push("minimum-scale="+this.defaultViewportScale),e.push("maximum-scale="+this.defaultViewportScale),e.push("user-scalable=no");var i=document.createElement("meta");i.setAttribute("name","viewport"),i.setAttribute("content",e.join(",")),(document.head||document.getElementsByTagName("head")[0]).appendChild(i)},WP.XMLPubInfo=function(){WP.path.pubInfo=WP.path.domain+"publication/contents/pubinfo.xml";var e=new XMLHttpRequest;e.open("get",WP.path.pubInfo,!1),e.onreadystatechange=function(){if(4===e.readyState){var t=e.responseXML.getElementsByTagName("variables")[0].childNodes;WP.parseXmlForVariables(t),WP.path.XMLContents=e.responseXML.getElementsByTagName("contents")[0].getAttribute("url"),WP.path.XMLContents=WP.cleanVariables(WP.path.XMLContents),WP.XMLContents()}},e.send()},WP.XMLContents=function(){var e=new XMLHttpRequest;e.open("get",WP.path.XMLContents,!1),e.onreadystatechange=function(){if(4===e.readyState){var t=e.responseXML.getElementsByTagName("variables")[0].childNodes;WP.parseXmlForVariables(t);for(var n=e.responseXML.getElementsByTagName("contents")[0].getElementsByTagName("content"),i=n.length;i--;){var a=n[i].getAttribute("id"),r=n[i].getAttribute("path"),o=n[i].getAttribute("prefix"),s=n[i].getAttribute("ext");null!==o&&(r+=o),null!==s&&(null===o&&(r+="page"),r+="."+s),WP.contents[a]=WP.cleanVariables(r)}}},e.send()},WP.cleanVariables=function(e){return e=e.replace(/\$([^\$]*)\$/g,WP.replaceFunction),e=e.replace(/^~\//,WP.path.domain+"publication/")},WP.parseXmlForVariables=function(e){for(var t=e.length;t--;)if(e[t].nodeType!==e[t].TEXT_NODE){var n=e[t].getAttribute("value");WP.globalVars[e[t].tagName]=n}for(var i in WP.globalVars)WP.globalVars[i]=WP.cleanVariables(WP.globalVars[i])},WP.popupFullscreen=function(e){if("Microsoft Internet Explorer"===navigator.appName&&"MacPPC"!==navigator.platform)window.open(e,"Reader","fullscreen=no");else try{var t=window.open(e,null,"height="+screen.availHeight+"px,width="+screen.availWidth+"px,top=0,left=0,location=0,menubar=0,resizable=0,scrollbars=0,toolbar=0");t.resizeTo(screen.availWidth,screen.availHeight)}catch(n){}},WP.loadFlash=function(e,t,n){var i=document.createElement("script");i.onload=function(){n.pubUrl=WP.path.domain+"publication/contents/pubinfo.xml",n.viewerURL="..";var i={menu:"false",scale:"noScale",allowFullscreen:"true",allowScriptAccess:"always",bgcolor:"",wmode:"direct"},a={id:"Visio"},r=WP.path.domain+"publication/binary/minibook.swf";swfobject.embedSWF(r,"wp-visio-content",e,t,"10.1","publication/js/expressInstall.swf",n,i,a)},i.src=WP.path.domain+"publication/js/swfobject.js",document.body.appendChild(i)},WP.animation=function(e){if(e=e||{},e.backgroundColor=e.backgroundColor||"ffffff",e.opacity=e.opacity||!0,e.sizeHeight=e.sizeHeight||243,e.sizeWidth=e.sizeWidth||313,e.pages=e.pages||5,e.open=e.open||"popup",e.support=e.support||"auto",WP.XMLPubInfo(),WP.userAgent.device.type===WP.userAgent.FORMAT.DESKTOP&&"html5"!==e.support||"flash"===e.support)document.write('<div id="wp-visio-content"></div>'),WP.loadFlash(e.sizeWidth,e.sizeHeight,{bgColor:e.backgroundColor,bgAlpha:e.opacity?0:1,numPages:e.pages});else{WP.metaViewportDefiner();var t=WP.path.domain;"html5"===e.support&&(t+="?version=html");var n='<style type="text/css">';n+=".wp-animation-wrapper{display:inline;display: inline-block;height:"+e.sizeHeight+"px;overflow:hidden;width:"+e.sizeWidth+"px;*zoom:1;}",n+=".wp-animation-content{height:100%;white-space: nowrap;}",n+=".wp-animation-image{height: 100%;}",n+="</style>",n+="blank"===e.open?'<a class="wp-animation-wrapper" href="'+t+'" target="_blank">':'<a class="wp-animation-wrapper" href="javascript:WP.popupFullscreen(\''+t+"')\">",n+='<div class="wp-animation-content">';for(var i=0;i++<e.pages;)n+='<img src="'+WP.contents.thumbnails.replace("%num%",i)+'" class="wp-animation-image" />';n+="</div></a>";var a=0,r=0,o=function(){a++,a>=e.pages?(a=0,s(0,1,!0)):s(a*document.getElementsByClassName("wp-animation-image")[0].width,16,!1)},s=function(e,t,n){window.setTimeout(function(){e-r>10||-10>e-r?(n?r-=10:r+=10,document.getElementsByClassName("wp-animation-content")[0].style.marginLeft=-r+"px",s(e,t,n)):document.getElementsByClassName("wp-animation-content")[0].style.marginLeft=-e+"px"},t)};window.setInterval(o,5e3),document.write(n)}},WP.image=function(e){e=e||{},e.sizeHeight=e.sizeHeight||243,e.sizeWidth=e.sizeWidth||300,e.open=e.open||"popup",e.support=e.support||"auto",WP.XMLPubInfo();var t="",n=WP.path.domain,i=WP.contents.thumbnails.replace("%num%",1);"html5"===e.support?n+="?version=html":"flash"===e.support&&(n+="?version=flash"),t+="blank"===e.open?'<a href="'+WP.path.domain+'" target="_blank">':"<a href=\"javascript:WP.popupFullscreen('"+WP.path.domain+"')\">",t+='<img src="'+i+'" border="0" width="'+e.sizeWidth+'" height="'+e.sizeHeight+'"/>',t+="</a>",WP.userAgent.device.type===WP.userAgent.FORMAT.DESKTOP,document.write(t)},WP.embed=function(e){e=e||{},e.embed=e.embed||"fullscreen ",e.support=e.support||"auto",e.height=e.height||"100%",e.width=e.width||"100%",-1===e.height.indexOf("%")&&-1===e.height.indexOf("px")&&(e.height+="px"),-1===e.width.indexOf("%")&&-1===e.width.indexOf("px")&&(e.width+="px");var t="",n=WP.path.domain;if(n+="html5"===e.support?"?version=html&vp=1":"flash"===e.support?"?version=flash&vp=1":"?vp=1","100%"===e.height&&"100%"===e.width&&(e.embed="fullscreen"),"embed"===e.embed)t+='<iframe src="'+WP.addUtm(n)+'" style="border: none; margin: 0; padding: 0; width: '+e.width+"; height: "+e.height+';"></iframe>';else{WP.metaViewportDefiner();var i=document.createElement("meta");i.setAttribute("name","HandheldFriendly"),i.setAttribute("content","true"),(document.head||document.getElementsByTagName("head")[0]).appendChild(i);var a=document.createElement("meta");a.setAttribute("name","apple-mobile-web-app-capable"),a.setAttribute("content","yes"),(document.head||document.getElementsByTagName("head")[0]).appendChild(a);var r=document.createElement("meta");r.setAttribute("name","format-detection"),r.setAttribute("content","no"),(document.head||document.getElementsByTagName("head")[0]).appendChild(r);var o="html body{height:100%;margin:0;padding:0;width:100%;}",s="border:none;height:100%;left:0;margin:0;padding:0;position:fixed;top:0;width:100%;";o="html body{height:100%;margin:0;padding:0;width:100%;}",o+="iframe{border:none;height:100%;left:0;margin:0;padding:0;position:fixed;top:0;width:100%;}";var p=document.createElement("style");p.setAttribute("type","text/css"),p.styleSheet&&"undefined"!=typeof p.styleSheet.cssText?p.styleSheet.cssText=o:"undefined"==typeof p.textContent?p.innerText=o:p.textContent=o,(document.head||document.getElementsByTagName("head")[0]).appendChild(p),t+='<iframe height="100%" width="100%" frameBorder="0" src="'+WP.addUtm(n)+'" style="'+s+'"></iframe>'}document.write(t)},WP.email=function(e){},WP.userAgent=new e.Class.UserAgentManager}(webpublicationNamespace);