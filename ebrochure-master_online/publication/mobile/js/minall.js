!function(e){function t(e){var a={};if(e.hasChildNodes()){for(var n,i,r,o="",s=e.childNodes.length,l=0;s>l;l++)n=e.childNodes.item(l),3===(n.nodeType-1|1)?o+=3===n.nodeType?n.nodeValue.trim():n.nodeValue:1!==n.nodeType||n.prefix||(i=n.nodeName,r=t(n),a.hasOwnProperty(i)?(a[i].constructor!==Array&&(a[i]=[a[i]]),a[i].push(r)):a[i]=r);o&&(a.keyValue=o)}if("undefined"!=typeof e.hasAttributes&&e.hasAttributes())for(var u,c=e.attributes.length,d=0;c>d;d++)u=e.attributes.item(d),a["@"+u.name]=u.value;return a}e.JXONTree=t}(webpublicationNamespace),function(e){function t(e){e=e.split("/");for(var t=[],a=1;a<e.length;a+=2)t[e[a]]=e[a+1];return t}function a(e){return e.split("/")[0]}e.API={debugDisable:function(){return e.Utils._assertDebug(!1)},debugEnable:function(){return e.Utils._assertDebug(!0)},debugGetState:function(){return e.Utils._assertDebug()},debugToggle:function(){return e.Utils._assertDebug(!e.Utils._assertDebug())},deviceType:function(){return e.Param.userAgent.device.type},lightboxClose:function(){e.Class.LightboxManagerNew.closeAll()},lightboxOpen:function(t){new e.Class.LightboxManagerNew({id:"api-iframe",title:t.title,header:"false"===t.header?"none":"visible",url:e.Utils.resolveVariable(decodeURIComponent(t.url))})},menuClose:function(){return e.Main.menuManager.hideMenu()},menuOpen:function(){return e.Main.menuManager.showMenu()},menuToggle:function(){return e.Main.menuManager.toggleMenu()},pageCount:function(){return e.Utils.prodTools.getPageLength()},pageLoad:function(t){if(t.number)return e.Utils._assertInteger(t.number,"[pageLoad] The number argument must be an integer")?(e.Param.newViewerVersion?e.Main.viewerManager.goToPage(t.number):e.Main.controlManager.goToPage(t.number),!0):!1;if(t.name){if("next"===t.name)e.Param.newViewerVersion?e.Main.viewerManager.scrollFrame("next"):e.Main.controlManager.nextPage();else if("previous"===t.name||"prev"===t.name)e.Param.newViewerVersion?e.Main.viewerManager.scrollFrame("prev"):e.Main.controlManager.prevPage();else if("first"===t.name)e.Param.newViewerVersion?e.Main.viewerManager.goToPage(1):e.Main.controlManager.goToPage(1);else{if("last"!==t.name)return!1;e.Param.newViewerVersion?e.Main.viewerManager.goToPage(e.Utils.prodTools.getPageLength()):e.Main.controlManager.goToPage(e.Utils.prodTools.getPageLength())}return!0}return e.Utils._assert(!1,"[pageLoad] The argument is missing or incorrect"),!1},broadcast:function(t){if(e.Utils._assertOneOf(t.mode,["all","others"],"Mode must be 'all' or 'others'")&&e.Utils._assertJson(t.data,"Data must be a valid json string")){var a="others"===t.mode?this:!1,n=JSON.parse(t.data);return n.type="broadcast",e.Param.newViewerVersion?e.Main.linksManagerNew.linksBroadcast(t.mode,n,a):e.Main.linksManager.linksBroadcast(t.mode,n,a),!0}return!1},linkClick:function(){var t=e.Main.xmlManager.get("common-configuration","config","pageCount");return function(a){return e.Utils._assertInteger(a.page,"Page number must be an integer")&&e.Utils._assertInteger(a.index,"Link index must be an integer")?void(a.page>0&&a.page<=t&&a.index>=0&&e.Main.linksManagerNew.linkClick(a.page,{index:a.index})):!1}}(),welcomepageOpen:function(){var t=e.Main.startupManager.get("startup.welcomepage.url");return t?(e.Main.trackerManager.trackPage({name:"welcomepage"}),new e.Class.LightboxManagerNew({animation:"none",header:"none",id:"startupPanel",url:e.Utils.resolveVariable(t)}),!0):!1},pdfDownload:function(){e.Main.pdfManager.download()},pdfPrint:function(){e.Main.pdfManager.print()},pdfGetUrl:function(e){return location.pathname+"publication/contents/pdfweb.pdf"},share:function(t){if("mail"===t.network||"email"===t.network){var a=e.Main.menuService.get("email_btn");return a?(a.onload(),a.onclick(),!0):!1}return e.Main.shareManager.shareSocial(t.network,!0)},shareOpen:function(t){return e.Main.shareManager.open("home")},shareClose:function(t){return e.Main.shareManager.close()},searchOpen:function(){var t=e.Main.menuService.get("search_btn");return t.onload(),t.onclick(),!0},thumbnailOpen:function(){var t=e.Main.menuService.get("thumbnails_btn");return t.onload(),t.onclick(),!0},viewportGetScale:function(){return e.Starter.defaultViewportScale},menuButtonClick:function(t){return e.Main.menuManager.callButtonClick(t.name)},pageCurrent:function(){return e.Utils.getVisiblePages()}},window.addEventListener("message",function(n){if(e.Utils._assertString(n.data)){var i=a(n.data),r=t(n.data);if(e.API.hasOwnProperty(i)){var o=e.API[i].call(n.source,r);n.source&&n.source.postMessage({method:i,arguments:r,result:o,queryId:r.queryId},n.origin)}}},!1)}(webpublicationNamespace),function(e){e.Class.CanvasManager=function(){var t={},a=0,n="rgba(100,100,100,0.5)",i=function(t){this.parent=t,this.canvasKey=e.Starter._CONFIG.pages.canvasKey,this.elementKey=e.Starter._CONFIG.pages.element,this.textureHigh=e.Starter._CONFIG.pages.textureHigh,this.textureLow=e.Starter._CONFIG.pages.textureLow,this.getTextureHigh=e.Starter._CONFIG.pages.getTextureHigh,this.getTextureLow=e.Starter._CONFIG.pages.getTextureLow,this.canvasNeedPath=[this.textureLow,this.textureHigh],this.canvasNeedFormat=[this.getTextureLow,this.getTextureHigh],this.drawingTimer={},e.Starter._CONFIG.pages.imgFormatSpecial==e.Starter._CONFIG.imgFormatSpecialIOS&&(n="rgba(255,255,255,1)"),"android"===e.Param.userAgent.os.name&&"chrome"===e.Param.userAgent.browser.name?this.clearCvs=this.clearCvs_android_chrome:"android"===e.Param.userAgent.os.name&&(this.clearCvs=this.clearCvs_android),"android"===e.Param.userAgent.browser.name&&(this.shadowManage=this.shadowManageNone)};return i.prototype.lastDataOfDrawing={index_0:{},index_1:{}},i.prototype.textureContextList={},i.prototype.clearCvs_android_chrome=function(e,t,a,n,i){e.ctx.save(),e.ctx.setTransform(1,0,0,1,0,0),e.element.width=e.element.width,e.ctx.restore()},i.prototype.clearCvs_android=function(e,t,a,n,i){e.ctx.save(),e.ctx.setTransform(1,0,0,1,0,0),e.ctx.restore()},i.prototype.clearCvs=function(){return function(e,t,a,n,i){e.ctx.save(),e.ctx.setTransform(1,0,0,1,0,0);for(var r in this.lastDataOfDrawing)e.ctx.clearRect(0,0,e.element.width,e.element.height);e.ctx.restore()}}(),i.prototype.loadTexture=function(){var n=null,i=null;return function(r,o,s){return(!this.textureContextList[this.canvasKey+r]||o&&!this.textureContextList[this.canvasKey+r][this.textureLow+o])&&(o||(this.textureContextList[this.canvasKey+r]={},this.textureContextList[this.canvasKey+r].pos={},this.textureContextList[this.canvasKey+r].isDoublePage=e.Utils.byPageIfDouble(r).isDouble),t[this.canvasKey+r]||(t[this.canvasKey+r]={}),this.textureContextList[this.canvasKey+r][this.canvasNeedPath[0]+o]=t[this.canvasKey+r][this.canvasNeedPath[0]+o]?t[this.canvasKey+r][this.canvasNeedPath[0]+o]:new Image,this.textureContextList[this.canvasKey+r][this.canvasNeedPath[1]+o]=t[this.canvasKey+r][this.canvasNeedPath[1]+o]?t[this.canvasKey+r][this.canvasNeedPath[1]+o]:new Image,this.textureContextList[this.canvasKey+r][this.canvasNeedPath[0]+o]&&(this.textureContextList[this.canvasKey+r][this.canvasNeedPath[0]+o].drawed=!1),this.textureContextList[this.canvasKey+r][this.canvasNeedPath[1]+o]&&(this.textureContextList[this.canvasKey+r][this.canvasNeedPath[1]+o].drawed=!1),o||(n=e.Main.pagesLoader.getElementCvsDispo(),n?i=n.ctx:(n={},n[this.elementKey]=document.createElement("canvas"),n[this.elementKey].id="cvs_"+ ++a,e.Utils.setBestSizeCVS(n,this.elementKey),i=n[this.elementKey].getContext("2d"),e.Param.viewPages.appendChild(n[this.elementKey])),this.textureContextList[this.canvasKey+r][this.elementKey]=n[this.elementKey],this.textureContextList[this.canvasKey+r].ctx=i,this.textureContextList[this.canvasKey+r][this.elementKey].className="",this.textureContextList[this.canvasKey+r][this.elementKey].style.cssText=e.Main.positionForSlider.positionMe(r),this.constructPos(this.textureContextList[this.canvasKey+r],r)),this.drawByFormat(this.canvasKey+r,this.canvasNeedFormat[0]+o,this.canvasNeedPath[0]+o,r,o),this.drawByFormat(this.canvasKey+r,this.canvasNeedFormat[1]+o,this.canvasNeedPath[1]+o,r,o)),this.textureContextList[this.canvasKey+r][this.textureLow+(o+1)]||o||!e.Starter._CONFIG.pages.doublePage||1==r||r==e.Main.xmlManager.get("common-configuration","config","pageCount")?this.textureContextList[this.canvasKey+r][this.elementKey]:this.loadTexture(r,o+1,s)}}(),i.prototype.readyToDrawGalleryImage=function(){var t=null,a=null,n=null,i=null,r=null,o=null,s=null,l=null,u=null,c=null;return function(d,h,p,g,m,f,v){return t=null,a=null,n=null,i=null,r=null,o=null,s=null,l=null,u=1,c=this.textureContextList[p].pos.currScale,"undefined"==typeof this.textureContextList[p].pos||!this.textureContextList[p].pos.x&&0!==this.textureContextList[p].pos.x?!1:(n=h.width*c,i=h.height*c,r=this.textureContextList[p].pos.x,o=this.textureContextList[p].pos.y,s=this.textureContextList[p].pos.width,l=this.textureContextList[p].pos.height,t=s/l,a=n/i,(n>s||i>l)&&(u=t>a?l/i:s/n),width2=n*u,height2=i*u,r=r+s/2-width2/2,o=o+l/2-height2/2,s=width2,l=height2,"undefined"!=typeof this.textureContextList[p][m]&&(this.textureContextList[p][m].drawed=!0),e.Starter._CONFIG.pages.imgFormatSpecial==e.Starter._CONFIG.imgFormatSpecialIOS&&(this.clearCvs(this.textureContextList[p],r+s*v,o,s,l),this.textureContextList[p].ctx.save(),this.textureContextList[p].ctx.fillStyle="rgba(255,255,255,1)",this.textureContextList[p].ctx.fillRect(r+s*v,o,s,l),this.textureContextList[p].ctx.restore()),this.clearCvs(this.textureContextList[p],0,0,this.textureContextList[p].element.width,this.textureContextList[p].element.height),this.textureContextList[p].ctx.save(),this.textureContextList[p].ctx.shadowColor="black",this.textureContextList[p].ctx.shadowBlur=10,this.textureContextList[p].ctx.shadowOffsetX=0,this.textureContextList[p].ctx.shadowOffsetY=0,this.textureContextList[p].ctx.fillStyle="rgba(100,100,100,0.5)",this.textureContextList[p].ctx.fillRect(r+s*v,o,s,l),this.textureContextList[p].ctx.restore(),this.textureContextList[p].ctx.drawImage(h,r+s*v,o,s,l),m==this.textureHigh+v&&(this.textureContextList[p][this.getTextureLow+v]=null,this.textureContextList[p][this.textureLow+v]=null,delete this.textureContextList[p][this.getTextureLow+v],delete this.textureContextList[p][this.textureLow+v],e.Main.linksManager&&e.Main.linksManager.hideMultimedia&&e.Main.linksManager.hideMultimedia(e.Main.pagesLoader.pageCurrentOriginalIs),e.Main.linksManager&&e.Main.linksManager.drawLinks&&e.Main.linksManager.drawLinks(this.textureContextList[p],f,v)),d&&d(this.textureContextList[p]),!1)}}(),i.prototype.readyToDraw=function(){return function(t,a,n,i,r,o,s){return!this.textureContextList[n].pos||!this.textureContextList[n].pos.x&&0!=this.textureContextList[n].pos.x?!1:e.Starter._CONFIG.visioType&&"GalleryImage"==e.Starter._CONFIG.visioType?(this.readyToDrawGalleryImage(t,a,n,i,r,o,s),!1):("undefined"!=typeof this.textureContextList[n][r]&&(this.textureContextList[n][r].drawed=!0),e.Starter._CONFIG.pages.imgFormatSpecial==e.Starter._CONFIG.imgFormatSpecialIOS&&(this.clearCvs(this.textureContextList[n],this.textureContextList[n].pos.x+this.textureContextList[n].pos.width*s,this.textureContextList[n].pos.y,this.textureContextList[n].pos.width,this.textureContextList[n].pos.height),this.textureContextList[n].ctx.save(),this.textureContextList[n].ctx.fillStyle="rgba(255,255,255,1)",this.textureContextList[n].ctx.fillRect(this.textureContextList[n].pos.x+this.textureContextList[n].pos.width*s,this.textureContextList[n].pos.y,this.textureContextList[n].pos.width,this.textureContextList[n].pos.height),this.textureContextList[n].ctx.restore()),this.lastDataOfDrawing["index_"+s]={x:this.textureContextList[n].pos.x+this.textureContextList[n].pos.width*s,y:this.textureContextList[n].pos.y,w:this.textureContextList[n].pos.width,h:this.textureContextList[n].pos.height},this.textureContextList[n].ctx.drawImage(a,this.textureContextList[n].pos.x+this.textureContextList[n].pos.width*s,this.textureContextList[n].pos.y,this.textureContextList[n].pos.width,this.textureContextList[n].pos.height),e.Main.eventEmul.callEvent("onHDPageDraw",o,s,this.textureContextList[n]),r==this.textureHigh+s&&(this.textureContextList[n][this.getTextureLow+s]=null,this.textureContextList[n][this.textureLow+s]=null,delete this.textureContextList[n][this.getTextureLow+s],delete this.textureContextList[n][this.textureLow+s]),t&&t(this.textureContextList[n]),!1)}}(),i.prototype.localReadyToDraw=function(e){this.parentOb.readyToDraw(e,this.readyToDrawArgvs[0],this.readyToDrawArgvs[1],this.readyToDrawArgvs[2],this.readyToDrawArgvs[3],this.readyToDrawArgvs[4],this.readyToDrawArgvs[5])},i.prototype.nextOnLoad=function(e,t,a,n,i,r){return this.textureContextList[t]&&this.textureContextList[t][n]?(this.textureContextList[t][n].parentOb=this,this.textureContextList[t][n].readyToDrawArgvs=arguments,this.textureContextList[t][n].readyToDraw=this.localReadyToDraw,this.readyToDraw(null,e,t,a,n,i,r),!1):!1},i.prototype.drawByFormatNext=function(){var a=function(){return t[this.parentObArgvs[0]][this.parentObArgvs[2]]=this,this.parentOb.nextOnLoad(this,this.parentObArgvs[0],this.parentObArgvs[1],this.parentObArgvs[2],this.parentObArgvs[3],this.parentObArgvs[4]),!1};return function(n,i,r,o,s){return t[n]&&t[n][r]?this.nextOnLoad(t[n][r],n,i,r,o,s):(this.textureContextList[n][r].parentOb=this,this.textureContextList[n][r].parentObArgvs=arguments,this.textureContextList[n][r].onload=a,i==this.getTextureHigh+s&&(this.textureContextList[n][r].src=e.Main.pageManager.getImage("hdpi",o+s))),!1}}(),i.prototype.drawByFormat=function(t,a,n,i,r){if("undefined"==typeof this.textureContextList[t][n]||this.textureContextList[t][n].drawed)return!1;var o=this;return this.textureContextList[t][a]=function(){o.drawByFormatNext(t,a,n,i,r)},a==this.getTextureLow+r&&(this.textureContextList[t][n].src=e.Main.pageManager.getImage("mdpi",i+r),this.drawByFormatNext(t,a,n,i,r)),!1},i.prototype.texture=function(t){return this.loadTexture(t,0,e.Starter._CONFIG.pages.doublePage)},i.prototype.getCurrentPageObjectContext=function(){return this.textureContextList[e.Starter._CONFIG.pages.canvasKey+e.Starter.getCurrentPage()]},i.prototype.shadowManage=function(e,t,a){return e.ctx.save(),e.ctx.shadowColor="black",e.ctx.shadowBlur=10,e.ctx.shadowOffsetX=0,e.ctx.shadowOffsetY=0,e.ctx.fillStyle=n,e.ctx.fillRect(e.pos.x,e.pos.y,t,a),e.ctx.restore(),!1},i.prototype.shadowManageNone=function(e,t,a){return!1},i.prototype.constructPos=function(){var t=!1,a=null,n=null,i=null,r=null,o=null,s=null,l=null,u=null,c=null,d=0,h=0,p=0,g=0,m=0,f=0,v=0,b=0;return function(y,w,C,M,P,x,S,L,I){return o=e.Starter._CONFIG.pagesOnInit.width,s=e.Starter._CONFIG.getDocument.width/2,l=e.Starter._CONFIG.pagesOnInit.height/2,u=e.Starter._CONFIG.getDocument.height/2,c=~~(100*e.Starter._CONFIG.pages.currScale)/100,d=0,h=0,p=0,g=0,m=0,f=0,v=0,b=0,t=!1,a=null,n=null,this.clearCvs(y,0,0,e.Utils.getBestSreenSize(),e.Utils.getBestSreenSize()),C?c+=C:C=0,M&&P&&(d=M,h=P),y.isDoublePage||(t=!0,o/=2),p=o*c,g=l*c,m=s-p,f=u-g,v=m-d,b=f-h,i=v,r=b,v>s?v=s:s>v+2*o*c&&(v=s-2*o*c),b>u?b=u:u>b+2*l*c&&(b=u-2*l*c),I&&(I.transformDiffDefX+=i-v,I.transformDiffDefY+=r-b),y.pos.x=v,y.pos.y=b,y.pos.currScale=c,y.pos.width=e.Starter._CONFIG.pagesOnInit.width*c,y.pos.height=e.Starter._CONFIG.pagesOnInit.height*c,a=y.pos.width,n=y.pos.height,t||(a=2*y.pos.width),0===C&&(e.Starter._CONFIG.visioType&&"GalleryImage"==e.Starter._CONFIG.visioType||this.shadowManage(y,a,n)),x&&x(y),!1}}(),i}()}(webpublicationNamespace),function(e){e.Class.CanvasViewerManager=function(){function t(e,t,a,n,i,r){if("undefined"==typeof r&&(r=5),"number"==typeof r)r={tl:r,tr:r,br:r,bl:r};else{var o={tl:0,tr:0,br:0,bl:0};for(var s in o)r[s]=r[s]||o[s]}e.beginPath(),e.moveTo(t+r.tl,a),e.lineTo(t+n-r.tr,a),e.quadraticCurveTo(t+n,a,t+n,a+r.tr),e.lineTo(t+n,a+i-r.br),e.quadraticCurveTo(t+n,a+i,t+n-r.br,a+i),e.lineTo(t+r.bl,a+i),e.quadraticCurveTo(t,a+i,t,a+i-r.bl),e.lineTo(t,a+r.tl),e.quadraticCurveTo(t,a,t+r.tl,a),e.closePath(),e.fill(),e.stroke()}function a(e,t){var a=e+P.deltaFrameInDOM;if("undefined"!=typeof f[a])if(f[a].backgroundColors=t,t!==!1)for(var n=t.length,i=((f[a].dom.width-b*n)/2,f[a].dom.width/n),r=null,o=null,s=0;n>s;s++)r=s*i,o=i,"transparent"!==t[s]?(f[a].ctx.fillStyle=t[s],f[a].ctx.fillRect(r,0,o,f[a].dom.height)):f[a].ctx.clearRect(r,0,o,f[a].dom.height);else f[a].ctx.fillStyle=P.pageBgColor,f[a].ctx.fillRect(0,0,f[a].dom.width,f[a].dom.height)}function n(e,t,a,n){var i=t+P.deltaFrameInDOM,r=1;0===t&&(P.pagesRetina&&(r*=P.maxZoom),n&&(r*=P.zoomScale)),f[i].ctx.drawImage(e,a*r,w*r,b*r,y*r)}function i(e,t){var a=t.coord.width,n=t.coord.height,i=t.width/t.height,r=a/n;i>r?n=a/i:a=n*i;var o;if("CANVAS"===e.tagName.toUpperCase())o=e.getContext("2d");else{var s=document.createElement("canvas");o=s.getContext("2d"),s.width=e.width,s.height=e.height,o.drawImage(e,0,0,s.width,s.height),s.pageNumber=e.pageNumber,e=s}var l=e.width/t.coord.container.width,u=e.height/t.coord.container.height;return o.globalAlpha=1,o.drawImage(t,M(t.coord.x*l),M(t.coord.y*u),M(a*l),M(n*u)),e}function r(a,n){var i;if("CANVAS"===a.tagName.toUpperCase())i=a.getContext("2d");else{var r=document.createElement("canvas");i=r.getContext("2d"),r.width=a.width,r.height=a.height,i.drawImage(a,0,0,r.width,r.height),r.pageNumber=a.pageNumber,a=r}var o=a.width/n.container.width,s=a.height/n.container.height;return i.globalAlpha=.2,i.fillStyle=e.Main.cssManager.getStyle("secondary","linkBackgroundColor"),i.strokeStyle=e.Main.cssManager.getStyle("secondary","linkColor"),"rect"===n.type?(i.fillRect(n.x*o,n.y*s,n.w*o,n.h*s),i.stroke()):"circle"===n.type?(i.beginPath(),i.ellipse(n.x*o,n.y*s,n.w*o/2,n.h*s/2,0,2*Math.PI,!0),i.closePath(),i.fill(),i.stroke()):"roundrect"===n.type?t(i,n.x*o,n.y*s,n.w*o,n.h*s,n.radius):"roundrectcomplex"===n.type&&t(i,n.x*o,n.y*s,n.w*o,n.h*s,{tl:n.tl_radius,tr:n.tr_radius,br:n.br_radius,bl:n.bl_radius}),a}function o(e){b=e.width,y=e.height,w=e.top,C=e.left}function s(){var t=1*P.zoomScale;P.pagesRetina&&(t*=P.maxZoom),f[P.deltaFrameInDOM].dom.width=p*t,f[P.deltaFrameInDOM].dom.height=g*t,f[P.deltaFrameInDOM].dom.style.width=p*t+"px",f[P.deltaFrameInDOM].dom.style.height=g*t+"px",a(0,f[P.deltaFrameInDOM].backgroundColors),e.Utils.scaleDom3d(f[P.deltaFrameInDOM].dom,1/t,0,0)}function l(){var t=1;P.pagesRetina&&(t*=P.maxZoom),f[P.deltaFrameInDOM].dom.width=p*t,f[P.deltaFrameInDOM].dom.height=g*t,f[P.deltaFrameInDOM].dom.style.width=p*t+"px",f[P.deltaFrameInDOM].dom.style.height=g*t+"px",a(0,f[P.deltaFrameInDOM].backgroundColors),e.Utils.scaleDom3d(f[P.deltaFrameInDOM].dom,1/t,0,0)}function u(){p=window.innerWidth,g=window.innerHeight;for(var t,a=f.length;a--;)t=f[a],P.verticalSlider?t.dom.style.top=a*g+"px":t.dom.style.left=a*p+"px",P.pagesRetina&&"webpub-viewer__canvas-0"===t.dom.id?(t.dom.width=p*P.maxZoom,t.dom.height=g*P.maxZoom,t.dom.style.width=p*P.maxZoom+"px",t.dom.style.height=g*P.maxZoom+"px",e.Utils.scaleDom3d(t.dom,1/P.maxZoom,0,0)):(t.dom.width=p,t.dom.height=g,t.dom.style.width=p+"px",t.dom.style.height=g+"px")}function c(){for(var e,t=-P.deltaFrameInDOM;t<=P.deltaFrameInDOM;)e=document.createElement("canvas"),e.className="webpub-viewer__canvas",e.id="webpub-viewer__canvas-"+t,P.container.appendChild(e),f[t+P.deltaFrameInDOM]={dom:e,ctx:e.getContext("2d")},t++}function d(e){p=window.innerWidth,g=window.innerHeight;var t;for(t in e)"undefined"!=typeof P[t]&&(P[t]=e[t]);P.zoomScale=Math.max(1,parseFloat(P.zoomScale,10)),P.maxZoom=Math.max(1,parseFloat(P.maxZoom,10));var a=1*P.zoomScale;P.pagesRetina&&(a*=P.maxZoom);var n=Math.max(p*a,g*a);n>4095&&(P.zoomScale=P.zoomScale/(n/4095)),v&&u()}function h(e){d(e||{}),c(),v=!0}var p=0,g=0,m=Math,f=[],v=!1,b=0,y=0,w=0,C=0,M=function(e,t){var a=t?m.pow(10,t):1;return m.round(e*a)/a},P={deltaFrameInDOM:1,pagesInFrame:1,pagesRetina:!0,pageShadowSize:0,maxZoom:2.5,zoomScale:1.5,pageBgColor:"rgb(240, 240, 240, 0)",useBgColorPerPage:!0,verticalSlider:!1,container:null};return{init:h,setConfig:d,clearDomFrame:a,addImageIntoPageDom:i,addLinkBoxIntoPageDom:r,visualizePageAtFrame:n,zoomIn:s,zoomOut:l,setPageSize:o,onResize:u}}}(webpublicationNamespace),function(e){var t=null;e.Class.CarrouselManager=function(){var a=function(t,a){this.externalConf=a,this.elemParent=t,this.currentTween=null,this.setAnimFrameDrawCtxX=0,this.tweenTarget={x:0},this.tZero=.1,this.positionneurStyle=null,this.cvsInfos={},this.cvsInfos.width=0,this.cvsInfos.bestSize=0,this.cvsInfos.height=(this.externalConf.thumbListHeight||60)/e.Starter.defaultViewportScale,this.cvsInfos.currentPosX=0,this.thumbnailsInfos={},this.thumbnailsInfos.currentPage=1,this.thumbnailsInfos.pagesNb=0,this.thumbnailsInfos.width=0,this.thumbnailsInfos.height=0,this.thumbnailsInfos.margin=5,this.thumbnailsInfos.scope={},this.thumbnailsInfos.scope.ratioCalc=0,this.thumbnailsInfos.scope.minPosX=0,this.thumbnailsInfos.scope.maxPosX=0,this.thumbnailsInfos.scope.scopeLength=0,this.thumbnailsInfos.scope.scopeThumbsLength=0,this.thumbnailsInfos.scope.scopeMinThumbs=0,this.thumbnailsInfos.scope.scopeMaxThumbs=0,this.thumbnailsInfos.objecstList={},this.positionneur=null,this.mainContentScrollable=null,this.ifDouble=1,this.targetPos=0,this.globalsUpdaterById=0,this.touchManager=null,this.externalConf.pageLength&&(this.thumbnailsInfos.pagesNb=this.externalConf.pageLength,this.touchManager=new this.TouchManager(this),this.setNewGlobalsUpdaterById(),this.start())},n=a.prototype;return n.setNewGlobalsUpdaterById=function(){this.globalsUpdaterById=e.Utils.uniqueId()},n.getNewGlobalsUpdaterById=function(){return this.globalsUpdaterById},n.setStyleContent=function(e){var t=this.externalConf.backgroundColorBoxShadow(),a=e.style.boxShadow||e.style.webkitBoxShadow||e.style.msBoxShadow;return a=t[1],this.positionneurStyle=this.externalConf.positionneurStyle?webpublicationNamespace.Main.cssManager.getStyle("primary","actionColor"):"rgba( 0 , 0 , 0 , 0.8 )",!1},n.MainContentScrollable=function(){var t=function(t){this.parent=t,this.width=null,this.height=null,this.style=null,this.contentslist=[],this.contentslistNameLength=0,this.contentslistName=[],this.contentslistNameObj={},"android"==e.Param.userAgent.os.name&&"chrome"==e.Param.userAgent.browser.name||"android"==e.Param.userAgent.os.name&&(this.cleare=this.cleareForAndroid)},a=t.prototype;return a.getStyle=function(){return this.style},a.drawStyle=function(){var t=this.parent.getContext().createLinearGradient(0,0,0,120);t.addColorStop(0,e.Utils.hexToRgb("#000000",0)),t.addColorStop(1,e.Utils.hexToRgb("#000000",.375)),this.parent.getContext().fillStyle=webpublicationNamespace.Main.cssManager.getStyle("pushmenu","backgroundColor"),this.parent.getContext().fillRect(0,0,this.getWidth(),this.getHeight()),this.parent.getContext().fillStyle=t,this.parent.getContext().fillRect(0,0,this.getWidth(),this.getHeight())},a.getX=function(){return 0},a.getWidth=function(){return this.width},a.getHeight=function(){return this.height},a.scrollXTo=function(e){this.parent.getContext().translate(e,0)},a.cleareForAndroidChrome=function(){return this.parent.getContext().setTransform(1,0,0,1,0,0),this.parent.getCanvas().width=this.parent.getCanvas().width,!1},a.cleareForAndroid=function(){return this.parent.getContext().setTransform(1,0,0,1,0,0),!1},a.cleare=function(){return this.parent.getContext().setTransform(1,0,0,1,0,0),this.parent.getContext().clearRect(0,0,this.getWidth(),this.getHeight()),!1},a.setWidth=function(e){return this.width=e,!1},a.setHeight=function(e){return this.height=e,!1},a.setStyle=function(e){return e&&(this.style=e),!1},a.getContent=function(){var e={list:null,names:null};return function(){return e.list=this.contentslist,e.names=this.contentslistName,e}}(),a.addContent=function(e,t){return this.contentslist.push(t),this.contentslistName.push(e),this.contentslistNameObj[e]=!0,this.contentslistNameLength++,!1},a.removeContent=function(e,t){return this.contentslistNameObj[e]=!1,delete this.contentslist[t],this.contentslist.splice(t,1),this.contentslistName.splice(t,1),this.contentslistNameLength--,!1},a.existeContent=function(){return function(e){return this.contentslistNameObj[e]===!0?!0:!1}}(),a.draw=function(e,t){return this.cleare(),this.parent.getContext().save(),this.drawStyle(),this.parent.getContext().restore(),this.scrollXTo(t+e),this.drawContents(),!1},a.drawContents=function(){var e=0,t=0;return function(){for(t=0,e=this.contentslistNameLength;e>t;)this.contentslist[t].draw(),t++;return!1}}(),t}(),n.Positionneur=function(t){var a=function(){return cvs.height},n=function(a){var n=t.thumbnailsInfos.scope.width+2*t.thumbnailsInfos.margin,i=e.Utils.byPageIfDouble(t.getCurrentPage());return i.isDoubleDoc&&i.isDouble&&a!==!0&&(n*=2,n-=t.thumbnailsInfos.margin),n},i=function(){var a=e.Utils.byPageIfDouble(t.getCurrentPage());return(t.getCurrentPage()-(2-(a.isDoubleDoc?a.isDoublePage[1]:1)))*(n(!0)-t.thumbnailsInfos.margin)-t.thumbnailsInfos.margin},r=function(){return 0};this.setStyle=function(e){t.getContext().fillStyle=e},this.draw=function(){t.getContext().fillRect(i(),r(),n(),a())}},n.Thumbnails=function(){var t=function(e,t){this.loading=!1,this.initCtxChecPair=null,this.image=null,this.globalsUpdaterById=null,this.savedX=null,this.pageIndex=t,this.parent=e,this.xValue=!1,this.yValue=!1,this.hValue=!1,this.wValue=!1},a=t.prototype;return a.getMargin=function(){return{x:this.parent.thumbnailsInfos.margin,y:this.parent.thumbnailsInfos.margin}},a.getOffset=function(){return function(){return this.xValue===!1&&(this.xValue=(this.getIndex()-1)*(this.getSize().w+this.getMargin().x)),this.yValue===!1&&(this.yValue=this.getMargin().y),{x:this.xValue,y:this.yValue}}}(),a.getSize=function(){return function(){return this.hValue===!1&&(this.hValue=this.parent.thumbnailsInfos.scope.height),this.wValue===!1&&(this.wValue=this.parent.thumbnailsInfos.scope.width),{h:this.hValue,w:this.wValue}}}(),a.wakeUp=function(){this.parent.getContext().drawImage(this.image,this.getOffset().x,this.getOffset().y,this.getSize().w,this.getSize().h)},a.draw=function(){var t={};return function(){if(this.image)this.wakeUp();else{if(this.loading)return!1;if(this.loading=!0,this.cvs=cvs,t[this.getIndex()])return this.image=t[this.getIndex()],this.wakeUp(),!1;this.image=new Image,this.image.thumbnailsObject=this,this.image.loadedImages=t,this.image.onload=this.loadedImg,this.image.src=e.Main.pageManager.getImage("ldpi",this.getIndex(this))}}}(),a.getIndex=function(){return this.pageIndex},a.loadedImg=function(){this.loadedImages[this.thumbnailsObject.getIndex()]=this,this.thumbnailsObject.wakeUp()},a.loadImg=void 0,t}(),n.setContext=function(){t=this.getCanvas().getContext("2d")},n.getContext=function(){return t},n.setCanvas=function(){cvs=document.createElement("canvas"),this.cvsInfos.bestSize=this.externalConf.canvasWidth(),cvs.width=this.cvsInfos.bestSize,cvs.height=this.cvsInfos.height,cvs.className="contentMenuBottom",this.setStyleContent(cvs),this.elemParent.appendChild(cvs)},n.getCanvas=function(){return cvs},n.setScope=function(){var e=this.thumbnailsInfos.scope.width+this.thumbnailsInfos.margin;this.cvsInfos.width=this.externalConf.documentWidth(),this.thumbnailsInfos.scope.minPosX=~~this.tweenTarget.x,this.thumbnailsInfos.scope.maxPosX=this.thumbnailsInfos.scope.minPosX+this.cvsInfos.width,this.thumbnailsInfos.scope.scopeLengthPX=this.thumbnailsInfos.scope.maxPosX-this.thumbnailsInfos.scope.minPosX,this.thumbnailsInfos.scope.scopeThumbsLength=Math.ceil(this.thumbnailsInfos.scope.scopeLengthPX/e)+2,this.thumbnailsInfos.scope.scopeMinThumbs=Math.abs(Math.floor(this.thumbnailsInfos.scope.minPosX/e))},n.setCurrentPage=function(){this.thumbnailsInfos.currentPage=this.externalConf.getCurrentPage()},n.getCurrentPage=function(){return this.thumbnailsInfos.currentPage},n.drawCtx=function(){var e=0,t=0,a=0,n=0,i=0;return function(r){this.setScope(),a>150&&(this.thumbCleaner(),a=0),a++,e=this.thumbnailsInfos.scope.scopeMinThumbs+this.thumbnailsInfos.scope.scopeThumbsLength,t=this.thumbnailsInfos.scope.scopeMinThumbs-this.thumbnailsInfos.scope.scopeThumbsLength/2,t=Math.floor(1>t?1:t),e>this.thumbnailsInfos.pagesNb?e=this.thumbnailsInfos.pagesNb:e--,n=t,i=e-n;do n=t+i,this.mainContentScrollable.existeContent("thumb_"+n)||this.mainContentScrollable.addContent("thumb_"+n,new this.Thumbnails(this,n));while(i--);var o=(this.cvsInfos.width-this.thumbnailsInfos.scope.width)/2;return this.mainContentScrollable.draw(r,o),!1}}(),n.thumbCleaner=function(){var e=null,t=0,a=0,n=0;return function(){for(e=this.mainContentScrollable.getContent(),t=this.mainContentScrollable.contentslistNameLength,a=this.thumbnailsInfos.scope.scopeMinThumbs-this.thumbnailsInfos.scope.scopeThumbsLength/2,a=1>a?1:a,n=this.thumbnailsInfos.scope.scopeMinThumbs+this.thumbnailsInfos.scope.scopeThumbsLength;--t>0;)(e.list[t].getIndex(e.list[t])<a||e.list[t].getIndex(e.list[t])>n)&&(this.mainContentScrollable.removeContent(e.names[t],t),t--)}}(),n.imgLoaded=function(){var e=this.thumbnailsObject;e.thumbnailsInfos.height=e.externalConf.thumbHeight?e.externalConf.thumbHeight:this.height,e.thumbnailsInfos.width=e.externalConf.thumbWidth?e.externalConf.thumbWidth:this.width,e.thumbnailsInfos.scope.ratio=e.thumbnailsInfos.width/e.thumbnailsInfos.height;{var t=e.cvsInfos.height-2*e.thumbnailsInfos.margin;t*e.thumbnailsInfos.scope.ratio+2*e.thumbnailsInfos.margin}e.thumbnailsInfos.scope.height=t,e.thumbnailsInfos.scope.width=t*e.thumbnailsInfos.scope.ratio,e.thumbnailsInfos.scope.cvsWidth=(e.thumbnailsInfos.pagesNb-1)*(e.thumbnailsInfos.scope.width+e.thumbnailsInfos.margin),e.thumbnailsInfos.scope.ratioCalc=e.thumbnailsInfos.scope.ratio*e.cvsInfos.height+2*e.thumbnailsInfos.margin,e.setScope(),e.initCtx()},n.setImageInfo=function(){var t=null;return function(){return t=new Image,t.thumbnailsObject=this,t.onload=this.imgLoaded,t.src=e.Main.pageManager.getImage("ldpi",1),!1}}(),n.initCtx=function(){var e=this;this.setCanvas(),this.setContext(),this.mainContentScrollable=new this.MainContentScrollable(this),this.positionneur=new this.Positionneur(this),this.positionneur.setStyle(this.positionneurStyle);var t=0;t=this.thumbnailsInfos.scope.ratioCalc*this.thumbnailsInfos.pagesNb<=this.cvsInfos.bestSize?this.cvsInfos.bestSize:this.thumbnailsInfos.scope.width*this.thumbnailsInfos.pagesNb,this.mainContentScrollable.setWidth(t),this.mainContentScrollable.setHeight(cvs.height),this.mainContentScrollable.setStyle(this.externalConf.backgroundColorBoxShadow()[0]),this.mainContentScrollable.addContent("positionneur",this.positionneur),this.drawCtx(0),this.touchManager.creatEvent($(this.getCanvas())),this.currentTween=new Tween(this.tweenTarget,"x",Tween.strongEaseOut,0,0,this.tZero),this.currentTween.onMotionChanged=function(t){e.tweenUpdate(t)},this.currentTween.start()},n.onResize=function(){var e=null;return function(){var t=this;this.setCurrentPage(),this.setNewGlobalsUpdaterById(),this.cvsInfos.width=this.externalConf.documentWidth(),e&&clearTimeout(e),e=setTimeout(function(){t.isGoToXByPage(t.getCurrentPage())},200)}}(),n.pageChanged=function(){var e=null,t=0;return function(a,n){var i=this;return n?(t=0,i.setCurrentPage(),i.thumbCleaner(),this.isGoToXByPage(a),!1):(e&&5>t&&clearTimeout(e),e=setTimeout(function(){t=0,i.setCurrentPage(),i.thumbCleaner(),i.isGoToXByPage(a)},550),t++,!1)}}(),n.transitTo=function(e,t,a){return e.continueTo(t,a),!1},n.goToPage=function(){return this.externalConf.onThumbClick&&this.externalConf.onThumbClick(this.targetPos),!1},n.isGoToXByPage=function(t){var a=e.Utils.byPageIfDouble(t),n=0,i=this.thumbnailsInfos.scope.width+this.thumbnailsInfos.margin;return n=a.isDoubleDoc&&a.isDouble?-i*(t-1)-i/2:-i*(t-1),this.transitTo(this.currentTween,n,.8),!1},n.TouchManager=function(){var t=!1,a=null,n=!1,i=!1,r={xStart:0,tStart:0,xNew:0,tNew:0},o=null,s=null,l=null,u=null,c=null,d=null,h=null,p=null,g=function(e){this.parent=e,o=function(){var e=null;return function(a,r){return e=r(a),t=!0,i=!1,n=!1,u(e),!1}}(),s=function(){var a=null,r=0,o=0,s=0,l=0;return function(c,h){return!t||n?(t=!1,
i=!1,n=!0,this.touchStartXEvt=!1,!1):(a=h(c),u(a),r=a[0],this.touchStartXEvt||(s=a[0],l=a[2]),this.touchStartXEvt=!0,o=r-s,0!==o&&(i=!0),d(s,l,r,a[2]),targetTween=parseInt(e.tweenTarget.x)+o,targetTween>0&&(targetTween=0),targetTween<-e.thumbnailsInfos.scope.cvsWidth&&(targetTween=-e.thumbnailsInfos.scope.cvsWidth),e.transitTo(e.currentTween,targetTween,e.tZero),s=r,l=a[2],!1)}}(),l=function(r){return n?!1:t&&!i?(e.targetPos=Math.ceil((-e.tweenTarget.x+(a[0]-(e.cvsInfos.width-(e.thumbnailsInfos.scope.width+e.thumbnailsInfos.margin))/2))/(e.thumbnailsInfos.scope.width+e.thumbnailsInfos.margin)),e.goToPage(),t=!1,i=!1,n=!0,this.touchStartXEvt=!1,!1):(t=!1,i=!1,n=!0,this.touchStartXEvt=!1,c(),!1)},u=function(e){return a=e,!1},c=function(){var t=e.tZero,a=0,n=5,i=1.2,o=0,s=0,l=0;return function(){return r.xStart==r.xNew?(a=0,t=e.tZero):(s=(r.xNew-r.xStart)*i,l=r.tNew-r.tStart,o=Math.abs(s/l),a=s*o*n,t=l*o/100*n),(0===t||isNaN(t))&&(t=e.tZero),targetTween=parseInt(e.tweenTarget.x)+a,t/=2,targetTween>0&&(targetTween=0),targetTween<-e.thumbnailsInfos.scope.cvsWidth&&(targetTween=-e.thumbnailsInfos.scope.cvsWidth),e.transitTo(e.currentTween,targetTween,t),!1}}(),d=function(e,t,a,n){return r={xStart:e,tStart:t,xNew:a,tNew:n},!1},h=function(e){return[e.touches[0].pageX,e.touches[0].pageY,e.timeStamp]},p=function(e){return[e.pageX,e.pageY,e.timeStamp]}};return g.prototype.creatEvent=function(t){t=t.get(0);var a="mousedown",n="mouseup",i="mousemove";return e.Param.isTouch?(a="touchstart",n="touchend",i="touchmove",t.addEventListener(a,function(t){o(t,h),e.Utils.preventDefault(t)}),t.addEventListener(n,function(t){l(t),e.Utils.preventDefault(t)}),t.addEventListener(i,function(t){s(t,h),e.Utils.preventDefault(t)})):(t.addEventListener(a,function(e){o(e,p)}),t.addEventListener(n,function(e){l(e)}),t.addEventListener(i,function(e){s(e,p)}),window.addEventListener(n,function(e){l(e,p)})),!1},g}(),n.tweenUpdate=function(e){this.drawCtx(e.target._pos)},n.start=function(){this.setCurrentPage(),this.setImageInfo()},a}()}(webpublicationNamespace),function(e){e.Class.Config=function(t,a){var n=this;n.versionASP="v3",n.aspUrlRootIndex="",n.aspPath="./",n.clientPath="./",n.vendors="",n.pages={},n.activePdfFormat=!0,n.imgFormatSpecialIOS=".pdf",n.appInfo=e.Starter.appInfo,n.getDocument={},n.getDocument.fond={},n.getDocument.fond.color="#ffffff",n.logo={},n.lienInfo={},n.xmlNeededToLoadPath="",n.xmlNeededToLoad=[],n.iconesPath="",n.pathMobile=e.Param.pathMobile,n.usePaginationPointeurCustom=!1,n.menu_alpha=1,n.decalagePage=0,n.startPageName="startPage",n.pathXmlGallery=!1,n.pathXmlSecurity="publication/contents/security.xml",n.stylesFromStyle_css=null,n.UIMenuTop=null,n.setDisableCarrousel=!1,n.loadJavascriptForHtmlSlider=null,n.htmlMenuParam=!1,n.enableSecurityXml=!1,n.securityFileName="security",n.autonomeAttitude=!1,n.typeFileByExtention={mp4:"video",m4v:"video",avi:"video",ogv:"video",webm:"video",wmv:"video",mov:"video",xvid:"video",mka:"video",mks:"video",avc:"video",flv:"video",rmvb:"video",jpg:"image",png:"image",svg:"image",gif:"image",bmp:"image",tiff:"image",mp3:"audio",wav:"audio",aac:"audio",oog:"audio"},n.trackStatInfo={idTrack:null,labelTrack:"",piwikTrack:!0},n.iconesDefaultParam={teinte:"#000000"},n.vendorsList=["ms","Ms","moz","Moz","webkit","Webkit","o","O"],n.pagesOnInit={},n.LinkInfos={},n.LinkInfos.Types={},n.LinkInfos.TypesShort=["ZoomPartiel","VideoFiche","VideoIncruster","Lightbox","Web","GaleriePhoto","GalerieVideo","Fiche","ImageFiche","ImageIncruster","AudioFiche","GotoPage","Phone","Mail","IconeDefault","Animation","PageAnim","None"];for(var i=0;i<n.LinkInfos.TypesShort.length;i++)n.LinkInfos.Types["LinkType"+n.LinkInfos.TypesShort[i]]=i;n.VideoExtSupported=["mp4"],n.VideoTypeSupported=["video/mp4"],n.AudioExtSupported=["mp3","ogg"],n.AudioTypeSupported=["audio/mp3","audio/ogg"],n.getVendor=function(){return n.vendors},n.getXmlNeededToLoad=function(){return e.Starter._CONFIG.htmlMenuParam?n.xmlNeededToLoadHtmlVersion:n.xmlNeededToLoad},n.getTxtNeededToLoad=function(){return n.txtNeededToLoad},n.getIconesPath=function(){return n.iconesPath},n.setIconesPath=function(t){return t?(n.iconesPath=t,!1):(n.iconesPath=e.Param.pathMobile+"icons/",!1)},n.setDocument=function(){n.getDocument.width=window.innerWidth,n.getDocument.height=window.innerHeight},n.setVendor=function(){for(var e=document.body.style,t=n.vendorsList,a=t.length,i=0;a>i&&"string"!=typeof e[n.vendors+"Transition"];++i)n.vendors=t[i]},n.setClientPath=function(){n.clientPath=a+"/"},n.setAllPath=function(){n.setClientPath(),n.xmlNeededToLoadPath=e.Param.pathRoot,n.setPagesOnInit(),n.setPaginationPointeur()},n.setPagesOnInit=function(){n.pagesOnInit={pageFromArray:{},doublePage:!1,forcedPageFormat:!0,slideType:"X",width_or_height:"width",x_or_y:"x",noChangeOnResize:!0,keepMaxResolution:!1,width:1024,height:1356,currScale:1,currScaleMaxDiff:2,currScaleMinDiff:0,scaleDoublTapMax:2,scaleDoublTapMin:0,sensibleZoom:.004,beginPage:e.Starter.urlStartPage,preloadBy:4,activeDragAndDrop:!0,pageCurrentIs:1,length:40,timeToLoadHD:800,pathPagePdf:e.Param.pathRoot+"pdf/",pathTextureHigh:e.Param.pathRoot+"Zoom/",pathTextureLow:e.Param.pathRoot+"Low/",Diapo:e.Param.pathRoot+"Diapo/",videoFichePath:e.Param.pathRoot+"fiches/",videoIncrustePath:e.Param.pathRoot+"multimedia/",imageFichePath:e.Param.pathRoot+"fiches/",imageIncrustePath:e.Param.pathRoot+"multimedia/",qualityGalleryHD:"CoverFlow",audioPath:e.Param.pathRoot+"multimedia/",defaultName:"page",imgFormat:".jpg",imgFormatSpecial:".jpg",listElem:[],animationManager:{swipTime:150,zoomTime:100,transitionTime:350,transitionTimeOut:200,swipEasing:"linear",defEasing:"linear"},enableZoom:!0,flipDelay:!1,canvasKey:"canvas_",element:"element",textureHigh:"pathTextureHigh",textureLow:"pathTextureLow",getTextureHigh:"getTextureHigh",getTextureLow:"getTextureLow"},n.checkAutonomeAttitude(),e.Starter.isMaster&&(n.pagesOnInit.pathTextureLow=e.Param.pathRoot+"Big1/"),"iOS"==n.appInfo.os?(n.pagesOnInit.pathTextureHigh=e.Param.pathRoot+"Zoom/",n.pagesOnInit.pathTextureLow=e.Param.pathRoot+"Zoom/"):"android"==n.appInfo.os?(n.pagesOnInit.pathTextureHigh=e.Param.pathRoot+"Zoom/",n.pagesOnInit.pathTextureLow=e.Param.pathRoot+"Zoom/"):n.autonomeAttitude&&(n.pagesOnInit.pathTextureHigh=e.Param.pathRoot+"integration/DiapoMini/",n.pagesOnInit.pathTextureLow=e.Param.pathRoot+"integration/DiapoMini/");var t=e.Main.urlManager.get("format");"iOS"==e.Param.userAgent.os.name&&n.activePdfFormat&&t&&"pdf"==t?(n.pagesOnInit.pathTextureHigh=e.Param.pathRoot+"pdfs/",n.pagesOnInit.pathTextureLow=e.Param.pathRoot+"pdfs/",n.pagesOnInit.imgFormatSpecial=n.imgFormatSpecialIOS):"android"===e.Param.userAgent.os.name&&(n.pagesOnInit.preloadBy=3)},n.setEnableZoom=function(e){return n.pages.enableZoom=e,!1},n.setPaginationPointeur=function(){if(n.usePaginationPointeurCustom)n.listPagePointeur?n.pagesOnInit.length=n.listPagePointeur.length:(n.usePaginationPointeurCustom=!1,n.setPaginationPointeur());else{n.listPagePointeur=[];for(var e=1;e<=n.pagesOnInit.length;e++)n.listPagePointeur.push(e)}return!1},n.getFlipDelay=function(){return n.pages.flipDelay},n.setFlipDelay=function(e){return n.pages.flipDelay=~~e,!1},n.getPaginationPointeur=function(e){return n.listPagePointeur[e]?n.listPagePointeur[e]:!1},n.checkVideoPathIfIframe=function(){var e=window.parent;return e&&e._CONFIG&&e._CONFIG.asp&&e._CONFIG.asp.urlRootIndex&&(n.aspPath=e._CONFIG.asp.urlRootIndex),!1},n.setDynamiqueVariableFromFlag={publicationPath:function(){return e.Param.pathRoot}},n.getDynamiqueVariableFromFlag=function(e){var t=e.match(/\$\{[^\}]*\}/g),a=e,i=null;if("undefined"!=typeof t&&"undefined"!=typeof t.length)for(var r=0;r<t.length;r++)i=t[r].slice(2,t[r].length-1),n.setDynamiqueVariableFromFlag[i]&&(a=a.replace(t[r],n.setDynamiqueVariableFromFlag[i]()));return a},n.checkAutonomeAttitude=function(){return e.Main.urlManager.get("autonome")&&(n.autonomeAttitude=!0),!1},n.templateList={defaultTmpl:{audio:n.pathMobile+"tmpl/audio.html",mail:n.pathMobile+"template/shareMail.html",popupGlobal:n.pathMobile+"tmpl/popupGlobal.html"},tab:{},phone:{},other:{}},n.setTemplateForDevice=function(){var t={};for(var a in n.templateList.defaultTmpl)n.templateList[e.Param.userAgent.device.type]&&n.templateList[e.Param.userAgent.device.type][a]?n.template[a]=n.templateList[e.Param.userAgent.device.type][a]:t[a]=n.templateList.defaultTmpl[a];return t},n.getTemplatesList=function(){return n.setTemplateForDevice()},n._construct=function(){return n.setAllPath(),n.setIconesPath(),n.pages=e.Utils.clone(n.pagesOnInit),n.setDocument(),n.setVendor(),!1},n._construct()}}(webpublicationNamespace),function(e){e.Class.ControlManager=function(){var t=function(t){this.parent=t,this.originalMiddleX=null,this.newThemeVersion=e.Param.newThemeVersion,this.originalMiddleY=null,this.diffScaleDef=0,this.diffScale=0,this.originalScaleDiff=0,this.transformDiffX=0,this.transformDiffY=0,this.currPosFingerX=null,this.currPosFingerY=null,this.needScaleTo=0,this.scaledTo=!1,this.zooming=!1,this.onScaleGoList=[],this.onScaleGoListEnd=[],this.onshowToolsArray=[],this.onZoomPageArray=[],this.lastGoToPaged=!1,this.flipDelayReport=0,this.flipDelayReportSize=10,this.delayTypeMove=["nextPage","prevPage"],this.dragedElem=!1,this.reScaleCanvasToInitAnimCvs=null,this.reScaleCanvasToInitAnim_scaleDiff=null,this.reScaleCanvasToInitAnim_diffX=null,this.reScaleCanvasToInitAnim_diffY=null,this.reScaleCanvasToInitAnim_lowToHigh=null,this.autoriseChangePage=!0,this.transformDiffDefX=0,this.transformDiffDefY=0,this.showToolsInfo=0,this.originalScaleDiffMaxDiff=e.Starter._CONFIG.pages.currScaleMaxDiff,this.originalScaleDiffMinDiff=e.Starter._CONFIG.pages.currScaleMinDiff,this.tweenedPage={goTo:0},this.tweenZoomTime=e.Starter._CONFIG.pages.animationManager.zoomTime/1e3,e.Starter._CONFIG.pages.activeDragAndDrop||(this.onDragElem=this.onDragElemForAndroid),document.addEventListener(e.Param.eventKeyboardDown,function(t){32===t.keyCode&&e.Main.controlManager.showTools()},!1),e.Main.pageManager.onChange(function(t){e.Main.controlManager.goToPage(t)}),this.tweenPageManager()},a=t.prototype;return a.animIt=function(t,a,n,i){if(n&&(n=~~n),"X"==e.Starter._CONFIG.pages.slideType){if(n)return t[0].className=i,e.Utils.styleTransform(t[0],"translate3d("+a[e.Starter._CONFIG.pages.x_or_y]+"px, 0, 0)"),setTimeout(function(){t[0].className=""},n),!1;var r=a[e.Starter._CONFIG.pages.x_or_y];return"onMove"!=t[0].className&&(t[0].className="onMove"),e.Utils.styleTransform(t[0],"translate3d("+r+"px, 0, 0)"),t[0].className="",!1}if(n)return t[0].className=i,e.Utils.styleTransform(t[0],"translate3d(0, "+a[e.Starter._CONFIG.pages.x_or_y]+"px, 0)"),setTimeout(function(){t[0].className=""},n),!1;var o=a[e.Starter._CONFIG.pages.x_or_y];return"onMove"!=t[0].className&&(t[0].className="onMove"),e.Utils.styleTransform(t[0],"translate3d(0, "+o+"px, 0)"),t[0].className="",!1},a.cleanPosFirstX=function(){var t=null,a=null,n=null,i=null,r=null,o=null,s=e.Main.xmlManager.get("common-configuration","config","pageCount");return function(l,u,c){return r={},t=e.Main.pagesLoader.pageCurrentOriginalIs,a=e.Utils.byPageIfDouble(e.Main.pagesLoader.pageCurrentOriginalIs),u&&(t=u),n=e.Starter._CONFIG.pages.animationManager.transitionTime,i=t+l,i>s?a.isDouble?(a=e.Utils.byPageIfDouble(s),a.isDoublePage[2]&&(i=s-1)):i=s:1>i&&(i=1),(o=e.Main.pagesLoader.pageCreated[e.Starter._CONFIG.pages.defaultName+""+i])?(0>l&&this.lastGoToPaged&&1!=i?(r[e.Starter._CONFIG.pages.x_or_y]=-e.Utils.getLocalSize(e.Starter._CONFIG.pages.width_or_height),this.animIt(o,r,0,"onOut"),this.lastGoToPaged=!1):l>0&&this.lastGoToPaged&&i!=s&&(r[e.Starter._CONFIG.pages.x_or_y]=e.Utils.getLocalSize(e.Starter._CONFIG.pages.width_or_height),this.animIt(o,r,0,"onOut"),this.lastGoToPaged=!1),r[e.Starter._CONFIG.pages.x_or_y]=0,e.Starter.main.currElemPos[i][e.Starter._CONFIG.pages.x_or_y]=r[e.Starter._CONFIG.pages.x_or_y],c&&(this.lastGoToPaged=!0,n=0),o[0].className="onIn",this.animIt(o,r,n,"onIn"),i):!1}}(),a.cleanPosX=function(){var t=null,a=null,n=null,i=null,r=0,o=null,s=e.Main.xmlManager.get("common-configuration","config","pageCount");return function(l,u,c,d){t=e.Main.pagesLoader.pageCurrentOriginalIs,a=null,n=null,o="onIn",u&&(t=u),i=e.Starter._CONFIG.pages.animationManager.transitionTime,r=e.Starter._CONFIG.pages.defaultName.length;for(var h in e.Main.pagesLoader.pageCreated)if(a=e.Main.pagesLoader.pageCreated[h],h=~~h.substr(r),c!==h&&(n={},a)){if(h>t+l&&t+l>=1)n[e.Starter._CONFIG.pages.x_or_y]=e.Utils.getLocalSize(e.Starter._CONFIG.pages.width_or_height),i=e.Starter._CONFIG.pages.animationManager.transitionTimeOut,o="onOut";else if(t+l>h){if(h==s)continue;n[e.Starter._CONFIG.pages.x_or_y]=-e.Utils.getLocalSize(e.Starter._CONFIG.pages.width_or_height),i=e.Starter._CONFIG.pages.animationManager.transitionTimeOut,o="onOut"}e.Starter.main.currElemPos[h]&&(n[e.Starter._CONFIG.pages.x_or_y]||0==n[e.Starter._CONFIG.pages.x_or_y])&&n[e.Starter._CONFIG.pages.x_or_y]!=e.Starter.main.currElemPos[h][e.Starter._CONFIG.pages.x_or_y]&&((n[e.Starter._CONFIG.pages.x_or_y]<0&&e.Starter.main.currElemPos[h][e.Starter._CONFIG.pages.x_or_y]>0||n[e.Starter._CONFIG.pages.x_or_y]>0&&e.Starter.main.currElemPos[h][e.Starter._CONFIG.pages.x_or_y]<0)&&(i=0,o="onMove"),h>s||(e.Starter.main.currElemPos[h][e.Starter._CONFIG.pages.x_or_y]=n[e.Starter._CONFIG.pages.x_or_y],d&&(this.lastGoToPaged=!0,i=0,o="onMove"),this.animIt(a,n,i,o)))}return!1}}(),a.onZoomedPage=function(){var t=0;return function(){for(t=this.onZoomPageArray.length;t--;)this.onZoomPageArray[t](e.Main.pagesLoader.pageCurrentOriginalIs);return!1}}(),a.onScaledGo=function(){var e=null;return function(t){if(t)for(e=this.onScaleGoList.length;e--;)this.onScaleGoList[e]();else for(e=this.onScaleGoListEnd.length;e--;)this.onScaleGoListEnd[e]();return!1}}(),a.goRender=function(){var t=null;return function(){return t=e.Main.canvasManager.textureContextList[e.Starter._CONFIG.pages.canvasKey+e.Main.pagesLoader.pageCurrentOriginalIs],e.Main.canvasManager.constructPos(t,e.Main.pagesLoader.pageCurrentOriginalIs,this.diffScale,this.transformDiffX,this.transformDiffY,function(a){return t[e.Starter._CONFIG.pages.getTextureHigh+"0"]&&t[e.Starter._CONFIG.pages.textureHigh+"0"].readyToDraw?t[e.Starter._CONFIG.pages.textureHigh+"0"].readyToDraw():t[e.Starter._CONFIG.pages.getTextureLow+"0"]&&t[e.Starter._CONFIG.pages.textureLow+"0"].readyToDraw&&t[e.Starter._CONFIG.pages.textureLow+"0"].readyToDraw(),t[e.Starter._CONFIG.pages.getTextureHigh+"1"]&&t[e.Starter._CONFIG.pages.textureHigh+"1"].readyToDraw?t[e.Starter._CONFIG.pages.textureHigh+"1"].readyToDraw():t[e.Starter._CONFIG.pages.getTextureLow+"1"]&&t[e.Starter._CONFIG.pages.textureLow+"1"].readyToDraw&&t[e.Starter._CONFIG.pages.textureLow+"1"].readyToDraw(),!1},this.currPosFingerX,this.currPosFingerY,this),!1}}(),a.reScaleCanvasToInitAnim=function(){return function(t,a,n,i,r,o){return this.reScaleCanvasToInitAnim_scaleDiff=t,this.reScaleCanvasToInitAnim_diffX=a,this.reScaleCanvasToInitAnim_diffY=n,this.reScaleCanvasToInitAnim_lowToHigh=r,this.reScaleCanvasToInitAnimCvs=e.Main.canvasManager.textureContextList[e.Starter._CONFIG.pages.canvasKey+e.Main.pagesLoader.pageCurrentOriginalIs],this.tweenedPage.callBackAfterAnim=i,this.tweenedPage.goTo=this.reScaleCanvasToInitAnim_lowToHigh,this.currentTween.continueTo(this.tweenedPage.goTo,this.tweenZoomTime),!1}}(),a.tweenPageManager=function(){var e=this;this.currentTween=new Tween(this.tweenedPage,"goTo",Tween.regularEaseOut,0,0,.01),this.currentTween.onMotionChanged=function(t){e.reScaleCanvasToInitAnimGo(t.target._pos,e)},this.currentTween.onMotionFinished=function(){this.obj.callBackAfterAnim&&this.obj.callBackAfterAnim.call(e)}},a.goRenderSimple=function(){return function(e){return this.reScaleCanvasToInitAnim(this.diffScale,this.transformDiffX,this.transformDiffY,!1,1,e),!1}}(),a.reScaleCanvasToInitAnimGo=function(){return function(t,a){return this.reScaleCanvasToInitAnim_lowToHigh?reScaleCanvasToInitCScaleDiff=this.originalScaleDiffMaxDiff/2*t:(t=1-t,reScaleCanvasToInitCScaleDiff=this.originalScaleDiffMaxDiff/2*t,reScaleCanvasToInitCScaleDiff=this.reScaleCanvasToInitAnim_scaleDiff/2-reScaleCanvasToInitCScaleDiff),reScaleCanvasToInitCScaleDiff<=this.originalScaleDiffMinDiff?reScaleCanvasToInitCScaleDiff=this.originalScaleDiffMinDiff:reScaleCanvasToInitCScaleDiff>this.originalScaleDiffMaxDiff&&(reScaleCanvasToInitCScaleDiff=this.originalScaleDiffMaxDiff),e.Main.canvasManager.constructPos(this.reScaleCanvasToInitAnimCvs,e.Main.pagesLoader.pageCurrentOriginalIs,reScaleCanvasToInitCScaleDiff,this.reScaleCanvasToInitAnim_diffX*(1-t),this.reScaleCanvasToInitAnim_diffY*(1-t),function(t){return t[e.Starter._CONFIG.pages.getTextureHigh+"0"]&&t[e.Starter._CONFIG.pages.textureHigh+"0"].readyToDraw?t[e.Starter._CONFIG.pages.textureHigh+"0"].readyToDraw():t[e.Starter._CONFIG.pages.getTextureLow+"0"]&&t[e.Starter._CONFIG.pages.textureLow+"0"].readyToDraw&&t[e.Starter._CONFIG.pages.textureLow+"0"].readyToDraw(),t[e.Starter._CONFIG.pages.getTextureHigh+"1"]&&t[e.Starter._CONFIG.pages.textureHigh+"1"].readyToDraw?t[e.Starter._CONFIG.pages.textureHigh+"1"].readyToDraw():t[e.Starter._CONFIG.pages.getTextureLow+"1"]&&t[e.Starter._CONFIG.pages.textureLow+"1"].readyToDraw&&t[e.Starter._CONFIG.pages.textureLow+"1"].readyToDraw(),!1}),!1}}(),a.onShowedTools=function(){var e=null,t=0;return function(){for(e=this.onshowToolsArray.length,t=0;e>t;t++)this.onshowToolsArray[t](this.showToolsInfo);return!1}}(),a.showTools=function(t){if(e.Main.menuManager.hideMenu())return!1;if(null===e.Main.startupManager.get("ui.menu")&&null===e.Main.startupManager.get("ui.carousel")&&null===e.Main.startupManager.get("ui.paging"))this.showToolsInfo=0;else if(t===!1)this.showToolsInfo=0;else if(t===!0)this.showToolsInfo=1;else if(0===this.showToolsInfo)this.showToolsInfo=1;else{if(1!==this.showToolsInfo)return!1;this.showToolsInfo=0}return 0===this.showToolsInfo?(this.newThemeVersion||document.body.classList.remove("tools_status_show"),e.Main.paginationManager.showPaginations(!1),e.Main.menuManager.hideTopnav()):(this.newThemeVersion||document.body.classList.add("tools_status_show"),e.Main.paginationManager.showPaginations(!0),e.Main.menuManager.showTopnav()),this.onShowedTools(),!1},a.onShowTools=function(e){return this.onshowToolsArray.push(e),!1},a.flipDelay=function(){var t=!1,a=0,n=null;return function(){var i=this;return"undefined"!=typeof e.Starter._CONFIG.getFlipDelay()&&e.Starter._CONFIG.getFlipDelay()>0&&(t||(e.Main.eventEmul.listenEvent("onPageUnChangeable",function(e){a=e}),t=!0),this.flipDelayReport=0,n&&clearTimeout(n),n=setTimeout(function(){i[this.delayTypeMove[a]](),i.flipDelay()},1e3*(e.Starter._CONFIG.getFlipDelay()+this.flipDelayReport))),!1}}(),a.nextPage=function(){var t=null,a=null,n=null,i=null;return function(r){var o=this;return o.autoriseChangePage?(t=e.Main.pagesLoader.pageCurrentOriginalIs,a=1,n=e.Utils.byPageIfDouble(t),n.isDouble&&(a=2),i=this.cleanPosFirstX(a),this.cleanPosX(a,null,i),r?!1:(e.Main.pagesLoader.pageCurrentOriginalIs!==e.Main.xmlManager.get("common-configuration","config","pageCount")&&!e.Param.newViewerVersion&&e.Main.linksManager&&e.Main.linksManager.hideLayerLinks(),window.requestAnimationFrame(function(){e.Main.pagesLoader.nextPage()}),!1)):!1}}(),a.prevPage=function(){var t=null;return function(a){return this.autoriseChangePage?(t=-1,e.Utils.byPageIfDouble(e.Main.pagesLoader.pageCurrentOriginalIs+t).isDouble&&(t=-2),this.cleanPosX(t,null,this.cleanPosFirstX(t)),a?!1:(1!==e.Main.pagesLoader.pageCurrentOriginalIs&&!e.Param.newViewerVersion&&e.Main.linksManager&&e.Main.linksManager.hideLayerLinks(),window.requestAnimationFrame(function(){e.Main.pagesLoader.prevPage()}),!1)):!1}}(),a.nextOrPrev=function(){return function(t,a){return e.Utils.byPageIfDouble(t).isDouble&&e.Utils.impair(t)&&t--,this.cleanPosX(0,t,this.cleanPosFirstX(0,t,a),a),!1}}(),a.goToPage=function(){return function(t){var a=this;return t=~~t,e.Utils.byPageIfDouble(t).isDouble&&e.Utils.impair(t)&&t--,this.scaledTo?(this.scaleEnd(),this.scaleGo(!1,!1,!1,1),setTimeout(function(){e.Main.pagesLoader.pageCreated[e.Starter._CONFIG.pages.defaultName+""+t]&&a.nextOrPrev(t,!0),e.Main.pagesLoader&&e.Main.pagesLoader.goToPage(t)},e.Starter._CONFIG.pages.animationManager.zoomTime+10),!1):a.autoriseChangePage?(a.nextOrPrev(t,!0),e.Main.pagesLoader&&e.Main.pagesLoader.goToPage(t),!1):!1}}(),a.onDragElemForAndroid=function(e,t,a){return this.autoriseChangePage!==!0?(this.scaleGo(!1,!1,a,0),!1):(this.dragedElem=!0,this.flipDelayReport=this.flipDelayReportSize,this.flipDelay(),!1)},a.onDragElem=function(t,a,n){return this.autoriseChangePage!==!0?(this.scaleGo(!1,!1,n,0),!1):(this.dragedElem=!0,this.flipDelayReport=this.flipDelayReportSize,this.flipDelay(),e.Main.positionForSlider.onDragElem(t,a),!1)},a.onDropElem=function(t){return this.autoriseChangePage===!1?(this.scaleEnd(),!1):(e.Main.pagesLoader.pageCreated[e.Starter._CONFIG.pages.defaultName+""+e.Main.pagesLoader.pageCurrentOriginalIs][0].className="",e.Main.positionForSlider.onDropElem(t),!1)},a.initialPage=function(){var t=null;return function(){if(!this.autoriseChangePage)return!1;t=e.Main.pagesLoader.pageCreated[e.Starter._CONFIG.pages.defaultName+""+e.Main.pagesLoader.pageCurrentOriginalIs],e.Starter.main.currElemPos[e.Main.pagesLoader.pageCurrentOriginalIs][e.Starter._CONFIG.pages.x_or_y]=0;var a=function(){e.Main.eventEmul.callEvent("endTranslation")};t[0].className="onIn",e.Utils.styleTransform(t[0],"translate3d(0, 0, 0)");var n=~~e.Starter._CONFIG.pages.animationManager.transitionTime;return setTimeout(function(){t[0].className="",a&&(a(),setTimeout(function(){a()},30))},n),!1}}(),a.onZoomPage=function(e){return this.onZoomPageArray.push(e),this.onZoomPageArray.length},a.resetZoomInfo=function(){this.autoriseChangePage=!1,this.currPosFingerX=0,this.currPosFingerY=0,this.needScaleTo=e.Starter._CONFIG.pages.scaleDoublTapMin,this.diffScale=0;var t=e.Main.pagesLoader.pageCreated[e.Starter._CONFIG.pages.defaultName+""+e.Main.pagesLoader.pageCurrentOriginalIs];return t[0].className="onIn",e.Utils.styleTransform(t[0],"translate3d(0, 0, 0)"),setTimeout(function(){t[0].className=""},0),this.scaledTo=!1,this.autoriseChangePage=!0,!1},a.onScaleGo=function(e,t){return e&&this.onScaleGoList.push(e),t&&this.onScaleGoListEnd.push(t),!1},a.scaleGo=function(){var t=!1,a={pageX:0,pageY:0},n={pageX:0,pageY:0},i=0,r=0;return function(o,s,l,u){var c=this;if(e.Starter._CONFIG.pages.enableZoom===!1||null===e.Main.startupManager.get("ui.zoom"))return!1;if(this.autoriseChangePage=!1,o===!1&&s===!1?(t=!0,l?(o=l,s=l):(o=a,s=n,o.pageX=e.Starter._CONFIG.getDocument.width/2,o.pageY=e.Starter._CONFIG.getDocument.height/2,s.pageX=e.Starter._CONFIG.getDocument.width/2,s.pageY=e.Starter._CONFIG.getDocument.height/2)):t===!0&&(t=!1,this.scaleEnd()),u&&(this.scaledTo?this.needScaleTo=e.Starter._CONFIG.pages.scaleDoublTapMin:(this.needScaleTo=e.Starter._CONFIG.pages.currScaleMaxDiff/2,this.originalScaleDiff=0,this.diffScaleDef=this.needScaleTo)),this.currPosFingerX=(o.pageX+s.pageX)/2,this.currPosFingerY=(o.pageY+s.pageY)/2,this.originalMiddleX||(this.originalMiddleX=this.currPosFingerX,this.originalMiddleY=this.currPosFingerY),this.transformDiffX=this.transformDiffDefX+(this.originalMiddleX-this.currPosFingerX),this.transformDiffY=this.transformDiffDefY+(this.originalMiddleY-this.currPosFingerY),t===!1?(i=o.pageX-s.pageX,i*=i,r=o.pageY-s.pageY,r*=r,this.diffScale=Math.pow(i+r,.5)*e.Starter._CONFIG.pages.sensibleZoom,e.Utils.styleTransform(e.Main.linksManager.superLayer,"translate3d(0, 0 , 0)")):this.diffScale=0,this.originalScaleDiff||(this.originalScaleDiff=this.diffScale),this.diffScale=this.diffScale-this.originalScaleDiff+this.diffScaleDef,this.diffScale<=this.originalScaleDiffMinDiff?(this.diffScale=this.originalScaleDiffMinDiff,this.autoriseChangePage=!0):this.diffScale>=this.originalScaleDiffMaxDiff&&(this.diffScale=this.originalScaleDiffMaxDiff),this.dragedElem){this.dragedElem=!1;var d=e.Main.pagesLoader.pageCreated[e.Starter._CONFIG.pages.defaultName+e.Main.pagesLoader.pageCurrentOriginalIs];d[0].className="onIn",e.Utils.styleTransform(d[0],"translate3d(0, 0, 0)"),setTimeout(function(){d[0].className=""},0)}return u?this.scaledTo?(this.scaledTo=this.zooming=!1,this.autoriseChangePage=!0,this.scaleEnd(),this.onScaledGo(!1),e.Main.linksManager.removeFixSwiffyAnims()):(this.goRenderSimple(this),this.scaledTo=this.zooming=!0,this.scaleEnd(),this.onScaledGo(!0),e.Main.linksManager.addFixSwiffyAnims(),e.Main.trackerManager.trackPage({name:"zoom",variables:{1:e.Main.pagesLoader.pageCurrentOriginalIs}})):(this.zooming||e.Main.linksManager.addFixSwiffyAnims(),this.zooming=!0,window.requestAnimationFrame(function(){c.goRender()})),!1}}(),a.scaleEnd=function(){return function(){return this.originalMiddleX=null,this.originalMiddleY=null,this.autoriseChangePage?(this.scaledTo=!1,this.reScaleCanvasToInitAnim(this.diffScale,this.transformDiffX,this.transformDiffY,function(){this.diffScale=0,this.originalScaleDiff=0,this.diffScaleDef=0,this.transformDiffDefX=0,this.transformDiffDefY=0,this.transformDiffX=0,this.transformDiffY=0,this.autoriseChangePage=!0,this.onZoomedPage()},0,this)):(this.scaledTo=!0,this.originalScaleDiff=0,this.diffScaleDef=this.diffScale,this.transformDiffDefX=this.transformDiffX,this.transformDiffDefY=this.transformDiffY),!1}}(),a.drawCanvas=function(){var t=null;return function(){return e.Param.newViewerVersion||(t=e.Main.canvasManager.textureContextList[e.Starter._CONFIG.pages.canvasKey+e.Main.pagesLoader.pageCurrentOriginalIs],t[e.Starter._CONFIG.pages.getTextureHigh+"0"]&&!t[e.Starter._CONFIG.pages.textureHigh+"0"].drawed&&t[e.Starter._CONFIG.pages.getTextureHigh+"0"](),t[e.Starter._CONFIG.pages.getTextureHigh+"1"]&&!t[e.Starter._CONFIG.pages.textureHigh+"1"].drawed&&t[e.Starter._CONFIG.pages.getTextureHigh+"1"]()),!1}}(),t}()}(webpublicationNamespace),function(e){e.Class.EventEmul=function(){var t=function(){this.funcListStockCallBack={}},a=t.prototype;return a.callEvent=function(){var e=null;return function(t){if(!this.existEvent(t))return!1;var a=this.funcListStockCallBack[t+"CallBackList"];e=Array.prototype.slice.call(arguments,1);for(var n in a)a[n].apply(this,e);return!1}}(),a.unbindEvent=function(){var e=null;return function(t){if(e=t+"CallBackList",this.funcListStockCallBack[e]){for(var a in this.funcListStockCallBack[e])this.funcListStockCallBack[e][a]=null,delete this.funcListStockCallBack[e][a];delete this.funcListStockCallBack[e]}return!1}}(),a.unbindById=function(){return function(e,t){return methodCallbackName=e+"CallBackList",this.funcListStockCallBack[methodCallbackName]&&this.funcListStockCallBack[methodCallbackName][t]&&(this.funcListStockCallBack[methodCallbackName][t]=null,delete this.funcListStockCallBack[methodCallbackName][t]),!1}}(),a.existEvent=function(){return function(e){return this.funcListStockCallBack[e+"CallBackList"]&&Object.keys(this.funcListStockCallBack[e+"CallBackList"]).length?!0:!1}}(),a.listenEvent=function(){var t=null,a=null;return function(n,i){return t=n+"CallBackList",a=e.Utils.uniqueId(),this.funcListStockCallBack[t]||(this.funcListStockCallBack[t]={}),this.funcListStockCallBack[t][a]=i,a}}(),t}()}(webpublicationNamespace),function(e){e.Class.EventManagerFlip=function(){var t=50,a=50,n=300,i=!1,r=!1,o=!1,s=!1,l=0,u=function(e,t){return e.eventOverride&&e.eventOverride[t]?!0:!1},c=function(){var e=null;return function(t){return e=t.timeStamp?t.timeStamp:(new Date).getTime()}}(),d=function(){s===!1?(o=!1,s=l):l-s>n?(o=!1,s=l):o=l},h=function(t){u(t.target,this.conf.TOUCHEND)===!1&&(l=c(t),this.touchEndEvent=e.Param.isTouch?t.targetTouches:t,d(),this.eventDispatcher())},p=function(){var t,a,n=5;return function(r){if(u(r.target,this.conf.TOUCHMOVE)===!1){if(this.touchStartEvent===!1)return!1;if(i=r,this.touchMoveEvent=e.Param.isTouch?r.targetTouches:r,t=this.touchMoveEvent.pageX||this.touchMoveEvent[0].pageX||0,a=this.touchStartEvent.pageX||this.touchStartEvent[0].pageX||0,Math.abs(t-a)<n)return this.touchMoveEvent=!1,e.Utils.preventDefault(r),!1;this.eventDispatcher(),e.Utils.preventDefault(r)}}}(),g=function(t){u(t.target,this.conf.MULTITOUCHMOVE)===!1&&(e.Param.isTouch&&t.targetTouches.length>1&&(this.multiTouchEvent=t.targetTouches),e.Utils.preventDefault(t))},m=function(t){if(u(t.target,this.conf.TOUCHSTART)===!1){if(l=0,this.touchStartEvent=!1,this.touchMoveEvent=!1,this.touchEndEvent=!1,this.multiTouchEvent=!1,e.Param.isTouch){if(this.touchStartEvent={0:{pageX:t.targetTouches[0].pageX,pageY:t.targetTouches[0].pageY,target:t.targetTouches[0].target}},t.targetTouches[1])return this.touchStartEvent[1]={pageX:t.targetTouches[1].pageX,pageY:t.targetTouches[1].pageY,target:t.targetTouches[1].target},t.targetTouches.length>1&&(this.multiTouchEvent=this.touchStartEvent),e.Utils.preventDefault(t),this.eventDispatcher(),!1}else this.touchStartEvent=t;e.Utils.preventDefault(t),this.eventDispatcher()}},f=e.Param.newViewerVersion?function(){e.Main.viewerManager.goToPage("next")}:function(){e.Main.controlManager.nextPage()},v=e.Param.newViewerVersion?function(){e.Main.viewerManager.goToPage(1)}:function(){e.Main.controlManager.initialPage()},b=e.Param.newViewerVersion?function(){e.Main.viewerManager.goToPage("next")}:function(){e.Main.controlManager.prevPage()},y=function(){var t,a,n,i,o;return function(){return t=this.touchMoveEvent,e.Param.isTouch&&(t=this.touchMoveEvent[0]),r===!1?(a=t.pageX,n=t.pageY,r=!0,!1):(i=t.pageX,o=t.pageY,this.moveX=i-a,this.moveY=o-n,void e.Main.controlManager.onDragElem(this.moveX,this.moveY,t))}}(),w=function(t,a){e.Main.controlManager.scaleGo(t,a)},C=function(){var n,r,o;return function(){o="phone"===e.Param.userAgent.device.type?a*e.Param.valuePixelRatio:t*e.Param.valuePixelRatio,n=this["move"+e.Starter._CONFIG.pages.slideType],r=o/window.innerWidth*e.Starter._CONFIG.getDocument[e.Starter._CONFIG.pages.width_or_height],e.Main.controlManager.onDropElem(n),Math.abs(n)>r?n>=0?b():f():v(),e.Utils.preventDefault(i),this.reset()}}(),M=function(){e.Main.controlManager.scaleEnd()},P=function(){(this.showMenu===!0||document.body.classList.contains("tools_status_show"))&&e.Main.controlManager.showTools(),this.reset()},x=function(t){this.elem=t,this.reset();var a="mousedown",n="mouseup",i="mousemove";e.Param.isTouch&&(a="touchstart",n="touchend",i="touchmove"),this.elem.addEventListener(a,m.bind(this),!1),this.elem.addEventListener(n,h.bind(this),!1),this.elem.addEventListener(i,p.bind(this),!1),this.elem.addEventListener(i,g.bind(this),!1)};return x.prototype.eventDispatcher=function(){var t=null,a=!1;return function(){if(o!==!1)return t=this.touchStartEvent,e.Param.isTouch&&(t=this.touchStartEvent[0]),e.Main.controlManager.scaleGo(!1,!1,t,1),o=!1,!1;if(this.multiTouchEvent!==!1)return this.touchEndEvent===!1?w.call(this,this.multiTouchEvent[0],this.multiTouchEvent[1]):(this.multiTouchEvent=!1,this.touchEndEvent=!1,M.call(this)),!1;if(this.touchStartEvent!==!1){if(this.touchMoveEvent!==!1)return this.touchEndEvent===!1?(o=!1,s=!1,y.call(this)):C.call(this),!1;if(this.touchEndEvent===!1)return a!==!1&&(clearTimeout(a),a=!1),!1;var i=null,r=null,l={info:!1};e.Param.isTouch?(i=this.touchStartEvent[0].pageX,r=this.touchStartEvent[0].pageY):(i=this.touchStartEvent.pageX,r=this.touchStartEvent.pageY),e.Main.linksManager.findLinkTypeClickedFromCurrentPage(i,r,l),this.showMenu=l.info===!0?!1:!0,a!==!1&&clearTimeout(a),a=setTimeout(function(){P.call(this),clearTimeout(a),a=!1}.bind(this),n)}}}(),x.prototype.reset=function(){r=!1,this.touchStartEvent=!1,this.touchMoveEvent=!1,this.touchEndEvent=!1,this.multiTouchEvent=!1,this.moveX=0,this.moveY=0,l=0},x.prototype.conf={TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",MULTITOUCHMOVE:"multitouchmove"},x}()}(webpublicationNamespace),function(e){e.Class.HtmlViewerManager=function(){function t(e,t,a){var n=document.createElement("div");return n.style.width=e+"px",n.style.height=t+"px",
"undefined"==typeof a&&(a=5),"number"==typeof a?n.style.borderRadius=a+"px":"string"==typeof a?n.style.borderRadius=a:(n.style.borderTopLeftRadius=(a.tl||0)+"px",n.style.borderTopRightRadius=(a.tr||0)+"px",n.style.borderBottomRightRadius=(a.br||0)+"px",n.style.borderBottomLeftRadius=(a.bl||0)+"px"),n}function a(e,t){var a=f[e+M.deltaFrameInDOM];if("undefined"!=typeof a)if(a.innerHTML="",t===!1)a.style.background=M.pageBgColor;else if(1==t.length)a.style.background=t[0];else{var n=(parseInt(a.style.width)-t.length*b)/2,i="linear-gradient(90deg";for(var r in t){var o=r>0,s=r==t.length-1,l=r*b+(o?n:0),u=l+b+n+(s?n:0),c=t[r];i+=","+c+" "+l+"px",i+=","+c+" "+u+"px"}i+=")",a.style.background=i}}function n(t,a,n,i){var r=f[a+M.deltaFrameInDOM].querySelector("[data-pageNumber='"+t.pageNumber+"']");r&&(r.parentNode.removeChild(r),r=null),t.style.left=n+"px",t.style.top=w+"px","IMG"===t.tagName.toUpperCase()?t.classList.add("webpub-viewer__page-img"):"DIV"===t.tagName.toUpperCase()&&t.classList.add("webpub-viewer__page-container"),0===a&&i?(t.style.width=b*M.zoomScale+"px",t.style.height=y*M.zoomScale+"px",e.Utils.scaleDom3d(t,1/M.zoomScale,0,0)):(t.style.width=b+"px",t.style.height=y+"px",e.Utils.resetDomTransform(t)),f[a+M.deltaFrameInDOM].appendChild(t)}function i(e){var t=document.createElement("div");return t.classList.add("webpub-viewer__page-container"),t.style.width=e.style.width,t.style.height=e.style.height,t.style.left=e.style.left,t.style.top=e.style.top,t.pageNumber=e.pageNumber,e.style="",e.parentNode&&e.parentNode.removeChild(e),t.appendChild(e),t}function r(e,t){return"IMG"===e.tagName.toUpperCase()&&(e=i(e)),t.classList.add("webpub-viewer__page-link-image","webpub-viewer__link"+t.idLink),t.style.width=100*t.coord.width/t.coord.container.width+"%",t.style.height=100*t.coord.height/t.coord.container.height+"%",t.style.left=100*t.coord.x/t.coord.container.width+"%",t.style.top=100*t.coord.y/t.coord.container.height+"%",e.appendChild(t),e}function o(a,n){"IMG"===a.tagName.toUpperCase()&&(a=i(a)),a.classList.add("webpub-viewer__page-container");var r,o=parseInt(a.style.width),s=parseInt(a.style.height),l=o/n.container.width,u=s/n.container.height,c=n.w*l*100/o+"%",d=n.h*u*100/s+"%";return"rect"===n.type?r=t(c,d):"circle"===n.type?r=t(c,d,"50%"):"roundrect"===n.type?r=t(c,d,n.radius):"roundrectcomplex"===n.type&&(r=t(c,d,{tl:n.tl_radius,tr:n.tr_radius,br:n.br_radius,bl:n.bl_radius})),r.classList.add("webpub-viewer__page-link-dom","webpub-viewer__link"+n.id),r.style.border="1px solid "+e.Main.cssManager.getStyle("secondary","linkColor"),r.style.backgroundColor=e.Main.cssManager.getStyle("secondary","linkBackgroundColor"),r.style.left=n.x*l*100/o+"%",r.style.top=n.y*u*100/s+"%",a.appendChild(r),a}function s(e){b=e.width,y=e.height,w=e.top,C=e.left}function l(){}function u(){}function c(){g=window.innerWidth,m=window.innerHeight;for(var e,t=f.length;t--;)e=f[t],M.verticalSlider?e.style.top=t*m+"px":e.style.left=t*g+"px",e.style.width=g+"px",e.style.height=m+"px"}function d(){for(var e,t=-M.deltaFrameInDOM;t<=M.deltaFrameInDOM;)e=document.createElement("div"),e.className="webpub-viewer__frame-container",e.id="webpub-viewer__frame-"+t,M.container.appendChild(e),f[t+M.deltaFrameInDOM]=e,t++}function h(e){var t;for(t in e)"undefined"!=typeof M[t]&&(M[t]=e[t]);v&&c()}function p(e){h(e||{}),d(),v=!0}var g=0,m=0,f=(Math,[]),v=!1,b=0,y=0,w=0,C=0,M={deltaFrameInDOM:1,pagesInFrame:1,pagesRetina:!0,pageShadowSize:0,maxZoom:2.5,zoomScale:2,pageBgColor:"rgb(240, 240, 240, 0)",useBgColorPerPage:!0,verticalSlider:!1,container:null};return{init:p,setConfig:h,clearDomFrame:a,addImageIntoPageDom:r,addLinkBoxIntoPageDom:o,visualizePageAtFrame:n,zoomIn:l,zoomOut:u,setPageSize:s,onResize:c}}}(webpublicationNamespace),function(e){e.Class.LinksManager=function(e){var t="globals_style",a="video_bg_style",n="video_bt_circle_play_style",i="video_bt_triangle_play_style",o="text_style",s="background_style",l=2,u="http://www.w3.org/2000/svg",c=function(t){var a=this;this.parent=t,this.superLayer=null,this.subSuperLayer=null,this.drawedOnes=!1,this.declareTemporaryElemList={},this.createSuperLinksLayer(),e.Main.eventEmul.listenEvent("onHDPageDraw",function(e,t,n){a.onHDPageDraw(e,t,n),a.superLayerManipulateur(e,n)}),e.Main.eventEmul.listenEvent("onClickPage",function(e,t,n){a.findLinkTypeClickedFromCurrentPage(e,t,n)}),e.Main.eventEmul.listenEvent("onPageFormatChanged",function(t){a.drawedOnes=!1,a.updateLayer(e.Starter.getCurrentPage())}),e.Utils.prodTools.onPageChange(function(t){a.superLayerManipulateur(t,e.Main.canvasManager.getCurrentPageObjectContext()),a.updateLayer(t)}),e.Main.eventEmul.listenEvent("onDragPage",function(t){"X"==e.Starter._CONFIG.pages.slideType?(0===t?(a.superLayer.style.msTransition="-ms-transform 400ms",a.superLayer.style.webkitTransition="-webkit-transform 400ms",a.superLayer.style.transition="transform 400ms"):e.Utils.styleTransition(a.superLayer,"none"),e.Utils.styleTransform(a.superLayer,"translate3d("+t+"px, 0, 0)")):e.Utils.styleTransform(a.superLayer,"translate3d(0, "+t+"px, 0)")})},d=c.prototype;return d.eventOverride=function(){var t={video:{}};return t.video[e.Class.EventManagerFlip.prototype.conf.TOUCHSTART]=!0,t.video[e.Class.EventManagerFlip.prototype.conf.TOUCHEND]=!0,t}(),d.hideLayerLinks=function(){this.subSuperLayer.style.display="none"},d.updateLayer=function(t){for(var a=this.subSuperLayer.children,n=a.length;n--;)null!==a[n]&&("VIDEO"==a[n].nodeName&&a[n].pause(),a[n].swiffyElement&&a[n].swiffyElement.swiffyObject&&a[n].swiffyElement.swiffyObject.destroy(),-1!==a[n].className.indexOf("windows_hack_page_")?a[n].style.display="none":(this.subSuperLayer.removeChild(a[n]),a[n]=null));window.setTimeout(function(){for(var t=document.querySelectorAll(".windows_hack_page_"+e.Starter.getCurrentPage()),a=t.length;a--;)t[a].style.display=""},200),this.subSuperLayer.appendChild(this.subSuperLayerFliper),this.superLayerDrawer(t,e.Main.canvasManager.getCurrentPageObjectContext()),this.subSuperLayer.style.display=""},d.createSuperLinksLayer=function(){var t=!1;return function(){return t?!1:(this.superLayer=window.document.createElement("div"),this.superLayer.id="superlayer",this.subSuperLayer=window.document.createElement("div"),this.subSuperLayer.className="subSuperLayer",this.subSuperLayerFliper=document.createElement("div"),this.subSuperLayerFliper.className="subSuperLayerFliper",this.subSuperLayer.appendChild(this.subSuperLayerFliper),this.superLayer.appendChild(this.subSuperLayer),e.Param.viewTouchBlock.appendChild(this.superLayer),t=!0,!1)}}(),"7.3"===e.Main.startupManager.get("vendor.swiffy")?(d.addFixSwiffyAnims=function(){var e=document.querySelectorAll(".animation_for_swiffy");Array.prototype.forEach.call(e,function(e){var t=e.querySelector("canvas");e.style.backgroundImage="url("+t.toDataURL()+")",e.style.backgroundSize="contain",t.style.display="none"})},d.removeFixSwiffyAnims=function(){var e=document.querySelectorAll(".animation_for_swiffy");Array.prototype.forEach.call(e,function(e){var t=e.querySelector("canvas");e.style.backgroundImage="none",t.style.display="block"})}):(d.addFixSwiffyAnims=e.Utils.noop,d.removeFixSwiffyAnims=e.Utils.noop),d.superLayerElemList={video:function(t,a){t.currScale=a.currScale,t.videoHtmlElement||(t.videoHtmlElement=e.Utils.getVideoObject(t,!0)),t.videoHtmlElement.addEventListener("webkitbeginfullscreen",function(){document.hackFullscreenElement=this},!1),t.videoHtmlElement.addEventListener("webkitendfullscreen",function(){delete document.hackFullscreenElement},!1),"VIDEO"===t.videoHtmlElement.nodeName?t.videoHtmlElement.eventOverride=this.eventOverride.video:t.videoHtmlElement.children[0].eventOverride=this.eventOverride.video,this.subSuperLayer.appendChild(t.videoHtmlElement)},swiffy_file:function(){return"7.3"===e.Main.startupManager.get("vendor.swiffy")?function(t){e.Utils.GetSwiffyObject(t).then(function(t){if(null===document.getElementById(t.id)){t.swiffyWrapper.style.visibility="hidden";var a=function(){var t=this.firstChild;if(t){var n=this.querySelector("canvas"),i=t.offsetWidth/n.offsetWidth,r=t.offsetHeight/n.offsetHeight;t.style.overflow="visible",e.Utils.styleTransformOrigin(t,"0 0"),e.Utils.styleTransform(t,"scale("+i+", "+r+")"),this.style.visibility=""}else window.setTimeout(a,32)}.bind(t.swiffyWrapper);window.setTimeout(a,32),this.subSuperLayer.appendChild(t.swiffyWrapper)}}.bind(this))}:function(t){e.Utils.GetSwiffyObject(t).then(function(e){null===document.getElementById(e.id)&&this.subSuperLayer.appendChild(e.swiffyWrapper)}.bind(this))}}(),file:function(t,a){var n=document.createElement("iframe"),i=t.url;-1===i.indexOf("http")&&"/"===i[i.length-1]&&(i+="index.html"),i+=-1===i.indexOf("?")?"?":"&",i+="_zonesecure_sessionID="+e.Param.sessionId,n.src=i;var r=a.width/a.currScale*t.cumulIndex+t.x,o="-ms-transform: translate3d("+r+"px, "+t.y+"px, 0);";o+="-webkit-transform: translate3d("+r+"px, "+t.y+"px, 0);",o+="transform: translate3d("+r+"px, "+t.y+"px, 0);",o+="width: "+t.width+"px;",o+="height: "+t.height+"px;",o+=t.foreground===!0?"z-index: 20;":"z-index: -1;",n.style.cssText=o,this.subSuperLayer.appendChild(n)}},d.superLayerDrawer=function(){var e,t,a,n=0;return function(i,r){clearTimeout(n),n=setTimeout(function(){if(r.elemForSuperLayer)for(e=r.elemForSuperLayer.length;e--;)for(a=r.elemForSuperLayer[e].posElems,t=a.length;t--;)this.superLayerElemList[a[t].elemName]&&this.superLayerElemList[a[t].elemName].call(this,a[t],r.pos);this.subLayStatus.currentPage=i}.bind(this),1e3)}}(),d.subLayStatus={currentPage:null,contentHtml:null,isDoublePage:null,scale:1,width:0,height:0,x:0,y:0},d.superLayerManipulateur=function(){return function(t,a){if(t===e.Starter.getCurrentPage()){this.subLayStatus.width!=~~e.Starter._CONFIG.pagesOnInit.width+~~e.Starter._CONFIG.pagesOnInit.width*a.isDoublePage&&(this.subLayStatus.width=~~e.Starter._CONFIG.pagesOnInit.width+~~e.Starter._CONFIG.pagesOnInit.width*a.isDoublePage,this.subLayStatus.height=~~e.Starter._CONFIG.pagesOnInit.height,this.subSuperLayer.style.width=this.subLayStatus.width+"px",this.subSuperLayer.style.height=this.subLayStatus.height+"px");var n="translate3d("+a.pos.x+"px,"+a.pos.y+"px, 0) scale3d("+a.pos.currScale+", "+a.pos.currScale+", 1)";this.subSuperLayer&&(this.subSuperLayer.style.msTransform=n,this.subSuperLayer.style.webkitTransform=n,this.subSuperLayer.style.transform=n)}this.subLayStatus.isDoublePage=a.isDoublePage}}(),d.findLinkTypeClickedFromCurrentPage=function(t,a,n){var i=e.Main.canvasManager.getCurrentPageObjectContext(),r=0,o=!1;i&&i.useractList&&i.useractList.length>0&&(i.useractList=i.useractList.filter(function(e,t,a){for(var n=0,i=a.length;i>n;n++)if(a[n].linkXml.outerHTML===e.linkXml.outerHTML)return n===t}));for(var s in i.useractList)for(r=i.useractList[s].posElems.length;r--;)if(o=this.positionFinderAfterClick(i.pos,i.useractList[s].posElems[r],t,a)){if(!i.useractList[s].attr.getNamedItem("type"))continue;var l=i.useractList[s].linkXml.querySelectorAll("useract");if(l.length>1){var u={id:"userActPopup"},c=document.createElement("div"),d=l.length,h=document.createElement("div");h.classList.add("popup-title"),h.innerText=e.Utils.prodTools.getWordLangueByIndex("multilinks_title"),c.appendChild(h);for(var p=0;d>p;p++){var g=document.createElement("div");g.classList.add("webpub-link-popup__wrapper");var m=document.createElement("div");m.classList.add("webpub-link-popup__item"),m.innerText=l[p].textContent,m.innerText.trim()||(m.innerText=e.Main.xmlManager.get("locale","multilink_"+l[p].getAttribute("type")+"_label")),m.addEventListener(e.Param.eventClick,function(t,a,n,i,r,o){if("undefined"==typeof e.Param.overload.clickLink||e.Param.overload.clickLink(t,a,n[i].attributes,r)===!1){r.info=!0;var l=n[i].getAttribute("type"),c=n[i].getAttribute("param");"undefined"!=typeof this.actionUserActList[l]&&(e.Main.trackerManager.trackEvent({name:"link",variables:{1:l,2:c}}),this.actionUserActList[l]({attr:n[i].attributes,posElems:o.useractList[s].posElems,textContent:o.useractList[s].textContent})),e.Class.LightboxManagerNew.close(u.id)}}.bind(this,t,a,l,p,n,i)),g.appendChild(m),c.appendChild(g)}u.html=c,new e.Class.LightboxManagerNew(u),n.info=!0}else if("undefined"==typeof e.Param.overload.clickLink||e.Param.overload.clickLink(t,a,i.useractList[s].attr,n)===!1){"swiffyPlay"!==i.useractList[s].attr.getNamedItem("type").value&&0===i.useractList[s].linkXml.querySelectorAll("[foreground=false]").length&&(n.info=!0);var f=i.useractList[s].attr.getNamedItem("param"),v=i.useractList[s].attr.getNamedItem("type").value,b=f?f.value:"";"undefined"!=typeof this.actionUserActList[v]&&(e.Main.trackerManager.trackEvent({name:"link",variables:{1:v,2:b}}),this.actionUserActList[v](i.useractList[s]))}}return!1},d.actionUserActList={history:function(e){"back"===e.attr.getNamedItem("param").value?history.back():"fwd"===e.attr.getNamedItem("param").value&&history.forward()},close:function(t){e.Main.urlManager.get("backHome")?document.location=e.Starter.main.backHomeString:window.close()},prevPage:function(){NIApi.page.openPrevious()},nextPage:function(){NIApi.page.openNext()},firstPage:function(){NIApi.page.openFirst()},lastPage:function(){NIApi.page.openLast()},activate:function(t){"panel_pdf"===t.attr.getNamedItem("param").value?e.API.pdfDownload():"panel_search"===t.attr.getNamedItem("param").value&&e.API.searchOpen()},gotoPage:function(t){""!==t.attr.getNamedItem("param").value&&e.Main.controlManager.goToPage(~~t.attr.getNamedItem("param").value)},lightbox:function(t){var a={id:"link-"+t.attr.getNamedItem("id").value+"-"+t.attr.getNamedItem("type").value},n=t.attr.getNamedItem("param").value;n&&(-1===n.indexOf("http")&&"/"===n[n.length-1]&&(n+="index.html"),a.url=n),t.textContent&&(a.html=t.textContent),t.attr.getNamedItem("width")&&(a.width=t.attr.getNamedItem("width").value),t.attr.getNamedItem("height")&&(a.height=t.attr.getNamedItem("height").value),new e.Class.LightboxManagerNew(a)},popup:function(t){if(-1!==t.attr.getNamedItem("param").value.indexOf(".pdf"))this.url(t);else{var a=function(e){var t=e.toLowerCase().split(".");return t[t.length-1]},n=t.attr.getNamedItem("param").value;if(-1!==["jpeg","jpg","png","gif"].indexOf(a(n)))new e.Class.LightboxManagerNew({html:'<img src="'+n+'" />',theme:"theater",id:"link-"+t.attr.getNamedItem("id").value+"-"+t.attr.getNamedItem("type").value});else{var i={id:"link-"+t.attr.getNamedItem("id").value+"-"+t.attr.getNamedItem("type").value},r=t.attr.getNamedItem("param").value;r&&(-1===r.indexOf("http")&&"/"===r[r.length-1]&&(r+="index.html"),i.url=r),t.textContent&&(i.html=t.textContent),new e.Class.LightboxManagerNew(i)}}},url:function(t){var a=e.Utils.resolveVariable(t.attr.getNamedItem("param").value),n=btoa(a).replace(/=/g,"");window.open(a,n,"menubar=no, status=no, menubar=no")},videoPlay:function(e){},swiffyPlay:function(e){},drive:function(t){var a=t.attr.getNamedItem("param").value;0!==a.indexOf("#")&&(a="#"+a),window.open(e.Main.xmlManager.get("common-configuration","contents","gallery","path")+a)},window:function(t){var a={id:"link-"+t.attr.getNamedItem("id").value+"-"+t.attr.getNamedItem("type").value};t.attr.getNamedItem("param").value&&(a.url=t.attr.getNamedItem("param").value),t.textContent&&(a.html=t.textContent),new e.Class.LightboxManagerNew(a)},mailto:function(e){window.location.href="mailto:"+e.attr.getNamedItem("param").value}},d.positionFinderAfterClick=function(){var e=null,t=null,a=null,n=null,i=null,r=null;return function(o,s,l,u){if(e=o.currScale,t=s.cumulIndex*o.width+o.x+s.x*e,a=o.y+s.y*e,s.radius){if(r=s.radius*e,Math.sqrt(Math.pow(Math.abs(t+r-l),2)+Math.pow(Math.abs(a+r-u),2))<=r)return!0}else if(n=s.width*e,i=s.height*e,l>=t&&t+n>=l&&u>=a&&a+i>=u)return!0;return!1}}(),d.loadlinkForCurrentPage=function(t,a,n){var i=this;new e.Class.XmlLoader(i,"linksPerPage",null,{linksPerPage:e.Main.xmlManager.get("common-configuration","contents","links","path").replace("%num%",t+a)},function(n,r,o){if(n){o.getXml.linksPerPage=e.Utils.resolveVariable(o.getXml.linksPerPage);var s=e.Utils.stringtoXML(o.getXml.linksPerPage);e.Main.xmlInterface.setVariablesAndPrefixForTag(s),i.linkXmlToSvgByPage(s,t,a,n)}}.bind(this,n),null,null,!0)},d.onHDPageDraw=function(t,a,n){"undefined"==typeof n.linksStatus&&(n.linksStatus={}),"undefined"!=typeof n.linksStatus[a]?n.linksStatus[a].drawed&&(n.ctx.drawImage(n.linksStatus[a],~~(n.pos.x+n.pos.width*a),~~n.pos.y,~~n.pos.width,~~n.pos.height),this.callBackListManager(n,n.linkToDrawImageCallBack[a],0),this.drawedOnes||e.Starter.getCurrentPage()!==t||!(n.isDoublePage&&a>0)&&n.isDoublePage||(this.superLayerDrawer(t,e.Main.canvasManager.getCurrentPageObjectContext()),this.drawedOnes=!0)):(this.loadlinkForCurrentPage(t,a,n),n.drawn=n.drawn!==!0?!0:void 0)},d.linksBroadcast=function(e,t,a){var n=document.querySelectorAll("iframe");if(n=Array.prototype.filter.call(n,function(e){return null!=e.contentWindow}),"all"===e)for(var i=n.length;i--;)n[i].contentWindow.postMessage(t,"*");else if("others"===e)for(var i=n.length;i--;)n[i].contentWindow!==a&&n[i].contentWindow.postMessage(t,"*")},d.linkXmlToSvgByPage=function(t,a,n,i){var r=this,o=document.createElement("svg");o.setAttribute("xmlns","http://www.w3.org/2000/svg"),o.setAttribute("version","1.1"),o.setAttribute("viewBox","0 0 "+~~e.Starter._CONFIG.pagesOnInit.width+" "+~~e.Starter._CONFIG.pagesOnInit.height),o.setAttribute("height",~~e.Starter._CONFIG.pagesOnInit.height),o.setAttribute("width",~~e.Starter._CONFIG.pagesOnInit.width),this.setStyleForSvg(o),i.linkToDrawImageCallBack||(i.linkToDrawImageCallBack={}),i.linkToDrawImageCallBack[n]||(i.linkToDrawImageCallBack[n]=[]),this.xmlInterpretor(t.documentElement,i,n,o);for(var s=btoa(o.outerHTML);s.length%4!==0;)s+="=";var l="data:image/svg+xml;base64,"+s;if(i.linksStatus[n]=document.createElement("img"),i.linksStatus[n].isOnPrepar)return!1;if(i.linksStatus[n].isOnPrepar=!0,e.Param.userAgent.browser.name===e.Param.userAgent.BROWSER.IE){var u=~~(i.pos.x+i.pos.width*n),c=~~i.pos.y,d=~~i.pos.height,h=~~i.pos.width;if(i.linksStatus[n].style.backgroundImage="url("+l+")",i.linksStatus[n].style.backgroundSize="contain",i.linksStatus[n].style.height=d+"px",i.linksStatus[n].style.width=h+"px",i.linksStatus[n].drawed=!0,e.Param.userAgent.browser.name===e.Param.userAgent.BROWSER.IE){for(var p=this.subSuperLayer.querySelectorAll(".windows_hack_page_"+(a+n)),g=p.length;g--;)p[g].parentNode.removeChild(p[g]),p[g]=null;o.style.backgroundImage="url("+l+")",o.style.backgroundSize="contain",o.style.height="100%",o.style.width="100%",o.style.position="absolute",o.style.top=0,o.style.left=0,o.drawed=!0,o.className="windows_hack_page_"+(a+n),document.querySelector(".subSuperLayer").appendChild(o);for(var m=e.Main.linksManager.subSuperLayer.children,f=m.length;f--;)m[f]&&m[f].className&&(m[f].style.display=-1!==m[f].className.indexOf("windows_hack_page_"+e.Starter.getCurrentPage())?"":"none")}i.ctx.drawImage(i.linksStatus[n],u,c,h,d),r.callBackListManager(i,i.linkToDrawImageCallBack[n],0)}else i.linksStatus[n].onload=function(){this.drawed=!0,i.ctx.drawImage(i.linksStatus[n],~~(i.pos.x+i.pos.width*n),~~i.pos.y,~~i.pos.width,~~i.pos.height),r.callBackListManager(i,i.linkToDrawImageCallBack[n],0)},i.linksStatus[n].src=l;return!1},d.setStyleForSvg=function(r){var l=e.Utils.cubicBezier(0,.6,.4,1,parseFloat(webpublicationNamespace.Main.cssManager.getStyle("secondary","linkAlpha"))),c=e.Utils.hexToRgb(webpublicationNamespace.Main.cssManager.getStyle("secondary","linkColor"),l),d=e.Utils.hexToRgb(webpublicationNamespace.Main.cssManager.getStyle("secondary","linkBackgroundColor"),l),h=document.createElementNS(u,"defs"),p=document.createElementNS(u,"style");p.setAttribute("type","text/css"),p.textContent+="."+t+" { fill: "+d+"; stroke: "+c+"; stroke-width: 1; }",p.textContent+="."+s+" { fill: "+d+"; stroke: "+c+"; stroke-width: 1; }",p.textContent+="."+o+" { font-size: 1rem; font-family: 'Helvetica Neue'; text-anchor: middle; fill: rgba(255, 255, 255, 1); stroke: rgba(255, 255, 255, 1); stroke-width: 0; }",p.textContent+="."+a+" { fill:rgba(0,0,0,0.8); }",p.textContent+="."+n+" { fill:rgba(0,0,0,0); stroke-width:8; stroke:rgba(255,255,255,0.8); }",p.textContent+="."+i+" { fill:rgba(255,255,255,1); }",h.appendChild(p),r.appendChild(h)},d.xmlInterpretor=function(e,t,a,n,i,r){var o=null,s=0;if(e.hasChildNodes())for(o=e.childNodes,s=o.length;s--;)o[s].nodeType===window.document.ELEMENT_NODE&&this.svgFormEquivXmlLinksFormFunclist[o[s].nodeName]&&(o[s].linkXml=e,this.svgFormEquivXmlLinksFormFunclist[o[s].nodeName].call(this,o[s],t,a,n,i,r));return t},d.svgFormEquivXmlLinksFormFunclist={lk:function(e,t,a,n,i,r){if(e.hasChildNodes()){if(e.querySelector("useract")){var o=e.querySelector("useract").getAttribute("type");if(-1!==["zoomArea"].indexOf(o))return}var s=e.getAttribute("aim");if(null!==s&&-1===s.split(",").indexOf("html"))return;if(null===e.querySelector("useract")){var l=document.createElement("useract");l.setAttribute("type","fake"),l.setAttribute("event","fake"),l.setAttribute("param","fake"),l.setAttribute("id","fake"),e.appendChild(l)}"useract"!==e.childNodes[e.childNodes.length-1].tagName&&null!==e.querySelector("useract")&&e.appendChild(e.getElementsByTagName("useract")[0]),"undefined"==typeof t.elemForSuperLayer&&(t.elemForSuperLayer=[]),t.elemForSuperLayer.push({posElems:[]}),this.xmlInterpretor(e,t,a,n,i,r)}},content:function(e,t,a,n,i,r){e.hasChildNodes()&&this.xmlInterpretor(e,t,a,n,e,r)},useract:function(e,t,a,n,i,r){"undefined"==typeof t.useractList&&(t.useractList=[]),t.useractList.push({attr:e.attributes,textContent:e.textContent,posElems:[],linkXml:e.linkXml})},background:function(e,t,a,n,i,r){e.hasChildNodes()&&this.xmlInterpretor(e,t,a,n,i,function(){this.setAttribute("class",s)})},rect:function(e,a,n,i,r,o){var s=~~r.getAttribute("x"),c=~~r.getAttribute("y"),d=~~r.getAttribute("width"),h=~~r.getAttribute("height"),p=l,g=document.createElementNS(u,"rect");return g.setAttribute("rx",p),g.setAttribute("ry",p),g.setAttribute("width",d),g.setAttribute("height",h),g.setAttribute("transform","translate("+s+","+c+")"),g.setAttribute("class",t),o&&o.call(g),i.appendChild(g),a.useractList[a.useractList.length-1].posElems.push({elemName:e.nodeName,x:s,y:c,width:d,height:h,cumulIndex:n}),g},roundrect:function(e,a,n,i,r,o){var s=~~r.getAttribute("x"),l=~~r.getAttribute("y"),c=~~r.getAttribute("width"),d=~~r.getAttribute("height"),h=~~e.getAttribute("radius"),p=document.createElementNS(u,"rect");return p.setAttribute("rx",h),p.setAttribute("ry",h),p.setAttribute("width",c),p.setAttribute("height",d),p.setAttribute("transform","translate("+s+","+l+")"),p.setAttribute("class",t),o&&o.call(p),i.appendChild(p),a.useractList[a.useractList.length-1].posElems.push({elemName:e.nodeName,x:s,y:l,width:c,height:d,cumulIndex:n}),p},roundrectcomplex:function(e,a,n,i,r,o){var s=~~r.getAttribute("x"),l=~~r.getAttribute("y"),c=~~r.getAttribute("width"),d=~~r.getAttribute("height"),h=document.createElementNS(u,"path"),p=~~e.getAttribute("tl_radius"),g=~~e.getAttribute("tr_radius"),m=~~e.getAttribute("bl_radius"),f=~~e.getAttribute("br_radius"),v=this.roundrectcomplexHelper(s,l,c,d,p,g,m,f);return h.setAttribute("d",v),h.setAttribute("class",t),o&&o.call(h),i.appendChild(h),a.useractList[a.useractList.length-1].posElems.push({elemName:e.nodeName,x:s,y:l,width:c,height:d,cumulIndex:n}),h},circle:function(e,a,n,i,r,o){var s=~~r.getAttribute("x"),l=~~r.getAttribute("y"),c=document.createElementNS(u,"circle"),d=~~e.getAttribute("radius");return c.setAttribute("r",d),c.setAttribute("transform","translate("+(s+d)+","+(l+d)+")"),c.setAttribute("class",t),o&&o.call(c),i.appendChild(c),a.useractList[a.useractList.length-1].posElems.push({elemName:e.nodeName,x:s,y:l,radius:d,cumulIndex:n}),c},textGroup:function(e,t,a,n,i,o){o&&o.call(r)},file:function(e,t,a,n,i,r){var o=e.getAttribute("url");if(o.match(/\.swf/i))return!1;if(o.match(/\.json/i))return this.svgFormEquivXmlLinksFormFunclist.goSwiffy.apply(this,arguments),!1;var s=~~i.getAttribute("x"),l=~~i.getAttribute("y"),u=~~i.getAttribute("width"),c=~~i.getAttribute("height");if(o.match(/\.html/i)||"/"===o[o.length-1]){var d={elemName:e.nodeName,url:o,x:s,y:l,width:u,height:c,cumulIndex:a,foreground:"false"!==e.getAttribute("foreground")?!0:!1};t.elemForSuperLayer[t.elemForSuperLayer.length-1].posElems.push(d)}return t.linkToDrawImageCallBack[a].push({srcUrl:o,x:s,y:l,width:u,height:c,cumulIndex:a}),t.useractList&&t.useractList[t.useractList.length-1].posElems.push({elemName:e.nodeName,x:s,y:l,width:u,height:c,cumulIndex:a}),!1},goSwiffy:function(e,t,a,n,i,r){var o=~~i.getAttribute("x"),s=~~i.getAttribute("y"),l=~~i.getAttribute("width"),u=~~i.getAttribute("height"),c={elemName:"swiffy_"+e.nodeName,url:e.getAttribute("url"),x:o,y:s,width:l,height:u,cumulIndex:a,swiffyHtmlElement:null};if(t.useractList){var d=t.useractList.length-1;t.useractList[d].attr.getNamedItem("type").value="swiffyPlay",t.useractList[d].attr.getNamedItem("param").value="",t.useractList[d].posElems.push(c)}var h=t.elemForSuperLayer.length-1;t.elemForSuperLayer[h].posElems.push(c)},video:function(t,n,r,o,s,c){var d=~~s.getAttribute("x"),h=~~s.getAttribute("y"),p=~~s.getAttribute("width"),g=~~s.getAttribute("height"),m=l,f=document.createElementNS(u,"rect");f.setAttribute("rx",m),f.setAttribute("ry",m),f.setAttribute("width",p),f.setAttribute("height",g),f.setAttribute("transform","translate("+d+","+h+")"),f.setAttribute("class",a);var v=document.createElementNS(u,"path");v.setAttribute("d","M16,0C7.164,0,0,7.164,0,16s7.164,16,16,16s16-7.164,16-16S24.836,0,16,0z M10,24V8l16.008,8L10,24z"),v.setAttribute("transform","translate("+(d+p/2-32)+","+(h+g/2-32)+"),scale(2)"),v.setAttribute("class",i),c&&c.call(f),o.appendChild(f),o.appendChild(v);var b=e.Utils.uniqueId(),y={elemName:t.nodeName,url:t.getAttribute("url"),x:d,y:h,width:p,height:g,cumulIndex:r,videoId:b,videoHtmlElement:null};return n.elemForSuperLayer[n.elemForSuperLayer.length-1].posElems.push(y),n.useractList&&(n.useractList[n.useractList.length-1].attr.getNamedItem("type").value="videoPlay",n.useractList[n.useractList.length-1].attr.getNamedItem("param").value="",n.useractList[n.useractList.length-1].posElems.push(y)),f},symbol:function(e,t,a,n,i,o){o&&o.call(r)},text:function(e,t,a,n,i,r){var s=~~i.getAttribute("x"),l=~~i.getAttribute("y"),c=~~i.getAttribute("width"),d=~~i.getAttribute("height"),h=document.createElementNS(u,"text"),p=document.createTextNode(e.textContent);return h.setAttribute("x",c/2),h.setAttribute("y",d/2),h.setAttribute("width",0),h.setAttribute("height",0),h.appendChild(p),h.setAttribute("transform","translate("+s+","+l+")"),h.setAttribute("class",o),r&&r.call(h),n.appendChild(h),t.useractList[t.useractList.length-1].posElems.push({elemName:e.nodeName,x:s,y:l,width:c,height:d,cumulIndex:a}),h}},d.getPropsImage=function(e,t){var a=e.width/t.width,n=e.height/t.height,i={prop:null,interX:null,interY:null,interWidth:null,interHeight:null};return n>a?(i.interWidth=~~(a*t.width),i.interHeight=~~(a*t.height),i.prop=a):(i.interWidth=~~(n*t.width),i.interHeight=~~(n*t.height),i.prop=n),i.interX=0,i.interY=0,i},d.callBackListManager=function(e,t,a,n){var i=this;a||(a=0);var r;if("undefined"!=typeof t[a])if(t[a].imgData){r=t[a].imgData;var o=e.pos.x+(t[a].x+t[a].dataPos.interX)*e.pos.currScale+e.pos.width*t[a].cumulIndex,s=e.pos.y+(t[a].y+t[a].dataPos.interY)*e.pos.currScale,l=t[a].dataPos.interWidth*e.pos.currScale,u=t[a].dataPos.interHeight*e.pos.currScale;e.ctx.drawImage(r,o,s,l,u),i.callBackListManager.call(i,e,t,++a,n)}else{if(t[a].isOnPrepar)return i.callBackListManager.call(i,e,t,++a,n),!1;t[a].isOnPrepar=!0,r=new Image,r.onload=function(){t[a].dataPos=i.getPropsImage(t[a],this),t[a].imgData=this;var r=t[a].imgData,o=e.pos.x+(t[a].x+t[a].dataPos.interX)*e.pos.currScale+e.pos.width*t[a].cumulIndex,s=e.pos.y+(t[a].y+t[a].dataPos.interY)*e.pos.currScale,l=t[a].dataPos.interWidth*e.pos.currScale,u=t[a].dataPos.interHeight*e.pos.currScale;e.ctx.drawImage(r,o,s,l,u),i.callBackListManager.call(i,e,t,++a,n)},r.src=t[a].srcUrl}else n&&n.call(this)},d.roundrectcomplexHelper=function(e,t,a,n,i,r,o,s){var l="M"+(e+i)+" "+t+" L"+(e+a-r)+" "+t+" q "+r+" 0 "+r+" "+r+" L"+(e+a)+" "+(t+n-s)+" q 0 "+s+" -"+s+" "+s+" L"+(e+o)+" "+(t+n)+" q -"+o+" 0 -"+o+" -"+o+" L"+e+" "+(t+i)+" q 0 -"+i+" "+i+" -"+i+" Z";return l},c}(e)}(webpublicationNamespace),function(e){e.Class.LinksManagerNew=function(){function t(){e.Main.urlManager.contains("isApp")&&e.Param.userAgent.os.name===e.Param.userAgent.OS.IOS&&e.Utils.toast({text:e.Main.xmlManager.get("locale","loading"),duration:3e3})}function a(e){return"swiffy"===e.type}function n(e){return e!==!1}function r(e){return("undefined"==typeof e.useract||0===e.useract.length||e.useract[0].type in le)&&e.type in he?!0:!1}function o(e){return-1===K.indexOf(e.type)?!0:e.param?!0:!1}function s(e){for(var t=e.length;t--;)if("video"===e[t].type&&e[t].content[0].autoplay!==!1)return e[t].index;return!1}function l(t){var i=e.Main.pageManager.getLinks(t);if(i.length){var r=i.filter(a);return r.length?new Promise(function(a){if(R[t])a(!0);else{for(var i,o=[],s=r.length;s--;)i=r[s].content[0],i.id=r[s].index,o.push(e.Utils.GetSwiffyPromise(i));Promise.all(o).then(function(e){R[t]=e.filter(n),e=void 0,a(!0)})}}):!0}return!1}function u(t,a){for(var n=e.Main.pageManager.getLinks(t),i=a.index.toString(),r=n.length;r--;)if(n[r].index===i){d(n[r].useract);break}}function c(t,a){e.Main.trackerManager.trackEvent({name:"link",variables:{1:t.type,2:t.param}}),a&&e.Class.LightboxManagerNew.close(a),le.hasOwnProperty(t.type)&&le[t.type](t)}function d(t,a){if(t.length){if(a&&a.preventDefault(),t.length>1){var n={id:"userActPopup"},i=document.createElement("div"),r=document.createElement("div");r.classList.add("popup-title"),r.innerText=e.Utils.prodTools.getWordLangueByIndex("multilinks_title"),i.appendChild(r);for(var o=t.length;o--;){var s=document.createElement("div");s.classList.add("search-result");var l=document.createElement("div");l.classList.add("search-result-content"),l.innerText=t[o].textContent||t[o].textField?t[o].textContent||t[o].textField:e.Main.xmlManager.get("locale","multilink_"+t[o].type+"_label")+" "+e.Utils.resolveVariable(t[o].param),l.addEventListener(e.Param.eventClick,c.bind({},t[o],n.id)),s.appendChild(l),i.appendChild(s)}n.html=i,new e.Class.LightboxManagerNew(n)}else c(t[0],!1);return!0}return!1}function h(t,a,n,i){var o=e.Main.pageManager.getLinks(t).filter(r);if(o.length){for(var s=[],l=[],u=U.round(H.width*a/j),c=U.round(H.height*n/Y),d=ae.linkClickMargin,h=o.length;h--;)for(var p=o[h].content.length;p--;){var g=o[h].content[p];u>=g.x&&u<=g.x+g.width&&c>=g.y&&c<=g.y+g.height&&(s=s.concat(o[h].useract)),u>=g.x-d&&u<=g.x+g.width+d&&c>=g.y-d&&c<=g.y+g.height+d&&(l=l.concat(o[h].useract))}return 0===s.length&&(s=l),s}return[]}function p(e,t,a,n){return"VIDEO"===n.target.tagName.toUpperCase()?!0:h(e,t,a,n).length>0}function g(t,a,n,i){if("VIDEO"!==i.target.tagName.toUpperCase()){clearTimeout(e.Main.linksManagerNew._mouseIdleTimer),e.Main.tooltipManager.hide(i);var r=h(t,a,n,i);ae.linksBoxWithDom&&(r=r.filter(o)),d(r,i)}}function m(t){var a=e.Utils.resolveVariable(t.param);return-1===a.indexOf("http")&&"/"===a[a.length-1]&&(a+="index.html"),a}function f(t){var a=e.Utils.resolveVariable(t.param);return 0!==a.indexOf("#")&&(a="#"+a),e.Main.xmlManager.get("common-configuration","contents","gallery","path")+a}function v(t,a,n,r,o){if(n=n||q.getDeltaFrameForPage(a),o=o||document.getElementById("webpub-viewer__links-page-container-"+a))for(var s=0;s<t.content.length;s++)if("swiffy"===t.type){if(R[a]&&R[a].length)for(i=R[a].length;i--;){var l=R[a][i];l.classList.contains("webpub-viewer__link-"+t.index)&&o.appendChild(he.swiffy(l,!1))}}else{var u={};u.pageNumber=a,"video"===t.type&&(u.play=ae.autoPlayVideo===!0&&0===n&&t.index===r&&t.content[s].video.autoplay!==!1),"iframe"===t.type&&(u.visible=0===n),t.useract[0]&&("drive"===t.useract[0].type&&(u.url=f(t.useract[0])),
("url"===t.useract[0].type||"gallery"===t.useract[0].type)&&(u.url=m(t.useract[0])));var c="";if(t.useract.length>0&&(c=t.useract[0].textField,""===c&&(c=e.Main.xmlManager.get("locale","tooltip_"+t.useract[0].type),"gotoPage"===t.useract[0].type))){var d=parseInt(e.Utils.resolveVariable(t.useract[0].param),10)-e.Main.xmlManager.get("common-configuration","config","shift");c+=" "+d}var h=he[t.type](t.index,t.content[s],!!t.useract.length,u,c);h!==!1&&o.appendChild(h)}}function b(){this.classList.add("webpub-viewer__links-page-container-reveal--taped")}function y(){this.classList.remove("webpub-viewer__links-page-container-reveal--taped"),setTimeout(b.bind(this),16)}function w(t,a){var n=e.Main.pageManager.getLinks(t).filter(r);if(n&&n.length&&-1===$.indexOf(t)){var i=s(n),o=document.createDocumentFragment();$.push(t);for(var l=0;l<n.length;l++)ae.linksBoxWithDom===!1&&J.indexOf(n[l].type)>-1&&(n[l].type=n[l].type+"_domManager"),v(n[l],t,a,i,o);if(o.childNodes.length){var u=document.createElement("div");u.id="webpub-viewer__links-page-container-"+t,ae.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors.blink&&0===a?u.className="webpub-viewer__links-page-container-active":ae.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors["static"]?u.className="webpub-viewer__links-page-container-show":ae.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors.revealOnTap&&(u.className="webpub-viewer__links-page-container-reveal",u.addEventListener(e.Param.eventClick,y.bind(u))),u.appendChild(o),o=n=void 0,u.style.left=q.getFrameCoordX(a)+q.getPageCoordX(t)+"px",u.style.top=q.getFrameCoordY(a)+Z+"px",u.style.width=H.width+"px",u.style.height=H.height+"px",u.style.zIndex=t,e.Utils.styleTransformOrigin(u,"0 0"),e.Utils.styleTransform(u,"scale3d("+X+", "+W+", 1)"),z.appendChild(u),R[t]&&R[t].length&&(0===a||ae.autoPlayAnim)&&(x(t,!1),setTimeout(function(){x(t,!0)},100))}}}function C(e){for(var t=document.querySelectorAll("#webpub-viewer__links-page-container-"+e+" .animation_for_swiffy"),a=[],n=t.length;n--;)a.push(t[n].id);return t=null,a}function M(e,t){if($.indexOf(e)>-1){var a=document.getElementById("webpub-viewer__links-page-container-"+e);$.splice($.indexOf(e),1);for(var n=C(e),i=n.length;i--;)document.getElementById(n[i]).swiffyElement.swiffyObject.destroy();z.removeChild(a),ee.appendChild(a),a.innerHTML="",a=void 0,ee.innerHTML=""}t&&(R[e]=void 0,delete R[e])}function P(e,t){var a=document.querySelector("#webpub-viewer__links-page-container-"+e+" .webpub-viewer__link-"+t);a&&(a.classList.contains("animation_for_swiffy")&&document.getElementById(a.id).swiffyElement.swiffyObject.destroy(),a.parentNode.removeChild(a))}function x(e,t){var a,n=C(e);if(t)for(a=n.length;a--;)document.getElementById(n[a]).swiffyElement.swiffyObject.start();else{for(a=n.length;a--;){var i=document.getElementById(n[a]);i.swiffyElement.swiffyObject.destroy(),i.parentNode.removeChild(i),R[e]=void 0,delete R[e]}var r=document.getElementById("webpub-viewer__links-page-container-"+e),o=l(e);o.then&&o.then(function(){if(R[e]&&R[e].length)for(a=R[e].length;a--;){var t=R[e][a];r.appendChild(he.swiffy(t,0===q.getDeltaFrameForPage(e)||t.autoPlay||ae.autoPlayAnim))}})}}function S(t,a){var n=document.querySelectorAll("#webpub-viewer__links-page-container-"+t+" .webpub-viewer__link-video"),i=s(e.Main.pageManager.getLinks(t).filter(r)),o=n.length;if(a){if(ae.autoPlayVideo)for(;o--;)if(n[o].classList.contains("webpub-viewer__link-"+i)){n[o].play();break}}else for(;o--;)isNaN(n[o].duration)||(n[o].pause(),n[o].currentTime=0);n=void 0}function L(e,t){var a=document.querySelectorAll("#webpub-viewer__links-page-container-"+e+" .webpub-viewer__link-iframe"),n=a.length;if(t)for(;n--;)a[n].src=a[n].getAttribute("data-src");else for(;n--;)a[n].src="";a=void 0}function I(t){for(var a=document.querySelectorAll("#webpub-viewer__links-container > div"),n=a.length;n--;){var i=a[n],r=parseInt(i.id.substring(i.id.lastIndexOf("-")+1,i.id.length)),o=q.getFrameOfPage(r),s=o-t;U.abs(s)>ae.deltaFrameInDOM?M(r,!0):(0!==s&&(x(r,!1),S(r,!1),L(r,!1),ae.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors.blink?i.classList.remove("webpub-viewer__links-page-container-active"):ae.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors["static"]&&i.classList.remove("webpub-viewer__links-page-container-show")),i.style.left=q.getFrameCoordX(s)+q.getPageCoordX(r)+"px",i.style.top=q.getFrameCoordY(s)+Z+"px",0===s&&(x(r,!0),S(r,!0),L(r,!0),ae.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors.blink?(i.classList.remove("webpub-viewer__links-page-container-active"),i.classList.add("webpub-viewer__links-page-container-active")):ae.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors["static"]&&i.classList.add("webpub-viewer__links-page-container-show")))}}function T(e){j=e.width,Y=e.height,Q=e.left,Z=e.top,O()}function _(e,t,a){var n=z.querySelectorAll(".webpub-viewer__link-iframe");n=Array.prototype.filter.call(n,function(e){return null!==e.contentWindow&&void 0!==e.contentWindow});var i=0;if("all"===e)for(i=n.length;i--;)n[i].contentWindow.postMessage(t,"*");else if("others"===e)for(i=n.length;i--;)n[i].contentWindow!==a&&n[i].contentWindow.postMessage(t,"*")}function O(){if(H.width=e.Main.xmlManager.get("common-configuration","contents","links","width")||e.Main.xmlManager.get("common-configuration","contents","swf","width"),H.height=e.Main.xmlManager.get("common-configuration","contents","links","height")||e.Main.xmlManager.get("common-configuration","contents","swf","height"),j>0){X=j/H.width,W=Y/H.height;for(var t,a=z.childNodes,n=a.length;n--;){t=a[n];var i=t.id,r=parseInt(i.match(/[0-9]+$/)[0],10),o=q.getDeltaFrameForPage(r);Math.abs(o)>ae.deltaFrameInDOM&&(e.Utils.styleTransform(t,"scale3d("+X+", "+W+", 1)"),M(r,!0)),t.style.left=q.getFrameCoordX(o)+q.getPageCoordX(r)+"px",t.style.top=q.getFrameCoordY(o)+Z+"px",e.Utils.styleTransform(t,"scale3d("+X+", "+W+", 1)")}re()}}function k(){D=window.innerWidth,F=window.innerHeight}function E(){z=document.createElement("div"),z.id="webpub-viewer__links-container",ae.container.appendChild(z),ee.classList.add("display-none"),te.classList.add("display-none"),document.body.appendChild(te);var e="div.webpub-viewer__links-page-container-active > .webpub-viewer__link-box { ";e+="-webkit-animation-duration: "+ae.linkBlinkDuration/1e3+"s;",e+="animation-duration: "+ae.linkBlinkDuration/1e3+"s;",e+="}";var t=document.createElement("style");t.type="text/css",t.innerText=e,document.head.appendChild(t)}function N(e){var t;for(t in e)"undefined"!=typeof ae[t]&&(ae[t]=e[t])}function A(e){N(e||{}),E(),B=!0}var D=window.innerWidth,F=window.innerHeight,U=Math,G=document.head||document.getElementsByTagName("head")[0],q=e.Main.viewerManager,B=!1,V=!1,R={},z={},H={},X=0,W=0,j=0,Y=0,Z=0,Q=0,$=[],K=["url","drive","gallery"],J=["roundrectcomplex","roundrect","rect","circle"],ee=document.createElement("div"),te=document.createElement("iframe"),ae={pageOnFirstFrame:1,pagesInFrame:1,linksRetina:!1,deltaFrameInDOM:0,maxZoom:2.5,autoPlayAnim:!1,autoPlayVideo:!1,linkClickMargin:5,linksBoxWithDom:!0,container:e.Param.viewMain,linkBoxAspect:e.Class.LinksManagerNew.linksBehaviors.blink,linkBlinkDuration:1e3},ne=e.Utils.noop,ie=e.Utils.noop,re=e.Utils.noop,oe=e.Utils.noop,se=e.Utils.noop;"7.3"===e.Main.startupManager.get("vendor.swiffy")&&(oe=function(e){var t=e.querySelector("canvas");t&&(e.style.backgroundImage="url("+t.toDataURL()+")",e.style.backgroundSize="contain",t.classList.add("display-none"))},se=function(e){var t=e.querySelector("canvas");t&&(e.style.backgroundImage="none",t.classList.remove("display-none"))},ne=function(){if(!V){V=!0;for(var e=document.querySelectorAll(".animation_for_swiffy"),t=e.length;t--;)oe(e[t])}},ie=function(){if(V){V=!1;for(var e=document.querySelectorAll(".animation_for_swiffy"),t=e.length;t--;)se(e[t])}},re=function(){for(var e=document.querySelectorAll("#webpub-viewer__links-container > div"),t=e.length;t--;){var a=e[t],n=parseInt(a.id.substring(a.id.indexOf("_")+1,a.id.length));x(n,!1)}});var le={history:function(e){"back"===e.param?history.back():"fwd"===e.param&&history.forward()},close:function(){e.Main.urlManager.get("backHome")?document.location=e.Starter.main.backHomeString:window.close()},prevPage:NIApi.page.openPrevious,nextPage:NIApi.page.openNext,firstPage:NIApi.page.openFirst,lastPage:NIApi.page.openLast,activate:function(t){"panel_pdf"===t.param?e.API.pdfDownload():"panel_search"===t.param?e.API.searchOpen():"panel_share"===t.param&&e.Main.shareManager.open("home")},gotoPage:function(e){q.goToPage(e.param)},lightbox:function(e){this.popup(e)},popup:function(t){var a=e.Utils.resolveVariable(t.param);if(a){var n=function(e){var t=e.toLowerCase().split(".");return t[t.length-1]},i=function(e,t){var a=t[0].querySelector('[data-section="content"]'),n=t[0].querySelector("img.webpub-link-image, video.webpub-link-video");a.style.height=e.height,a.style.width=e.width;var i=window.getComputedStyle(a),r=window.getComputedStyle(n),o=parseInt(e.height,10)||n.naturalHeight||n.videoHeight,s=parseInt(e.width,10)||n.naturalWidth||n.videoWidth,l=parseInt(i.height,10)||parseInt(r.height,10),u=parseInt(i.width,10)||parseInt(r.width,10),c=s/o,d=u/l;d>c?a.style.width=l*s/o+"px":a.style.height=u*o/s+"px"},r={id:"link-"+t.id+"-"+t.type,height:t.height,width:t.width};if(t.theme&&(r.theme=t.theme),t.animation&&(r.animation=t.animation),-1!==["jpeg","jpg","png","gif"].indexOf(n(a))){r.theme=r.theme||"theater";{var o="modale"===r.theme?"":"100%";!!r.height||!!r.width}"modale"===r.theme?r.html="<img class='webpub-link-image' src='"+a+"'></div>":(r.html="<div class='webpub-link-image' style=\"background-image: url("+a,r.html+=')"></div>'),r.height=r.height||o,r.width=r.width||o,"modale"===r.theme&&(r.onload=function(t,a){var n=a[0].querySelector("img.webpub-link-image");n&&n.complete?i(t,a):n&&(n.addEventListener("load",i.bind({},t,a)),window.addEventListener(e.Param.eventResize,i.bind({},t,a)))}.bind({},r))}else-1!==["mp4","mpeg","mpg"].indexOf(n(a))?(r.html="<video class='webpub-link-video' src='"+a+"' controls autoplay />",r.theme=r.theme||"theater",r.height=r.height||"100%",r.width=r.width||"100%","modale"===r.theme&&(r.onload=function(t){i(t),window.addEventListener(e.Param.eventResize,i.bind({},t))})):(-1===a.indexOf("http")&&"/"===a[a.length-1]&&(a+="index.html"),r.url=a,r.header="false"===t.header?"none":"visible","modale"===r.theme&&(r.height=r.height||"100%",r.width=r.width||"100%"));new e.Class.LightboxManagerNew(r)}},url:function(e){t(),window.open(m(e),"_blank")},drive:function(e){window.open(f(e),"_blank")},gallery:function(e){window.open(m(e),"_blank")},window:function(t){var a=e.Utils.resolveVariable(t.param);-1===a.indexOf("http")&&"/"===a[a.length-1]&&(a+="index.html");var n={id:"link-"+t.id+"-"+t.type,height:t.height,width:t.width},i=function(e){var t=e.toLowerCase().split(".");return t[t.length-1]};-1!==["jpeg","jpg","png","gif"].indexOf(i(a))?(n.html="<div class='webpub-link-image' style=\"background-image: url("+a+')"></div>',n.theme=n.theme||"theater",n.height=n.height||"100%",n.width=n.width||"100%"):(n.header="false"===t.header?"none":"visible",n.url=a),t.theme&&(n.theme=t.theme),t.animation&&(n.animation=t.animation),new e.Class.LightboxManagerNew(n)},mailto:function(e){window.location.href="mailto:"+e.param},refreshLink:function(t){if(t.param){var a=q.getDeltaFrameForPage(t.param);if(t.linkIndex>=0){P(t.param,t.linkIndex);var n=e.Main.pageManager.getLinks(t.param).filter(r);if(n&&n.length)for(var i=s(n),o=n.length;o--;)n[o].index==t.linkIndex&&(v(n[o],t.param,a,i),"swiffy"!==n[o].type||0!==a&&!ae.autoPlayAnim||(x(t.param,!1),setTimeout(x.bind({},t.param,!0),100)))}else M(t.param,!1),U.abs(a)<=ae.deltaFrameInDOM&&w(t.param,a)}},addProduct:function(e){window.wishList.list.addProduct(e.param)}},ue=function(){var a,n,i,r,o;return function(s,l,u,c,d,h){return i=c?ae.maxZoom:1,r=u.width*i+"px",o=u.height*i+"px",l.classList.add("webpub-viewer__link"),l.style.height=o,l.style.width=r,l.style.position="absolute",u.file&&u.file.foreground===!1?(a=document.createElement("div"),n=document.createElement("div"),a.style.width=r,a.style.height=o,a.style.position="absolute",a.style.zIndex=1,l.style.left="0",l.style.top="0",l.style.zIndex=-10,n.style.width=r,n.style.height=o,n.style.top="0",n.style.left="0",n.style.position="absolute",n.style.zIndex=10,a.appendChild(n),a.appendChild(l)):(a=l,a.style.zIndex=10),a.style.top=u.y+"px",a.style.left=u.x+"px",a.classList.add("webpub-viewer__link-"+s),d&&(a.classList.add("webpub-viewer__link-clickable"),h.url&&(a.href=h.url,a.target="_blank",a.addEventListener(e.Param.eventClick,t))),c&&e.Utils.scaleDom3d(a,1/i,0,0),e.Main.urlManager.contains("isApp")&&e.Param.userAgent.os.name===e.Param.userAgent.OS.IOS&&a.addEventListener(e.Param.eventClick,function(){this.classList.add("webpub-viewer__link--focused"),setTimeout(function(){this.classList.remove("webpub-viewer__link--focused")}.bind(this),400)}),a}}(),ce=function(){var e=function(e){e.paused&&e.play()},t=function(e){e.paused||document.hackFullscreenElement||e.pause()};return function(a){a.target.paused?setTimeout(e.bind({},a.target),125):setTimeout(t.bind({},a.target),125)}}(),de=!1;de="safari"===e.Param.userAgent.browser.name||"ie"===e.Param.userAgent.browser.name&&e.Param.userAgent.browser.version<10?function(){var e,t=[],a=!1;return te.onload=function(){e=t.shift(),"undefined"!=typeof e?te.src=e:a=!1},function(e){a===!0?t.push(e):(a=!0,te.src=e)}}():function(e){var t=document.createElement("link");t.setAttribute("href",e),t.setAttribute("rel","prefetch prerender"),G.appendChild(t)};var he={swiffy:function(){return"7.3"===e.Main.startupManager.get("vendor.swiffy")?function(t,a){if(t!==!1){t.style.left=t.coords.x+"px",t.style.top=t.coords.y+"px",t.style.width=t.coords.w+"px",t.style.height=t.coords.h+"px",t.swiffyElement.swiffyWrapper.style.visibility="hidden";var n=function(){var t=this.firstChild;if(t){var a=this.querySelector("canvas"),i=t.offsetWidth/a.offsetWidth,r=t.offsetHeight/a.offsetHeight;t.style.overflow="visible",e.Utils.styleTransformOrigin(a,"0 0"),e.Utils.styleTransform(a,"scale3d("+i+", "+r+", 1)"),this.style.visibility=""}else window.setTimeout(n,32)}.bind(t.swiffyElement.swiffyWrapper);return window.setTimeout(n,32),a&&t.swiffyElement.swiffyObject.start(),t}}:function(e,t){return e!==!1?(e.style.left=e.coords.x+"px",e.style.top=e.coords.y+"px",e.style.width=e.coords.w+"px",e.style.height=e.coords.h+"px",t&&e.swiffyElement.swiffyObject.start(),e):void 0}}(),iframe:function(e,t,a,n){var i=document.createElement("iframe");return i.classList.add("webpub-viewer__link-iframe"),i.setAttribute("data-src",t.file.url),i.style.visibility="hidden",i.onload=function(){this.style.visibility="visible"},n.visible?i.src=t.file.url:de(t.file.url),ue(e,i,t,ae.linksRetina)},image:function(t,a,n,i,r){if(q.linkChargedInPage(i.pageNumber,t)===!1){var o=new Image;o.coord={x:a.x,y:a.y,width:a.width,height:a.height,container:H},o.idLink=t,o.onload=q.addImagesOnPage.bind({},i.pageNumber,[o]),o.src=e.Utils.resolveVariable(a.file.url)}return n?ae.linksBoxWithDom?he.rect(t,a,!1,i,r):he.rect_domManager(t+"-box",a,!1,i,r):!1},video:function(t,a,n,i,r){var o=document.createElement("video");r&&(o.setAttribute("data-tooltip",r),e.Main.tooltipManager.register(o)),o.classList.add("webpub-viewer__link-video");var s=/(?:\.([^.]+))?$/.exec(a.video.url)[1].toUpperCase(),l=document.createElement("source");return["MP4","OGG"].indexOf(s)>=0&&(l.type="video/"+s.toLowerCase(),l.src=e.Utils.resolveVariable(a.video.url)),o.appendChild(l),o.controls=!0,o.preload=!0,o.autoplay=i.play,o.loop=!1,e.Param.userAgent.os.name!==e.Param.userAgent.OS.ANDROID&&o.addEventListener(e.Param.eventStart,ce),e.Param.userAgent.os.name!==e.Param.userAgent.OS.SAFARI&&(o.addEventListener("webkitbeginfullscreen",function(){document.hackFullscreenElement=this},!1),o.addEventListener("webkitendfullscreen",function(){document.hackFullscreenElement=void 0,delete document.hackFullscreenElement},!1)),e.Utils.addVideoStats(o),ue(t,o,a,!1)},text:function(t,a,n,i,r){var o=document.createElement("a");r&&(o.setAttribute("data-tooltip",r),e.Main.tooltipManager.register(o)),o.className="webpub-viewer__link-text ",o.align="center",o.setAttribute("data-tooltip",r);var s=document.createElement("p");return s.innerHTML=a.textContent,s.style.fontSize="15px",o.appendChild(s),ue(t,o,a,!1,n,i)},rect:function(t,a,n,i,r){var o=document.createElement("a");return r&&(o.setAttribute("data-tooltip",r),e.Main.tooltipManager.register(o)),o.className="webpub-viewer__link-rect webpub-viewer__link-box",ue(t,o,a,ae.linksRetina,n,i)},rect_domManager:function(e,t,a,n){return q.linkChargedInPage(n.pageNumber,e)===!1&&q.addLinksBoxOnPage(n.pageNumber,[{type:"rect",id:e,x:t.x,y:t.y,w:t.width,h:t.height,container:H}]),!1},circle:function(t,a,n,i,r){var o=document.createElement("a");return r&&(o.setAttribute("data-tooltip",r),e.Main.tooltipManager.register(o)),o.className="webpub-viewer__link-circle webpub-viewer__link-box",ue(t,o,a,ae.linksRetina,n,i)},circle_domManager:function(e,t,a,n){return q.linkChargedInPage(n.pageNumber,e)===!1&&q.addLinksBoxOnPage(n.pageNumber,[{type:"circle",id:e,x:t.x,y:t.y,w:t.width,h:t.height,container:H}]),!1},roundrect:function(t,a,n,i,r){var o=document.createElement("a");return r&&(o.setAttribute("data-tooltip",r),e.Main.tooltipManager.register(o)),o.className="webpub-viewer__link-roundrect webpub-viewer__link-box",e.Utils.styleBorderRadius(o,a.roundrect.radius+"px"),ue(t,o,a,ae.linksRetina,n,i)},roundrect_domManager:function(e,t,a,n){return q.linkChargedInPage(n.pageNumber,e)===!1&&q.addLinksBoxOnPage(n.pageNumber,[{type:"roundrect",id:e,x:t.x,y:t.y,w:t.width,h:t.height,radius:t.roundrect.radius,container:H}]),!1},roundrectcomplex:function(t,a,n,i,r){var o=document.createElement("a");r&&(o.setAttribute("data-tooltip",r),e.Main.tooltipManager.register(o));var s=a.roundrectcomplex;return o.className="webpub-viewer__link-roundrectcomplex webpub-viewer__link-box",e.Utils.styleBorderRadius(o,s.tl_radius+"px "+s.tr_radius+"px "+s.br_radius+"px "+s.bl_radius+"px "),ue(t,o,a,ae.linksRetina,n,i)},roundrectcomplex_domManager:function(e,t,a,n){return q.linkChargedInPage(n.pageNumber,e)===!1&&q.addLinksBoxOnPage(n.pageNumber,[{type:"roundrectcomplex",id:e,x:t.x,y:t.y,w:t.width,h:t.height,tl_radius:t.roundrectcomplex.tl_radius,tr_radius:t.roundrectcomplex.tr_radius,br_radius:t.roundrectcomplex.br_radius,bl_radius:t.roundrectcomplex.bl_radius,container:H}]),!1},symbol:function(){return document.createElement("div")}};return{addLinksToPage:w,removeLinksFromPage:M,preloadAnimPromise:l,setPageSize:T,addFixSwiffyAnims:ne,removeFixSwiffyAnims:ie,adjustLinksCache:I,setConfig:N,linkClick:u,linksBroadcast:_,onLayerClick:g,findClickedUserActs:p,onResize:k,init:A}},e.Class.LinksManagerNew.linksBehaviors={blink:"blink","static":"static",none:"none",revealOnTap:"revealOnTap"}}(webpublicationNamespace),function(e){e.Param.eventResize="resizeCustom",e.Param.eventKeyboardDown="keydown";var t=function(){function t(){window.innerHeight>window.innerWidth?(e.Param.viewHtml.classList.remove("webpub-device__landscape"),e.Param.viewHtml.classList.add("webpub-device__portrait"),e.Param.isPortrait=!0):(e.Param.viewHtml.classList.remove("webpub-device__portrait"),e.Param.viewHtml.classList.add("webpub-device__landscape"),e.Param.isPortrait=!1)}function a(a){t(),e.Starter._CONFIG.setDocument(),e.Utils.callEvent(window,e.Param.eventResize)}return t(),function(t){var n=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.hackFullscreenElement;return n&&"video"===n.tagName.toLowerCase()?(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1):void(e.Param.newViewerVersion?a(t):(e.Main.linksManager&&e.Main.linksManager.updateLayer(),setTimeout(a.bind({},t),200)))}}();e.Param.userAgent.os.name===e.Param.userAgent.OS.WINDOWS&&e.Param.userAgent.device.type===e.Param.userAgent.FORMAT.PHONE?window.addEventListener("orientationchange",function(){setTimeout(t,48)}):window.addEventListener("resize",t),document.addEventListener(e.Param.eventClick,function(t){var a=e.Utils.getClosestByClass(t.target,"focusable");a!==!1&&(a.classList.add("focused"),window.setTimeout(function(){a.classList.remove("focused")},300))})}(webpublicationNamespace),function(w){!function(){document.documentElement.addEventListener("touchstart",function(e){e.touches.length>1&&e.preventDefault()},!1);var e=0;document.documentElement.addEventListener("touchend",function(t){var a=(new Date).getTime();300>=a-e&&t.preventDefault(),e=a},!1)}(),w.Class.Main=function(){var construct=function(){var e=w.Main.urlManager.get("gallery");if("undefined"!=typeof e){var t=w.Main.xmlManager.get("common-configuration","contents","gallery","path");location.href=t+"#"+e}this.backHomeString="api:backHome",w.Param.userAgent.os.name===w.Param.userAgent.OS.WINDOWS&&(this.backHomeString="api-backHome"),this.xmlLinksList={},this.currElemPos={},this.pagesListConstructor={},this.param=null,this.timeOfResize=500,this.timeOfResizeMobile=300,w.Main.eventEmul=new w.Class.EventEmul,w.Main.pagesLoader=new w.Class.PagesLoader,w.Main.pdfManager=new w.Class.PdfManager,w.Main.tooltipManager=new w.Class.TooltipManager,w.Main.pageManager=new w.Class.PageManager,w.Main.pageManager.init(),w.Main.paginationManager=new w.Class.PaginationManager,w.Main.paginationManager.init(w.Main.startupManager.get("ui.paging")),w.Param.newViewerVersion?(w.Main.pagesLoaderNew=new w.Class.PagesLoaderNew,w.Main.viewerManager="html"===w.Param.viewerMode&&"epub-HTML"===w.Param.viewerFormat?new w.Class.EpubManager(this,w.Param.viewMain):new w.Class.ViewerManager):w.Main.canvasManager=new w.Class.CanvasManager,w.Main.controlManager=new w.Class.ControlManager(this),w.Main.paginationManager.addPagination("lateral",w.Param.viewMain),w.Main.securityXml=new w.Class.SecurityXml,w.Main.summaryManager=new w.Class.SummaryManager,w.Main.shareMailManager=new w.Class.ShareMailManager,w.Main.shareManager=new w.Class.ShareManager,w.Main.shareManager.init(),1===w.Main.xmlManager.get("statistics","version")&&(w.Main.trackerManager=new w.Class.TrackStatManager),null!==w.Main.startupManager.get("ui.menu")&&(w.Main.menuService=new w.Class.MenuService,w.Main.menuManager=new w.Class.MenuManager),w.Utils.callEvent(window,"webpub-init"),w.Param.newThemeVersion||w.Main.paginationManager.addPagination("counter",w.Param.viewMain)},prot=construct.prototype;return prot.init=function(){var e=this;return w.Main.templateManager.loadAppend("publication/mobile/img/icons.svg",document.body),w.Main.xmlInterface=new w.Class.XmlInterface(this,function(){return w.Starter._CONFIG.autonomeAttitude?(e.initAutonomeAttitude(),!1):w.Starter._CONFIG.enableSecurityXml?(w.Main.securityXml.init(e.initSuite),!1):void e.initSuite()}),!1},prot.securityOk=function(){this.documentReadyCustomPreloader()},prot.initSuiteNext1=function(e){var t=w.Main.startupManager.get("startup.welcomepage.url"),a=w.Main.urlManager.get("initState"),n=w.Main.startupManager.get("startup.welcomepage.initial"),i=!1;i="welcomepage"===a||"nowelcomepage"===a?"welcomepage"===a:"hidden"!==n,t&&i&&(w.Main.trackerManager.trackPage({name:"welcomepage"}),new w.Class.LightboxManagerNew({animation:"none",header:"none",id:"startupPanel",url:w.Utils.resolveVariable(t)})),null!==w.Main.startupManager.get("ui.menu")&&w.Main.menuManager.init({topnav:w.Main.startupManager.has("ui.menu.mode","topnav"),topnavAlwaysVisible:"sticky"===w.Main.startupManager.get("ui.menu.topnav.display")}),this.securityOk(),w.Param.newViewerVersion||(w.Main.linksManager=new w.Class.LinksManager(this))},prot.initSuite=function(){w.Main.positionForSlider=new w.Class.PositionForSlider(this),w.Main.templateOldManager=new w.Class.TemplateOldManager(this,w.Starter._CONFIG.getTemplatesList(),function(){this.parent.initSuiteNext1()})},prot.initAutonomeAttitude=function(){this.xmlLinksList.getXml={},this.param=new w.Class.Param,w.Main.positionForSlider=new w.Class.PositionForSlider(this),this.documentReadyCustomPreloader()},prot.documentReadyCustomPreloader=function(){w.Main.pagesLoader.preloadPageFrom(null,null,!0),w.Main.javascriptInit.removePreloader(function(){this.documentReadyCustom()}.bind(this))},prot.loadJavascriptForHtmlSlider=function(callBack){if(w.Starter._CONFIG.loadJavascriptForHtmlSlider){var req=new XMLHttpRequest;req.open("GET",w.Starter._CONFIG.loadJavascriptForHtmlSlider,!0),req.onreadystatechange=function(aEvt){4==req.readyState&&(eval(req.responseText),callBack&&callBack())},req.send()}else callBack&&callBack()},prot.setCarrouselManager=function(){if(!w.Starter._CONFIG.setDisableCarrousel&&null!==w.Main.startupManager.get("ui.carousel")&&(w.Main.carrouselManager=new w.Class.CarrouselManager(w.Param.viewMain,{positionneurStyle:webpublicationNamespace.Main.cssManager.getStyle("primary","actionColor"),pageLength:w.Main.xmlManager.get("common-configuration","config","pageCount"),backgroundColorBoxShadow:function(){return[webpublicationNamespace.Main.cssManager.getStyle("primary","topnavColor"),""]},canvasWidth:function(){return w.Utils.getBestSreenSize()},thumbListHeight:100,imageBasePath:w.Starter._CONFIG.pages.Diapo,documentWidth:function(){return w.Starter._CONFIG.getDocument.width},getCurrentPage:w.Param.newViewerVersion?function(){return w.Main.pagesLoaderNew.getCurrentPage()}:function(){return w.Main.pagesLoader.pageCurrentOriginalIs},onThumbClick:w.Param.newViewerVersion?function(e){w.Main.controlManager.showTools(!1),w.Main.viewerManager.goToPage(e)}:function(e){w.Main.controlManager.showTools(!1),w.Main.controlManager.goToPage(e)}}),w.Utils.prodTools.onPageChange(function(e){return w.Main.controlManager?(w.Main.carrouselManager.pageChanged(e),!1):!1}),window.addEventListener(w.Param.eventResize+"2",function(){w.Main.carrouselManager.onResize()}),w.Main.controlManager)){var e=function(e){e&&w.Main.carrouselManager.pageChanged(w.Main.pagesLoader.pageCurrentOriginalIs,!0)},t=function(e){e&&w.Main.carrouselManager.pageChanged(w.Main.pagesLoaderNew.getCurrentPage(),!0)};w.Main.controlManager.onShowTools(w.Param.newViewerVersion?t:e)}},prot.documentReadyCustom=function(){var e=this;w.Param.newViewerVersion||(w.Main.eventManagerFlip=new w.Class.EventManagerFlip(w.Param.viewTouchBlock),w.Main.controlManager.flipDelay()),window.addEventListener(w.Param.eventResize,function(){w.Starter.idResize++,w.Main.positionForSlider.alignAll(),w.Utils.callEvent(window,w.Param.eventResize+"2")}),w.Param.viewHtml.classList.add(window.innerHeight>window.innerWidth?"webpub-device__portrait":"webpub-device__landscape"),"iOS"===w.Param.userAgent.os.name&&window.addEventListener("devicemotion",function(){var e,t,a,n;return function(i){e=i.accelerationIncludingGravity,t=Math.abs(e.x),a=Math.abs(e.y),n=Math.abs(e.z),(0===window.orientation||180===window.orientation)&&(t>7||(n>6&&8>a||8>n&&a>6)&&t>5)&&document.activeElement&&document.activeElement.blur&&document.activeElement.blur(),(90===window.orientation||-90===window.orientation)&&(a>7||(n>6&&8>t||8>n&&t>6)&&a>5)&&document.activeElement&&document.activeElement.blur&&document.activeElement.blur()}}(),!1),this.loadJavascriptForHtmlSlider(function(){var t=function(){e.setCarrouselManager(),e.xmlLinksList.getXml&&e.xmlLinksList.getXml.menuParam&&(w.Starter._CONFIG.menuCss.menuVisible||(e.menuParamManager=!1),e.menuParamManager)};w.Class.WishList(),w.Utils.callEvent(window,"webpub-ready"),t()}),w.Param.newViewerVersion||w.Main.positionForSlider.alignAll(),w.Param.sliderDirection="horizontal",("vertical"===w.Main.startupManager.get("core.viewerDirection")||"vertical"===w.Main.urlManager.get("direction"))&&(w.Param.sliderDirection="vertical",window.setTimeout(function(){var e=document.createElement("span");e.classList.add("svgicon-new-text"),e.innerHTML=w.Main.xmlManager.get("locale","vertical_slide_notice");var t=w.Utils.createSvgIcon("swipe-vertical-v4","svgicon-new svgicon-v4","#ffffff"),a=document.createElement("div");a.appendChild(e),a.appendChild(t),w.Utils.toast({html:a.innerHTML,duration:5e3,position:"bottom"})},1e3));var t=w.Main.xmlManager.get("common-ui","configs","viewer","rotateClue");if(null!==t){var a=function(e){"undefined"==typeof e&&(e="none"),new w.Class.LightboxManagerNew({header:"none",id:"rotate",theme:"theater",disableOverlay:!0,subtemplate:{url:w.Param.pathTemplate+"rotateClue.html"},priority:"high",animation:e,onload:function(e){e[0].classList.remove("webpub-lightbox--animation-none"),w.Class.LightboxManagerNew.get("rotate").params.animation="fade",e[0].classList.add("webpub-lightbox--animation-fade"),e[0].classList.add("webpub--active")}.bind(this)})};window.addEventListener(w.Param.eventResize,function(){w.Param.viewHtml.classList.contains("webpub-device__"+t)?w.Class.LightboxManagerNew.close("rotate"):a("fade")});var n=!w.Param.viewHtml.classList.contains("webpub-device__"+t);w.Param.isDesktop===!1&&n&&a()}if(w.Param.newViewerVersion){var i=w.Main.xmlManager.get("common-ui","configs","links","mode")||w.Class.LinksManagerNew.linksBehaviors.blink,r=w.Main.xmlManager.get("common-ui","configs","links","duration")||1e3,o={pageBgColor:w.Main.cssManager.getStyle("primary","backgroundColor"),zoomPinch:w.Main.startupManager.has("ui.zoom.mode","pinch"),zoomDoubleClick:w.Main.startupManager.has("ui.zoom.mode","doubleclick"),draggable:w.Main.startupManager.get("ui.viewer.draggable"),pagesRetina:!(w.Param.userAgent.isIE()===!0&&w.Param.userAgent.isPhone()),zoomRetina:w.Main.performanceManager.checkPerformanceLevel(6),domMode:w.Param.viewerMode,ePubConfig:null,highQualityKey:"svg"===w.Param.viewerFormat?"svg":"hdpi",linkBoxAspect:i,linkBlinkDuration:r,verticalSlider:"vertical"===w.Param.sliderDirection,pageQuantity:w.Main.pagesLoaderNew.getPageQuantity()};w.Main.viewerManager.epubMode&&(o.ePubConfig=w.Main.xmlManager.get("common-configuration","contents","epub-HTML")),w.Main.viewerManager.init(o)}w.Utils.callEvent(window,"webpub-load")},construct}()}(webpublicationNamespace),function(e){e.Class.MenuManager=function(){function t(){NIApi.register("menu.open",function(){return Promise.resolve(e.Main.menuManager.showMenu())}),NIApi.register("menu.close",function(){return Promise.resolve(e.Main.menuManager.hideMenu())}),NIApi.register("menu.toggle",function(){return Promise.resolve(e.API.menuToggle())}),NIApi.register("menu.activate",function(t){return Promise.resolve(e.Main.menuManager.callButtonClick(t))}),NIApi.register("menu.deactivate",function(e){return console.log("TODO : in developpement"),Promise.resolve()})}function a(t){if("undefined"==typeof t)return[];for(var a,n,i=[],r=0,o=t.length;o>r;r++){var s="string"==typeof t[r]?t[r]:t[r].name;if(n=e.Main.menuService.get(s)){a={};for(var l in n)a[l]=n[l];a.data=t[r],"logo"===a.data&&(a.data={file:e.Main.xmlManager.get("ui","logo")}),i.push(a)}}return i}function n(){var t=function(e){return"menu"!==e.name&&"logo"!==e.name},a=function(e){return"documentback"!==e.name},n=function(e){return function(t){return e.indexOf(t.priority)>-1}},i=function(e){return e.name},r=e.Main.xmlManager.get("ui","menu"),o=r.left.concat(r.center,r.right).filter(t),s={};if(S=[{name:"logo"}].concat(r.left,r.center,r.right).map(function(e){return e.name}),o.length>0&&o.unshift({name:"documentback",prority:"normal"}),b===!1&&"legacy"===e.Main.startupManager.get("ui.theme.v3.mode"))s={left:[],center:[],right:[]},o.length>0&&s.left.push({name:"menu",priority:"highest"}),e.Main.xmlManager.get("common-ui","logo")&&s.center.push({name:"logo",priority:"highest"});else{var l=["highest","high"];e.Param.isPhone?l=["highest"]:e.Param.isTablet&&(l=["highest","high"]);for(var u in r)for(var c=0;c<r[u].length;c++)"logo"===r[u][c].name&&"medium"===r[u][c].priority&&(r[u][c].priority="highest");var d=n(l);s={left:r.left.filter(a).filter(d),center:r.center.filter(a).filter(d),right:r.right.filter(a).filter(d)};var h=o.filter(function(e){return!(s.left.indexOf(e)>-1||s.center.indexOf(e)>-1||s.right.indexOf(e)>-1)}).length>0;

b&&s.left.length+s.center.length+s.right.length===0?L.topnav=!1:0===s.left.filter(function(e){return"menu"===e.name}).length&&h&&s.left.unshift({name:"menu"}),e.Main.urlManager.get("backHome")&&s.right.push({name:"home"})}return{left:s.left.map(i),center:s.center.map(i),right:s.right.map(i),burger:o.map(i)}}function i(){M&&M.parentNode.removeChild(M),P&&P.parentNode.removeChild(P);var t=e.Main.xmlManager.get("common-ui","menu")||n();if(L.topnav&&(e.Main.templateManager.loadPrepend(e.Param.pathTemplate+"menuTopnav.html",e.Param.viewMain,{theme:b?"v4":"v3",visible:L.topnavAlwaysVisible,itemsLeft:a(t.left),itemsCenter:a(t.center),itemsRight:a(t.right)}).then(function(e){M=document.querySelector(b?".webpub-topnav-v4":".webpub-topnav")}),e.Param.newViewerVersion&&L.topnavAlwaysVisible)){var i={paddingTop:b?45:60,paddingBottom:0};e.Main.viewerService.set(i)}var r={theme:b?"v4":"v3",items:a(t.burger),title:document.getElementsByTagName("title")[0].innerText},o=e.Main.xmlManager.get("common-ui","logo");o&&(r.logoSrc=e.Utils.resolveVariable(o.image)),e.Main.templateManager.loadAppend(e.Param.pathTemplate+"menuAside.html",document.body,r).then(function(t){if(b){P=document.querySelector(".webpub-aside-menu-v4");var a=document.querySelector(".webpub-aside-menu-v4__header-close"),n=P.querySelector(".webpub-aside-menu-v4__paging-wrapper");a.addEventListener(e.Param.eventStart,d,!1),e.Main.paginationManager.addPagination("counter",n)}else P=document.querySelector(".webpub-aside-menu");e.Utils.preventOverScroll(document.querySelector(".webpub-aside-menu, .webpub-aside-menu-v4"))}),e.Main.eventEmul.listenEvent("showMenu",e.API.menuToggle)}function r(e,t){}function o(){L.topnav?L.topnavAlwaysVisible||u():h()}function s(){return M?(y||(M.classList.add(x),y=!0),!0):!1}function l(){return M?(y&&!L.topnavAlwaysVisible&&(M.classList.remove(x),y=!1),!0):!1}function u(){y?l():s()}function c(){return w===!1?(I(),w=!0,!0):!1}function d(){return w?(_hideMenu(),w=!1,!0):!1}function h(){w?d():c()}function p(t){if("string"==typeof t){var a=e.Main.menuService.get(t);if(a===!1&&(t+="_btn",a=e.Main.menuService.get(t)),a&&"function"==typeof a.onclick)return-1===S.indexOf(t)&&a.onload(),a.onclick(),!0}return!1}function g(){var t=e.Main.xmlManager.get("common-ui","menu");for(var a in t)if(-1!==t[a].indexOf("menu"))return!0;return!1}function m(e){for(var t in e)"undefined"!=typeof L[t]&&(L[t]=e[t])}function f(e){m(e),i(),t(),C=!0}function v(e){for(var t=document.querySelectorAll(".webpub-aside-menu-v4__type-"+e+", .webpub-topnav-v4__type-"+e+", .webpub-aside-menu__type-"+e+", .webpub-topnav__type-"+e),a=0;a<t.length;a++)t[a].classList.add("webpub--active")}var b=e.Param.newThemeVersion,y=!1,w=!1,C=!1,M=!1,P=!1,x=b?"webpub-topnav-v4--visible":"webpub-topnav--visible",S=[],L={topnav:!0,topnavAlwaysVisible:!0},I=function(){function t(){e.Main.trackerManager.trackEvent({name:"menuOpen"})}return b?function(){P.classList.add("webpub-aside-menu-v4--open"),e.Utils.fadeIn(P),t()}:function(){e.Param.viewMain.classList.add("menu-open"),t()}}();return _hideMenu=function(){function t(){e.Main.trackerManager.trackEvent({name:"menuClose"})}return b?function(){P.classList.remove("webpub-aside-menu-v4--open"),e.Utils.fadeOut(P),t()}:function(){e.Param.viewMain.classList.remove("menu-open"),t()}}(),{init:f,addItem:r,buildMenu:i,showTopnav:s,hideTopnav:l,toggleTopnav:u,showMenu:c,hideMenu:d,toggleMenu:h,onDocumentClick:o,callButtonClick:p,setActive:v,hasMenuBurger:g}}}(webpublicationNamespace),function(e){NIApi.register("menu.setBadge",function(e,t){for(var a=document.querySelectorAll('[data-menu="'+e+'"] [data-section="badge"]'),n=0;n<a.length;n++)a[n].innerHTML=t}),NIApi.register("menu.setTitle",function(e,t){for(var a=document.querySelectorAll('[data-menu="'+e+'"]'),n=0;n<a.length;n++){a[n].hasAttribute("data-tooltip")&&a[n].setAttribute("data-tooltip",t);var i=a[n].querySelector('[data-section="title"]');i&&(i.innerHTML=t)}}),NIApi.register("menu.setIcon",function(t,a,n){n=n||document;for(var i=n.querySelectorAll('[data-menu="'+t+'"] [data-section="icon"]'),r=0;r<i.length;r++)if("object"==typeof a)a.url?i[r].src=e.Utils.resolveVariable(a.url):a.text;else{var o=i[r].querySelector("svg");e.Utils.svgIcon(o,{icon:a})}}),e.Class.MenuService=function(){function t(e){var t=o[e];if(t){for(var a=r.length;a--;)t[r[a].key]||(t[r[a].key]=r[a]["default"]);return t.name=e,t}return!1}function a(e,t){var a=Object.keys(t);if("undefined"!=typeof o[e]&&a.length>0){for(var n=a.length;n--;)for(var i=0;i<r.length;i++)r[i].key===a[n]&&(o[e][a[n]]=t[a[n]]);return!0}return!1}function n(e,t){return"undefined"==typeof o[e]&&(t.label||t.template)?(o[e]={},a(e,t)):!1}var i="v4"===e.Main.urlManager.get("viewer")||"v4"===e.Main.startupManager.get("core.viewer"),r=[{key:"label","default":""},{key:"icon","default":!1},{key:"onclick","default":e.Utils.noop},{key:"onload","default":e.Utils.noop},{key:"badge","default":""},{key:"template","default":!1}],o={menu:{icon:"menu",onclick:function(){e.Class.LightboxManagerNew.closeAll(),e.API.menuToggle()}},documentback:{label:e.Main.xmlManager.get("locale","menu_documentback"),icon:"thin_left",onclick:function(){e.Class.LightboxManagerNew.closeAll(),e.API.menuClose()}},page_control:{template:"menuItem-page_control"},logo:{label:"LOGO",template:"menuItem-logo",onclick:function(){return e.Starter._CONFIG.logo.exists===!0&&(e.Starter._CONFIG.logo.mediaLink&&e.Starter._CONFIG.logo.mediaLink.length?(e.Main.trackerManager.trackEvent({name:"externalLink",variables:{1:e.Starter._CONFIG.logo.mediaLink}}),window.open(e.Starter._CONFIG.logo.mediaLink,"myiframes")):i?e.Main.viewerManager.goToPage(1):1!==e.Main.pagesLoader.pageCurrentOriginalIs&&e.Main.controlManager.goToPage(1)),!1}},share_btn:{label:e.Main.xmlManager.get("locale","menu_sharethis"),icon:"share",onclick:function(){e.API.menuClose(),e.Utils.prodTools.showTools(!1),e.Main.shareManager.toggle("home")}},thumbnails_btn:{label:e.Main.xmlManager.get("locale","menu_thumbnail"),icon:"pages",onclick:function(){e.Main.thumbnailListManager.show("none")},onload:function(t){e.Main.thumbnailListManager=new e.Class.ThumbnailListManager,(e.Main.urlManager.contains("bookmarks")||e.Main.urlManager.contains("bookmark"))&&e.Main.thumbnailListManager.show("sharedBy")}},favorite_btn:{label:e.Main.xmlManager.get("locale","menu_favorite"),icon:"favorite",onclick:function(){e.Class.LightboxManagerNew.closeAll(),e.API.menuClose(),e.Main.thumbnailListManager.getToastData().then(function(t){e.Utils.toast({html:t,duration:3e3,position:"top-right",className:"webpub-toast-favorite"})})},onload:function(){e.Main.thumbnailListManager=new e.Class.ThumbnailListManager}},search_btn:{label:e.Main.xmlManager.get("locale","menu_search"),icon:"search",onclick:function(){e.Main.searchManager.show()},onload:function(t){"undefined"==typeof e.Main.searchManager&&(e.Main.searchManager=new e.Class.SearchManager),e.Main.searchManager.init()}},email_btn:{label:e.Main.xmlManager.get("locale","menu_mail"),icon:"mail",onclick:function(){"mailto"===e.Param.mailType?e.Main.shareMailManager.doMailTo():e.Main.shareMailManager.load(),e.Main.trackerManager.trackPage({name:"share-email"})}},summary_btn:{label:e.Main.xmlManager.get("locale","menu_summary"),icon:"list",onclick:function(){e.Main.summaryManager.show()},onload:function(t){e.Main.xmlManager.parse("summary",e.Main.xmlManager.get("common-configuration","contents","summary","path"))}},drive_btn:{label:e.Main.xmlManager.get("locale","menu_gallery"),icon:"image",onclick:function(){e.API.menuClose();var t=e.Main.xmlManager.get("common-configuration","contents","gallery","path");e.Main.trackerManager.trackEvent({name:"externalLink",variables:{1:t}}),window.open(t)},onload:function(t){return null===e.Main.xmlManager.get("common-configuration","contents","gallery","path")&&t.parentNode.removeChild(t),!1}},fullscreen_btn:{label:e.Main.xmlManager.get("locale","menu_fullscreen"),icon:"fullscreen",onclick:function(){return navigator.userAgent.toLowerCase().indexOf("samsung")>-1?function(){return!1}:document.documentElement.requestFullscreen&&document.cancelFullScreen?function(e){document.fullScreen===!0?document.cancelFullScreen():document.documentElement.requestFullscreen()}:document.documentElement.webkitRequestFullscreen&&document.webkitCancelFullScreen?function(e){document.webkitIsFullScreen===!0?document.webkitCancelFullScreen():document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}:document.documentElement.mozRequestFullScreen&&document.mozCancelFullScreen?function(e){document.mozFullScreen===!0?document.mozCancelFullScreen():document.documentElement.mozRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:document.documentElement.msRequestFullscreen&&document.msExitFullscreen?function(e){null!==document.msFullscreenElement?document.msExitFullscreen():document.documentElement.msRequestFullscreen()}:function(){return!1}}(),onload:function(){return function(t){function a(){e.Main.linksManager.updateLayer()}return!document.documentElement.requestFullscreen&&!document.documentElement.webkitRequestFullscreen&&!document.documentElement.mozRequestFullScreen&&!document.documentElement.msRequestFullscreen||navigator.userAgent.toLowerCase().indexOf("samsung")>-1?(t.style.display="none",!1):void(e.Param.newViewerVersion===!1&&(window.addEventListener("resize",a),e.Utils.addVendorEventListener("fullscreenchange",a)))}}()},home:{label:"Home",icon:"close",onclick:function(){return e.API.menuClose(),e.Main.urlManager.get("backHome")&&(document.location=e.Starter.main.backHomeString),!1}},welcomepage_btn:{label:e.Utils.prodTools.getWordLangueByIndex("menu_welcomepage_btn"),icon:"home",onclick:function(){e.API.menuClose(),e.API.welcomepageOpen()},onload:function(t){var a=e.Main.startupManager.get("startup.welcomepage.url");return a?void 0:(t.style.display="none",!1)}},pinterest_btn:{label:e.Main.xmlManager.get("locale","menu_pinterest_share"),icon:"pinterest",onclick:function(){e.API.menuClose(),e.Main.shareManager.shareSocial("pinterest")}},twitter_btn:{label:e.Main.xmlManager.get("locale","menu_twitter_share"),icon:"twitter",onclick:function(){e.API.menuClose(),e.Main.shareManager.shareSocial("twitter")}},tumblr_btn:{label:e.Main.xmlManager.get("locale","menu_tumblr_share"),icon:"tumblr",onclick:function(){e.API.menuClose(),e.Main.shareManager.shareSocial("tumblr")}},linkedin_btn:{label:e.Main.xmlManager.get("locale","menu_linkedin_share"),icon:"linkedin",onclick:function(){e.API.menuClose(),e.Main.shareManager.shareSocial("linkedin")}},googleplus_btn:{label:e.Main.xmlManager.get("locale","menu_googleplus_share"),icon:"googleplus",onclick:function(){e.API.menuClose(),e.Main.shareManager.shareSocial("googleplus")}},facebook_btn:{label:e.Main.xmlManager.get("locale","menu_facebook_share"),icon:"facebook",onclick:function(){e.API.menuClose(),e.Main.shareManager.shareSocial("facebook")}},cart_btn:{label:e.Main.xmlManager.get("locale","tooltip_panel_cart"),icon:"cart",onclick:function(){"undefined"!=typeof wishList&&(e.API.menuClose(),wishList.listPanel.open())}},print_btn:{label:e.Main.xmlManager.get("locale","menu_print"),icon:"print",onclick:function(){e.API.menuClose(),e.Main.shareManager.open("home","print")}},pdf_btn:{label:e.Main.xmlManager.get("locale","menu_download"),icon:"download",onclick:function(){e.API.menuClose(),e.Main.shareManager.open("home","download")}},zoom_btn:{label:e.Main.xmlManager.get("locale","menu_zoomup_btn"),alternativeLabel:e.Main.xmlManager.get("locale","menu_zoomdown_btn"),icon:"zoom-up",alternativeIcon:"zoom-down",onload:function(t){window.addEventListener("webpub-zoom",function(t){var a=e.Param.newThemeVersion?"-v4":"",n=this.label,i=this.icon.url?this.icon:this.icon+a;e.Param.zoom&&(t.getAttribute("data-alternativeIcon")&&(i=this.alternativeIcon.url?this.alternativeIcon:this.alternativeIcon+a),t.getAttribute("data-alternativeLabel")&&(n=this.alternativeLabel)),NIApi.menu.setTitle("zoom_btn",n),NIApi.menu.setIcon("zoom_btn",i,t)}.bind(this,t))},onclick:function(){e.Main.viewerManager.isZoomed()?e.Main.viewerManager.zoomOut():e.Main.viewerManager.zoomIn()}},zoomup_btn:{label:e.Main.xmlManager.get("locale","menu_zoomup_btn"),icon:"zoom-up",onclick:function(){e.Main.viewerManager.zoomIn()}},zoomdown_btn:{label:e.Main.xmlManager.get("locale","menu_zoomdown_btn"),icon:"zoom-down",onclick:function(){e.Main.viewerManager.zoomOut()}}};return o.pagemark_btn=o.favorite_btn,{get:t,set:a,add:n}}}(webpublicationNamespace),function(e){e.Class.PagesLoader=function(){var t=1,a={},n=[],i=[],r=null,o=null,s=null,l=null,u=null,c=null,d=null,h=function(){var t=this;t.lastPage=e.Starter._CONFIG.pages.beginPage,t.pageCurrentOriginalIs=e.Starter._CONFIG.pages.beginPage,t.pageCreated={},l=function(){var n=0;return function(i,r){if(n=0,r&&(n="active"),t.pageCreated[e.Starter._CONFIG.pages.defaultName+""+i])return e.Main.positionForSlider.positionIt(t.pageCreated[e.Starter._CONFIG.pages.defaultName+""+i],i,t.pageCurrentOriginalIs,n,!1),!1;if(!e.Param.newViewerVersion){var o=$(e.Main.canvasManager.texture(i));t.pageCreated[e.Starter._CONFIG.pages.defaultName+""+i]=o,a[i]=t.pageCreated[e.Starter._CONFIG.pages.defaultName+""+i],e.Main.positionForSlider.positionIt(t.pageCreated[e.Starter._CONFIG.pages.defaultName+""+i],i,t.pageCurrentOriginalIs,0,!0)}return!1}}(),u=function(t,a){return e.Starter._CONFIG.pages.doublePage&&1===t?(l(t,a),t):e.Starter._CONFIG.pages.doublePage&&t===e.Main.xmlManager.get("common-configuration","config","pageCount")&&e.Utils.impair(e.Starter._CONFIG.pages.length)?(l(t,a),t):(e.Starter._CONFIG.pages.doublePage&&e.Utils.impair(t)&&t++,l(t,a),t)},r=function(){var a=null;return function(){if(t.pageCurrentOriginalIs===t.lastPage)return!1;for(e.Main.trackerManager.trackPage({name:"page",variables:{1:t.pageCurrentOriginalIs}}),a=n.length;a--;)n[a](t.pageCurrentOriginalIs);return e.Main.pageManager.set(t.pageCurrentOriginalIs),!1}}(),o=function(a){return a||(a=t.pageCurrentOriginalIs),e.Starter._CONFIG.pages.doublePage&&1!=a&&a<e.Main.xmlManager.get("common-configuration","config","pageCount")&&!e.Utils.impair(a)?2:1},s=function(){return e.Starter._CONFIG.pages.doublePage&&2!=t.pageCurrentOriginalIs&&t.pageCurrentOriginalIs<=e.Starter._CONFIG.pages.length&&!e.Utils.impair(t.pageCurrentOriginalIs)?2:1},c=function(e){i.push(e)},d=function(n){return c(e.Main.canvasManager.textureContextList[e.Main.canvasManager.canvasKey+n]),t.pageCreated[e.Starter._CONFIG.pages.defaultName+""+n]&&delete t.pageCreated[e.Starter._CONFIG.pages.defaultName+""+n],e.Starter.main.currElemPos[n]&&delete e.Starter.main.currElemPos[n],e.Main.canvasManager.textureContextList&&e.Main.canvasManager.textureContextList[e.Main.canvasManager.canvasKey+n]&&delete e.Main.canvasManager.textureContextList[e.Main.canvasManager.canvasKey+n],a&&a[n]&&delete a[n],!1}};return h.prototype.preloadPageFrom=function(){var t=null,n=null,i=null,r=null,o=null,s=null,l=null,c=null,h=null,p=null,g=0;return function(m,f,v){o=e.Starter._CONFIG.pages.preloadBy,s=e.Main.xmlManager.get("common-configuration","config","pageCount"),o>s?o=e.Starter._CONFIG.pages.preloadBy=s:1>o&&(o=e.Starter._CONFIG.pages.preloadBy=1),l=this.pageCurrentOriginalIs,c=~~(o/2),h=Math.floor(o/2)+o%2,g?1===g&&(l=e.Starter._CONFIG.pages.beginPage,g++):g++,1>l?(l=1,e.Main.eventEmul.callEvent("onPageUnChangeable",0)):l>s&&(l=s,e.Main.eventEmul.callEvent("onPageUnChangeable",1)),e.Starter._CONFIG.pages.doublePage&&1!==l&&e.Utils.impair(l)&&l--,l+h>s&&(h=s-l),c>=l&&(c=l),n=o-(h+c),h>c?h+=n:c+=n,t=l+h,i=e.Utils.byPageIfDouble(t),i.isDouble&&e.Utils.impair(t)&&(t-=1,o&&(o-=1)),r=l-c,this.pageCurrentOriginalIs=l;for(var b in this.pageCreated)b=~~b.substr(e.Starter._CONFIG.pages.defaultName.length),b>=r&&t>=b||(r>b?a[b]&&d(b):b>t&&a[b]&&d(b));if(!v)for(p=r;t>=p;p++)1>p||p>s||(p=u(p,f));return m&&m(),!1}}(),h.prototype.getElementCvsDispo=function(){var e=null;return function(){return i[0]?(e=i[0],i.shift(),e):!1}}(),h.prototype.goDoublePage=function(){var t=null,a=!1;return function(n,r,o){for(e.Starter._CONFIG.setDocument(),o&&(n=null,r=null),"boolean"==typeof n?(e.Starter._CONFIG.pages.doublePage=e.Starter._CONFIG.pages.forcedPageFormat=n,e.Starter._CONFIG.pages.noChangeOnResize=r,e.Utils.callEvent(window,e.Param.eventResize)):r?(e.Starter._CONFIG.pages.noChangeOnResize=r,e.Utils.callEvent(window,e.Param.eventResize)):e.Starter._CONFIG.pages.noChangeOnResize||(e.Starter._CONFIG.pages.doublePage=e.Starter._CONFIG.getDocument.height>e.Starter._CONFIG.getDocument.width?!1:!0),t=e.Main.xmlManager.get("common-configuration","config","pageCount");t--;)this.pageCreated[e.Starter._CONFIG.pages.defaultName+""+(t+1)]&&d(t+1);for(t=i.length;t--;)e.Main.canvasManager.clearCvs(i[t],0,0,e.Utils.getBestSreenSize(),e.Utils.getBestSreenSize());return e.Main.positionForSlider.getInfoPosition(),this.preloadPageFrom(null,0),a!=e.Starter._CONFIG.pages.doublePage&&e.Main.eventEmul.callEvent("onPageFormatChanged",a),a=e.Starter._CONFIG.pages.doublePage,e.Starter._CONFIG.pages.doublePage}}(),h.prototype.prevPage=function(){var a=null;return function(n){return 1!==e.Main.pagesLoader.pageCurrentOriginalIs&&e.Main.linksManager&&e.Main.linksManager.hideLayerLinks(),t=s(),n?(a=n,e.Main.trackerManager.trackPage({name:"page",variables:{1:a}})):(a=this.pageCurrentOriginalIs-t,e.Main.trackerManager.trackEvent({name:"pagePrev",variables:{1:a}})),this.lastPage=this.pageCurrentOriginalIs,e.Starter._CONFIG.pages.pageCurrentIs=a,this.pageCurrentOriginalIs=a,this.preloadPageFrom(null,!0),r(),!1}}(),h.prototype.nextPage=function(){var a=null;return function(n){return e.Main.pagesLoader.pageCurrentOriginalIs!==e.Main.xmlManager.get("common-configuration","config","pageCount")&&e.Main.linksManager&&e.Main.linksManager.hideLayerLinks(),t=o(),n?(a=n,e.Main.trackerManager.trackPage({name:"page",variables:{1:a}})):(a=this.pageCurrentOriginalIs+t,e.Main.trackerManager.trackEvent({name:"pageNext",variables:{1:a}})),this.lastPage=this.pageCurrentOriginalIs,e.Starter._CONFIG.pages.pageCurrentIs=a,this.pageCurrentOriginalIs=a,this.preloadPageFrom(null,!0),r(),!1}}(),h.prototype.onPageChange=function(e){n.push(e)},h.prototype.goToPage=function(e){e=parseInt(e),e>this.pageCurrentOriginalIs?this.nextPage(e):e<this.pageCurrentOriginalIs&&this.prevPage(e)},h.prototype.getPagesOfFrame=function(t){var a=[],n=0,i=e.Main.pageManager.pagesOnFirstScreen(),r=e.Main.pageManager.pagePerScreen(),o=e.Main.xmlManager.get("common-configuration","config","pageCount"),s=Math.ceil((o+r-i)/r)-1;if(s>=t&&t>=0)for(var l=1;r>=l;l++)n=t*r+l-(r-i),o>=n&&n>0&&a.push(n);return a},h.prototype.getFrameOfPage=function(t){var a=e.Main.pageManager.pagesOnFirstScreen(),n=e.Main.pageManager.pagePerScreen();return Math.floor((t+n-a-1)/n)},h}()}(webpublicationNamespace),function(e){e.Class.PagesLoaderNew=function(){function t(e){r=e;for(var t=o.length;t--;)o[t](r)}function a(){return r}function n(){return e.Main.xmlManager.get("common-configuration","config","pageCount")}function i(e){"function"==typeof e&&o.push(e)}var r=1,o=[];return{setCurrentPage:t,getCurrentPage:a,getPageQuantity:n,addPageChangeCallback:i}}}(webpublicationNamespace),function(e){e.Class.PaginationManager=function(){function t(t){NIApi.page["open"+e.Utils.capitalize(t)]()}function a(e){isNaN(e)||NIApi.page.open(e)}function n(e){return g>=e?h.parseIntToRoman(e):e-g}function i(t,a){if(-1!==Object.keys(m).indexOf(t)&&"undefined"!=typeof a&&m[t].active===!0){m[t].added=!0,m[t].type=t;var n=e.Main.templateManager.loadAppend(e.Param.pathTemplate+"pagination.html",a,m[t]);b[m[t].type]&&n.then(b[m[t].type])}}function r(e){for(var t=Object.keys(m),a=t.length;a--;)m[t[a]].active===!0&&m[t[a]].added===!0&&m[t[a]].alwaysVisible===!1&&y[t[a]]&&y[t[a]](e)}function o(){c=window.innerWidth,d=window.innerHeight}function s(t){t.mode&&(t.mode.indexOf("bottom")>=0&&(t.mode[t.mode.indexOf("bottom")]="counter"),t.bottom&&(t.counter=t.bottom),t.mode.indexOf("lateral")>=0&&(m.lateral.active=!0,t.lateral&&(m.lateral.alwaysVisible=t.lateral.display?"sticky"===t.lateral.display:m.lateral.alwaysVisible,m.lateral.prevNext=t.lateral.hasOwnProperty("hasPrevNext")?t.lateral.hasPrevNext:m.lateral.prevNext,m.lateral.firstLast=t.lateral.hasOwnProperty("hasFirstLast")?t.lateral.hasFirstLast:m.lateral.firstLast),e.Param.isDesktop===!1&&m.lateral.alwaysVisible===!1&&(m.lateral.active=!1)),t.mode.indexOf("counter")>=0&&(m.counter.active=!0,(t.counter&&"sticky"===t.counter.display||e.Param.newThemeVersion)&&(m.counter.alwaysVisible=!0),m.counter.popup=e.Param.newThemeVersion===!1))}function l(){window.addEventListener(e.Param.eventResize,o)}function u(e){s(e),l(),o(),p=!0}var c=0,d=0,h=Math,p=!1,g=e.Main.xmlManager.get("common-configuration","config","shift"),m={lateral:{alwaysVisible:!1,firstLast:!0,prevNext:!0,active:!1},counter:{alwaysVisible:!1,active:!1}},f=e.Param.newViewerVersion?function(t){return e.Main.viewerManager.getPagesOfFrame(e.Main.viewerManager.getFrameOfPage(t)).map(n).join(" - ")}:function(t){return e.Main.pagesLoader.getPagesOfFrame(e.Main.pagesLoader.getFrameOfPage(t)).map(n).join(" - ")},v={lateral:function(t){var a=e.Utils.prodTools.getPageLength(),n=document.querySelector(".webpub-pagination__lateral-left"),i=document.querySelector(".webpub-pagination__lateral-right"),r=n.querySelectorAll("svg"),o=i.querySelectorAll("svg");n.style.display=1===t?"none":"",i.style.display=t===a?"none":"",NIApi.page.getVisiblePages().then(function(t){var a="pages."+t[0]+".paginationBackground",s="pages."+t[0]+".paginationColor";n.style.backgroundColor=e.Main.commonLayout.get(a)||"",Array.prototype.map.call(r,function(t){t.style.fill=e.Main.commonLayout.get(s)||""}),a="pages."+t[t.length-1]+".paginationBackground",s="pages."+t[t.length-1]+".paginationColor",i.style.backgroundColor=e.Main.commonLayout.get(a)||"",Array.prototype.map.call(o,function(t){t.style.fill=e.Main.commonLayout.get(s)||""})})},counter:function(e){m.counter.current.innerHTML=f(e)}},b={lateral:function(a){for(var n=a.length;n--;)a[n].classList.contains("webpub-pagination__lateral-left")?m.lateral.left=a[n]:a[n].classList.contains("webpub-pagination__lateral-right")&&(m.lateral.right=a[n]);if(m.lateral.prevNext&&(m.lateral.left.querySelector(".webpub-pagination__lateral-arrow-prev").addEventListener(e.Param.eventStart,t.bind({},"previous")),m.lateral.right.querySelector(".webpub-pagination__lateral-arrow-next").addEventListener(e.Param.eventStart,t.bind({},"next"))),m.lateral.firstLast&&(m.lateral.left.querySelector(".webpub-pagination__lateral-arrow-first").addEventListener(e.Param.eventStart,t.bind({},"first")),m.lateral.right.querySelector(".webpub-pagination__lateral-arrow-last").addEventListener(e.Param.eventStart,t.bind({},"last"))),m.lateral.alwaysVisible){var i={paddingLeft:52,paddingRight:52};e.Main.viewerService.set(i)}else document.addEventListener("mousemove",function(e){var t=e.clientX;120>t||.2*c>t?(m.lateral.left.classList.remove("opacity-zero"),m.lateral.left.classList.add("webpub-pagination__lateral-near")):(m.lateral.showed||m.lateral.left.classList.add("opacity-zero"),m.lateral.left.classList.remove("webpub-pagination__lateral-near")),t>c-120||t>.8*c?(m.lateral.right.classList.remove("opacity-zero"),m.lateral.right.classList.add("webpub-pagination__lateral-near")):(m.lateral.showed||m.lateral.right.classList.add("opacity-zero"),m.lateral.right.classList.remove("webpub-pagination__lateral-near"))},!0);e.Param.newViewerVersion?e.Main.pagesLoaderNew.addPageChangeCallback(v.lateral):e.Main.pagesLoader.onPageChange(v.lateral)},counter:function(t){var n,i,r,o;e.Param.newViewerVersion?(n=e.Main.pagesLoaderNew.getPageQuantity()-g,i=e.Main.pagesLoaderNew.getCurrentPage(),r=f(i),o=e.Main.pagesLoaderNew.addPageChangeCallback):(n=e.Utils.prodTools.getPageLength()-g,i=e.Starter.getCurrentPage(),r=f(i),o=e.Main.pagesLoader.onPageChange);for(var s=function(){m.counter.popup.dom.classList.add("display-none"),m.counter.popup.current.blur()},l=function(){a(parseInt(m.counter.popup.current.value)+g)},u=t.length;u--;)t[u].classList.contains("webpub-pagination__counter-container")?(m.counter.dom=t[u],m.counter.current=t[u].querySelector(".webpub-pagination__counter-current"),m.counter.current.innerHTML=r,t[u].querySelector(".webpub-pagination__counter-total").innerHTML=n):t[u].classList.contains("webpub-pagination__popup-container")&&(m.counter.popup={},m.counter.popup.close=s,m.counter.popup.goToPage=l,m.counter.popup.dom=t[u],m.counter.popup.current=t[u].querySelector(".webpub-pagination__popup-current"),t[u].querySelector(".webpub-pagination__popup-total").innerHTML=n);e.Param.newThemeVersion===!1&&(m.counter.dom.addEventListener(e.Param.eventStart,function(t){("mousedown"!==t.type&&"click"!==t.type||0===t.button)&&(m.counter.popup.dom.classList.remove("display-none"),m.counter.popup.current.value=e.Param.newViewerVersion?Math.max(e.Main.pagesLoaderNew.getCurrentPage()-g,0):Math.max(e.Starter.getCurrentPage()-g,0),m.counter.popup.current.focus())}),m.counter.popup.dom.querySelector(".webpub-pagination__popup-close").addEventListener(e.Param.eventClick,m.counter.popup.close),m.counter.popup.dom.querySelector("form").addEventListener("submit",function(e){return m.counter.popup.goToPage(),m.counter.popup.close(),e.preventDefault(),!1}),m.counter.popup.current.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),m.counter.popup.close())}),m.counter.popup.current.addEventListener("keyup",function(e){13===e.keyCode?m.counter.popup.close():m.counter.popup.goToPage()})),o(v.counter)}},y={lateral:function(e){e?(m.lateral.showed=!0,m.lateral.left.classList.remove("opacity-zero"),m.lateral.right.classList.remove("opacity-zero")):(m.lateral.showed=!1,m.lateral.left.classList.contains("webpub-pagination__lateral-near")||m.lateral.left.classList.add("opacity-zero"),m.lateral.right.classList.contains("webpub-pagination__lateral-near")||m.lateral.right.classList.add("opacity-zero"))},counter:function(t){t?e.Utils.fadeIn(m.counter.dom):e.Utils.fadeOut(m.counter.dom)}};return{init:u,addPagination:i,showPaginations:r}}}(webpublicationNamespace),function(e){var t=null,a=function(){t=this,this.parameters=null,this.getParameterOneSaved={}},n=a.prototype;n.defaults={language:"en"},n.autorizedParamByUrl=["applicationUrl","menu_drop_shadow","menu_alpha","menu_reflect_alpha","slideType","backHome","qualityGalleryHD","visioType","autonome","nbPages","disableZoom","sBackgroundColor","sColor","menuVisible","flipDelay","pagePath","page_width","page_height","aspUrlRootIndex","doublePage"],n.defaultParam={pathPagePdf:null,pathTextureLow:null,pathTextureHigh:null,swf:null,swf_width:null,swf_height:null,pathDiapo:null,menu_reflect_alpha:"50",menu_alpha:"0",menu_drop_shadow:!1,menu_bg_color:null,menu_teinte:null,flipDelay:"0",ombre_page_alpha:"0.4",pdf:"PDF NAME",idTrack:null,labelTrack:"",disableZoom:!1,mailPath:null,sBackgroundColor:"ffffff",sColor:"000000",menuVisible:"true",coulLien:"004e98",coulFond:"f4f5f5",highlightLink:null,decalagePage:"0",nbPages:"36",page_width:"1234",page_height:"436",qualityGalleryHD:"CoverFlow",slideType:"X",doublePage:"auto",loadJavascriptForHtmlSlider:null,backHome:null,pathFondRelatif:null,pathLinks:null,pathXmlSecurity:null},n.autonomeAttitude={menu_reflect_alpha:"50",widthW:"800",largeurZoom:"1024",pdf:"Mini slider",disableZoom:"true",sBackgroundColor:"transparent",sColor:"0x000000",menuVisible:"false",nbPages:"5",page_width:"1234",page_height:"817",flipDelay:2,flipDelayCustomized:!0,pagePath:"integration/DiapoMini/"},n.init=function(){t.setVisioType(),t.htmlMenuParam(),t.decalagePage(),t.setDefaultLanguage(),t.setTitle(),t.setNbPages(),t.setPages_W_H(),t.menu_alpha(),t.getMenu(),t.getLien(),t.setIconePath(),t.setIfDisableZoom(),t.setFlipDelay(),t.setSlideType(),t.setDoublePage(),t.setQualityGalleryHD(),t.setPathFondRelatif(),t.getIdTrack(),t.getLabelTrack(),t.getPiwikTrack(),t.setAspUrlRootIndex(),t.setPagePath(),t.setPathPagePdf(),t.setPathTextureLow(),t.setPathTextureHigh(),t.setPathDiapo(),t.setPathLinks(),t.setPathGallery(),t.setPathXmlSecurity(),t.getLoadJavascriptForHtmlSlider()},n.addDynamiqueParametersToArray=function(){e.Main.urlManager.forEach(function(e,t){this.getParameterOneSaved[t]=e},t)},n.getParameterOneAndClearIt=function(e){return"undefined"!=typeof t.getParameterOneSaved[e]?t.getParameterOneSaved[e]:!1},n.setSlideType=function(){var a=t.getParameterOneAndClearIt("slideType");"Y"==a&&(e.Starter._CONFIG.pagesOnInit.slideType=a,e.Starter._CONFIG.pages.slideType=a,e.Starter._CONFIG.pagesOnInit.width_or_height="height",e.Starter._CONFIG.pages.x_or_y="y",e.Starter._CONFIG.pagesOnInit.width_or_height="height",e.Starter._CONFIG.pages.x_or_y="y")},n.setVisioType=function(){t.getParameterOneSaved=e.Starter._CONFIG.autonomeAttitude?t.autonomeAttitude:t.defaultParam,t.addDynamiqueParametersToArray();t.getParameterOneAndClearIt("visioType")},n.setQualityGalleryHD=function(){var a=t.getParameterOneAndClearIt("qualityGalleryHD");a&&(e.Starter._CONFIG.pagesOnInit.qualityGalleryHD=a,e.Starter._CONFIG.pages.qualityGalleryHD=a)},n.setAspUrlRootIndex=function(){var a=t.getParameterOneAndClearIt("aspUrlRootIndex");a&&(e.Starter._CONFIG.aspUrlRootIndex=a)},n.setDoublePage=function(){var t=this.getParameterOneAndClearIt("doublePage"),a=e.Main.xmlManager.get("common-ui","configs","pageLayout");"true"===t?a="double":"false"===t&&(a="single"),e.Starter._CONFIG.pages.width>e.Starter._CONFIG.pages.height&&"double"!==a&&(a="single"),"double"===a?(e.Starter._CONFIG.pages.doublePage=!0,e.Starter._CONFIG.pagesOnInit.doublePage=!0,e.Starter._CONFIG.pagesOnInit.noChangeOnResize=!0,e.Starter._CONFIG.pages.noChangeOnResize=!0,e.Starter._CONFIG.pagesOnInit.forcedPageFormat=!0,e.Starter._CONFIG.pages.forcedPageFormat=!0):"single"===a?(e.Starter._CONFIG.pages.doublePage=!1,e.Starter._CONFIG.pagesOnInit.doublePage=!1,e.Starter._CONFIG.pagesOnInit.noChangeOnResize=!0,e.Starter._CONFIG.pages.noChangeOnResize=!0,e.Starter._CONFIG.pagesOnInit.forcedPageFormat=!1,e.Starter._CONFIG.pages.forcedPageFormat=!1):(e.Starter._CONFIG.pages.doublePage=!0,e.Starter._CONFIG.pagesOnInit.doublePage=!0,e.Starter._CONFIG.pagesOnInit.noChangeOnResize=!1,e.Starter._CONFIG.pages.noChangeOnResize=!1,e.Starter._CONFIG.pagesOnInit.forcedPageFormat=!1,e.Starter._CONFIG.pages.forcedPageFormat=!1)},n.setNbPages=function(){var a=t.getParameterOneAndClearIt("nbPages");return a?(e.Starter._CONFIG.pagesOnInit.length=~~a,e.Starter._CONFIG.pages.length=~~a,!1):!1},n.setPagePath=function(){var a=t.getParameterOneAndClearIt("pagePath");return"undefined"!=typeof PAGEPATH_FROM_INDEX&&(a||(a=PAGEPATH_FROM_INDEX)),a?(e.Starter._CONFIG.pagesOnInit.pathTextureHigh=e.Param.pathRoot+a+"/",e.Starter._CONFIG.pages.pathTextureHigh=e.Param.pathRoot+a+"/",e.Starter._CONFIG.pagesOnInit.pathTextureLow=e.Param.pathRoot+a+"/",e.Starter._CONFIG.pages.pathTextureLow=e.Param.pathRoot+a+"/",!1):!1},n.setPages_W_H=function(){var a=t.getParameterOneAndClearIt("page_width"),n=t.getParameterOneAndClearIt("page_height");return a&&n?(e.Starter._CONFIG.pagesOnInit.width=~~a,e.Starter._CONFIG.pagesOnInit.height=~~n,e.Starter._CONFIG.pages.width=~~a,e.Starter._CONFIG.pages.height=~~n,!1):!1},a.prototype.setDefaultLanguage=function(){var t=e.Main.urlManager.get("lng"),a=e.Main.xmlManager.getVariable("locale"),n=this.defaults.language;if(t)n=t;else if(a)return void(e.Param.language=-1===a.indexOf(".")?a:a.split(".")[0]);e.Param.language={au:"en_AU",da:"da_DK",de:"de_DE",en:"en_UK",es:"es_ES",fr:"fr_FR",it:"it_IT",ja:"ja_JP",ko:"ko_KR",nl:"nl_NL",no:"nn_NO",pl:"pl_PL",pt:"pt_PT",ro:"ro_RO",ru:"ru_RU",se:"sv_SE",sk:"sk_SK",us:"en_US"}[n]},a.prototype.setMailService=function(){e.Param.mailType="webservice",(e.Starter.isMaster===!0||"mailto"===e.Main.urlManager.get("mailPath")||"undefined"!=typeof e.Starter._CONFIG.appInfo.os)&&(e.Param.mailType="mailto")},a.prototype.setTitle=function(){var t=e.Main.urlManager.get("pdf");t&&(document.title=t)},n.menu_alpha=function(){var a=t.getParameterOneAndClearIt("menu_alpha");

return a?(e.Starter._CONFIG.menu_alpha=~~a,!1):!1},n.getMenu=function(){return t.menu={},t.menu.menu_alpha=t.getParameterOneAndClearIt("menu_alpha"),t.menu.menu_drop_shadow=t.getParameterOneAndClearIt("menu_drop_shadow"),t.menu.menuVisible=t.getParameterOneAndClearIt("menuVisible"),t.menu.menu_reflect_alpha=t.getParameterOneAndClearIt("menu_reflect_alpha"),t.menu.menu_bg_color=t.getParameterOneAndClearIt("menu_bg_color"),t.menu.menu_teinte=t.getParameterOneAndClearIt("menu_teinte"),"false"!=t.menu.menuVisible?(t.menu.menuVisible=!0,t.menu.menu_alpha=t.menu.menu_alpha?~~t.menu.menu_alpha/100:1,t.menu.menu_drop_shadow="false"==t.menu.menu_drop_shadow?!1:!0,t.menu.menu_reflect_alpha||(t.menu.menu_drop_shadow="50")):(t.menu.menuVisible=!1,t.menu.menu_alpha=0,t.menu.menu_drop_shadow=0,t.menu.menu_reflect_alpha=0,t.menu.menu_bg_color=null,t.menu.menu_teinte=null),e.Starter._CONFIG.menuCss=t.menu,!1},n.decalagePage=function(){var a=t.getParameterOneAndClearIt("decalagePage");return e.Starter._CONFIG.decalagePage=~~a,!1},n.getLien=function(){var a=t.getParameterOneAndClearIt("coulLien"),n={};if(a&&a.length){var i=e.Utils.hex16(a),r=new e.Utils.hexToRgb(i,.2);n.coulLien=r[0]+","+r[1]+","+r[2]}var o=t.getParameterOneAndClearIt("highlightLink");return o&&o.length&&(n.opacityLien="never"==o?0:.05),e.Starter._CONFIG.lienInfo=n,!1},n.setIconePath=function(){var a=t.getParameterOneAndClearIt("skinURL_HTML");return a&&e.Starter._CONFIG.setIconesPath(a),!1},n.setFlipDelay=function(){var a=t.getParameterOneAndClearIt("flipDelay"),n=t.getParameterOneAndClearIt("flipDelayCustomized");return a&&n&&e.Starter._CONFIG.setFlipDelay(a),!1},n.setIfDisableZoom=function(){var a=t.getParameterOneAndClearIt("disableZoom");return"true"==a&&e.Starter._CONFIG.setEnableZoom(!1),!1},n.getIdTrack=function(){var a=t.getParameterOneAndClearIt("idTrack");return a&&(e.Starter._CONFIG.trackStatInfo.idTrack=a),!1},n.getLabelTrack=function(){var a=t.getParameterOneAndClearIt("labelTrack");return a&&(e.Starter._CONFIG.trackStatInfo.labelTrack=a),!1},n.getPiwikTrack=function(){var a=t.getParameterOneAndClearIt("piwikTrack");return a&&(e.Starter._CONFIG.trackStatInfo.piwikTrack=a),!1},n.getLoadJavascriptForHtmlSlider=function(){var a=t.getParameterOneAndClearIt("loadJavascriptForHtmlSlider");return a&&(a=e.Starter._CONFIG.getDynamiqueVariableFromFlag(a),e.Starter._CONFIG.loadJavascriptForHtmlSlider=a),!1},n.htmlMenuParam=function(){var a=t.getParameterOneAndClearIt("htmlMenuParam");return"true"===a&&(e.Starter._CONFIG.htmlMenuParam=!0),!1},n.setPathFondRelatif=function(){var a=t.getParameterOneAndClearIt("pathFondRelatif");return a&&(a=e.Starter._CONFIG.getDynamiqueVariableFromFlag(a),setTimeout(function(){e.Utils.prodTools.setFondRelatif(a)},200)),!1},n.setPathPagePdf=function(){var a=t.getParameterOneAndClearIt("pathPagePdf");return e.Starter._CONFIG.pagesOnInit.pathPagePdf=a,e.Starter._CONFIG.pages.pathPagePdf=a,!1},n.setPathTextureLow=function(){var a=t.getParameterOneAndClearIt("pathTextureLow");return e.Starter._CONFIG.pagesOnInit.pathTextureLow=a,e.Starter._CONFIG.pages.pathTextureLow=a,!1},n.setPathTextureHigh=function(){var a=t.getParameterOneAndClearIt("pathTextureHigh");return e.Starter._CONFIG.pagesOnInit.pathTextureHigh=a,e.Starter._CONFIG.pages.pathTextureHigh=a,!1},n.setPathDiapo=function(){var a=t.getParameterOneAndClearIt("pathDiapo");return e.Starter._CONFIG.pagesOnInit.Diapo=a,e.Starter._CONFIG.pages.Diapo=a,!1},n.setPathLinks=function(){var a=t.getParameterOneAndClearIt("pathLinks");return e.Starter._CONFIG.pagesOnInit.pathLinks=a,e.Starter._CONFIG.pages.pathLinks=a,!1},n.setPathGallery=function(){var a=t.getParameterOneAndClearIt("pathGallery");return a!==!1&&(e.Starter._CONFIG.pathXmlGallery=a),!1},n.setPathXmlSecurity=function(){var a=t.getParameterOneAndClearIt("pathXmlSecurity");return e.Starter._CONFIG.pathXmlSecurity=a,!1},e.Class.Param=a}(webpublicationNamespace),function(e){e.Class.PositionForSlider=function(){var t=function(t){this.parent=t,this.posCurrentOfElem=0,this.currElem=null,this.defaultPosElementY=0,this.lastElemIndex=0,this.centerPosXe=0,this.tCleared=!1,this.getInfoPositionVars={pageW:e.Starter._CONFIG.pagesOnInit.width,pageWX2:e.Starter._CONFIG.pagesOnInit.width,pageH:e.Starter._CONFIG.pagesOnInit.height,pageOutW:e.Starter._CONFIG.pages.width,pageOutH:e.Starter._CONFIG.pages.height,docW:e.Starter._CONFIG.getDocument.width,docH:e.Starter._CONFIG.getDocument.height,currScaleOut:e.Starter._CONFIG.pagesOnInit.currScale,keepMaxResolution:e.Starter._CONFIG.pages.keepMaxResolution,nbFloat:1e3,prW:0,prH:0,operatDouble:1,propCibleScale:0}},a=t.prototype;return a.positionMe=function(){var t=null,a=null;return function(n){return t=!1,n=~~n,a=~~e.Main.pagesLoader.pageCurrentOriginalIs,e.Starter.main.currElemPos[n]="object"!=typeof e.Starter.main.currElemPos[n]?{}:e.Starter.main.currElemPos[n],e.Starter.main.currElemPos[n].y=this.defaultPosElementY,a>n?t=this.posLeftMe:n==a?t=this.posCenterMe:n>a&&(t=this.posRightMe),t.call(this,n)}}(),a.posRightMe=function(){var t=null,a=null,n=null;return function(i){return t=0,a=0,"X"==e.Starter._CONFIG.pages.slideType?t=e.Utils.getLocalSize(e.Starter._CONFIG.pages.width_or_height):a=e.Utils.getLocalSize(e.Starter._CONFIG.pages.width_or_height),n="-webkit-transform: translate3d("+t+"px , "+a+"px,0);-ms-transform: translate3d("+t+"px , "+a+"px,0);transform: translate3d("+t+"px , "+a+"px,0);-ms-transform: translate3d("+t+"px , "+a+"px,0)",e.Starter.main.currElemPos[i][e.Starter._CONFIG.pages.x_or_y]=e.Starter._CONFIG.getDocument.width,n}}(),a.posCenterMe=function(){var t=null,a=null,n=null;return function(i){return t=0,a=0,"X"==e.Starter._CONFIG.pages.slideType?t=this.centerPosXe:a=this.centerPosXe,n="-webkit-transform: translate3d("+t+"px , "+a+"px,0);-ms-transform: translate3d("+t+"px , "+a+"px,0);transform: translate3d("+t+"px , "+a+"px,0);-ms-transform: translate3d("+t+"px , "+a+"px,0)",e.Starter.main.currElemPos[i][e.Starter._CONFIG.pages.x_or_y]=this.centerPosXe,n}}(),a.posLeftMe=function(){var t=null,a=null,n=null;return function(i){return t=0,a=0,"X"==e.Starter._CONFIG.pages.slideType?t=-e.Utils.getLocalSize(e.Starter._CONFIG.pages.width_or_height):a=-e.Utils.getLocalSize(e.Starter._CONFIG.pages.width_or_height),n="-webkit-transform: translate3d("+t+"px , "+a+"px,0);-ms-transform: translate3d("+t+"px , "+a+"px,0);transform: translate3d("+t+"px , "+a+"px,0);-ms-transform: translate3d("+t+"px , "+a+"px,0)",e.Starter.main.currElemPos[i][e.Starter._CONFIG.pages.x_or_y]=-e.Starter._CONFIG.getDocument[e.Starter._CONFIG.pages.width_or_height],n}}(),a.positionIt=function(){var t=null;return function(a,n,i,r,o){if(n=~~n,i=~~i,r=0!==r?e.Starter._CONFIG.pages.animationManager.transitionTime:r,e.Starter.main.currElemPos[n]="object"!=typeof e.Starter.main.currElemPos[n]?{}:e.Starter.main.currElemPos[n],e.Starter.main.currElemPos[n].y=this.defaultPosElementY,t=!1,i>n?t=this.posLeft:n==i?t=this.posCenter:n>i&&(t=this.posRight),t){if(!r)return t.call(this,a,n,0,o),!1;t.call(this,a,n,r,o)}return!1}}(),a.posRight=function(t,a,n,i){e.Starter.main.currElemPos[a][e.Starter._CONFIG.pages.x_or_y]=e.Starter._CONFIG.getDocument[e.Starter._CONFIG.pages.width_or_height]},a.posCenter=function(t,a,n,i){(1==a||a===e.Main.xmlManager.get("common-configuration","config","pageCount"))&&t.clearQueue(),this.currElem=null,delete this.currElem,e.Starter.timerDrawCanvas&&clearTimeout(e.Starter.timerDrawCanvas),e.Starter.timerDrawCanvas=setTimeout(function(){e.Main.controlManager.drawCanvas()},e.Starter._CONFIG.pages.timeToLoadHD),e.Starter.main.currElemPos[a][e.Starter._CONFIG.pages.x_or_y]=this.centerPosXe},a.posLeft=function(t,a,n,i){e.Starter.main.currElemPos[a][e.Starter._CONFIG.pages.x_or_y]=-e.Starter._CONFIG.getDocument[e.Starter._CONFIG.pages.width_or_height]},a.onDragElem=function(){var t=null;return function(a,n){return this.tCleared||(clearTimeout(e.Starter.timerDrawCanvas),this.tCleared=!0),this.currElem||(t=e.Starter._CONFIG.pages.defaultName,t+="",t+=e.Main.pagesLoader.pageCurrentOriginalIs,this.currElem=e.Main.pagesLoader.pageCreated[t]),"X"==e.Starter._CONFIG.pages.slideType?(this.posCurrentOfElem=e.Starter.main.currElemPos[e.Main.pagesLoader.pageCurrentOriginalIs][e.Starter._CONFIG.pages.x_or_y]+a,"onMove"!=this.currElem[0].className&&(this.currElem[0].className="onMove"),e.Utils.styleTransform(this.currElem[0],"translate3d("+this.posCurrentOfElem+"px, 0, 0)")):(this.posCurrentOfElem=e.Starter.main.currElemPos[e.Main.pagesLoader.pageCurrentOriginalIs][e.Starter._CONFIG.pages.x_or_y]+n,"onMove"!=this.currElem[0].className&&(this.currElem[0].className="onMove"),e.Utils.styleTransform(this.currElem[0],"translate3d(0, "+this.posCurrentOfElem+"px, 0)")),e.Main.eventEmul.callEvent("onDragPage",this.posCurrentOfElem),!1}}(),a.onDropElem=function(){return function(t){if(this.tCleared=!1,!this.currElem){var a=e.Starter._CONFIG.pages.defaultName;a+="",a+=e.Main.pagesLoader.pageCurrentOriginalIs,this.currElem=e.Main.pagesLoader.pageCreated[a]}e.Starter.timerDrawCanvas&&clearTimeout(e.Starter.timerDrawCanvas),e.Starter.timerDrawCanvas=setTimeout(function(){e.Main.controlManager.drawCanvas()},e.Starter._CONFIG.pages.timeToLoadHD),e.Starter.main.currElemPos[e.Main.pagesLoader.pageCurrentOriginalIs][e.Starter._CONFIG.pages.x_or_y]=e.Starter.main.currElemPos[e.Main.pagesLoader.pageCurrentOriginalIs][e.Starter._CONFIG.pages.x_or_y]+t,e.Main.eventEmul.callEvent("onDragPage",0)}}(),a.getInfoPosition=function(){var t=null,a=null,n=null,i=null,r=null,o=null,s=null,l=null,u=null,c=null,d=null,h=null,p=null;return function(){return e.Starter._CONFIG.setDocument(),t=e.Starter._CONFIG.pagesOnInit.width,a=e.Starter._CONFIG.pagesOnInit.height,n=e.Starter._CONFIG.pages.width,i=e.Starter._CONFIG.pages.height,r=e.Starter._CONFIG.getDocument.width,o=e.Starter._CONFIG.getDocument.height,s=e.Starter._CONFIG.pagesOnInit.currScale,l=e.Starter._CONFIG.pages.keepMaxResolution,u=1e3,c=0,d=0,h=1,p=c,e.Starter._CONFIG.pages.currScale=s,e.Starter._CONFIG.pages.doublePage&&(t*=2,h=2),o>a&&r>t&&l?(i=a,n=pageW):(c=~~(r/t*u)/u,d=~~(o/a*u)/u,p=d>c?c:d,s=~~(100*p)/100,i=a*p,n=t*p/h),e.Starter._CONFIG.pages.width=n,e.Starter._CONFIG.pages.height=i,e.Starter._CONFIG.pages.currScale=s,!1}}(),a.alignAll=function(){return e.Main.controlManager.resetZoomInfo&&!e.Main.controlManager.autoriseChangePage&&e.Main.controlManager.resetZoomInfo(),e.Main.pagesLoader.goDoublePage(),!1},t}()}(webpublicationNamespace),function(e){e.Utils.prodTools={},e.Utils.prodTools.getPageLength=function(){return e.Main.xmlManager.get("common-configuration","config","pageCount")},NIApi.register("common.getDeviceInformation",function(){var t={};return t.type=e.Param.userAgent.device.type,t.os=e.Param.userAgent.os.name+" "+e.Param.userAgent.os.version,t.browser=e.Param.userAgent.browser.name,t.isApp=e.Param.isApp,Promise.resolve(t)}),NIApi.register("event.onPageChange",function(t){return e.Param.newViewerVersion?e.Main.pagesLoaderNew.addPageChangeCallback(t):e.Main.pagesLoader.onPageChange(t),!0}),NIApi.register("page.getVisiblePages",function(){return Promise.resolve(e.Utils.getVisiblePages())}),NIApi.register("navigator.openUrl",function(t){return Promise.resolve(window.open(e.Utils.resolveVariable(t),"_blank"))}),NIApi.register("navigator.close",function(t){return e.Main.menuService.get("home").onclick(),Promise.resolve(!0)}),NIApi.register("page.clickButton",function(e,t){return console.log("TODO : in developpement"),Promise.resolve()}),NIApi.register("viewer.changeMode",function(t){return console.log("TODO : in developpement"),e.Utils._assertString(t,"Page number must be a string"),Promise.resolve()}),NIApi.register("tab.open",function(t){return console.log("TODO : in developpement"),e.Utils._assertInteger(t,"Page number must be an integer")?Promise.reject():Promise.resolve()}),e.Utils.prodTools.goDoublePage=function(t,a,n){e.Main.pagesLoader.goDoublePage(t,a,n)},e.Utils.prodTools.isMaster=function(){return e.Utils.isMaster()},e.Utils.prodTools.iconesPath=function(){return e.Starter._CONFIG.iconesPath},e.Utils.prodTools.onShowTools=function(t){e.Main.controlManager.onShowTools(t)},e.Utils.prodTools.showTools=function(t){e.Main.controlManager.showTools(t)},e.Utils.prodTools.onPageChange=function(t){e.Param.newViewerVersion?e.Main.pagesLoaderNew.addPageChangeCallback(t):e.Main.pagesLoader.onPageChange(t)},e.Utils.prodTools.onZoomPage=function(t){e.Main.controlManager.onZoomPage(t)},e.Utils.prodTools.onClickLink=function(e){return!1},e.Utils.prodTools.onResizeCustom=function(t){return"function"==typeof t?(window.addEventListener(e.Param.eventResize,t),!0):!1},e.Utils.prodTools.clearOnResizeCustom=function(e){},e.Utils.prodTools.getUserAgent=function(){return e.Param.userAgent},e.Utils.prodTools.getCurrentLangue=function(){return e.Param.language},e.Utils.prodTools.get_X_Y_Z=function(){return e.Main.x_y_z_Manager.urlVarId},e.Utils.prodTools.getWordLangueByIndex=function(t){return e.Main.xmlManager.get("locale",t)},e.Utils.prodTools.getXmlByNameFile=function(t){return e.Starter.main.xmlLinksList.getXml[t]?e.Starter.main.xmlLinksList.getXml[t]:"error or file not Existe"},e.Utils.prodTools.setDisableCarrousel=function(t){e.Starter._CONFIG.setDisableCarrousel=t},e.Utils.prodTools.setFondRelatif=function(t,a){if("android"==e.Param.userAgent.os.name)return!1;if(a){var n=document.createElement("div");return n.className="bgCustom",n.style="display:none;z-index:1;width:100%;height:100%;position:absolute;left:0;top:0;",n.appendChild(t),document.body.appendChild(n),setTimeout(function(){n.fadeIn(400)},500),!1}var i=new Image;i.onload=function(){document.body.style.background="transparent url('"+t+"') center no-repeat",document.body.style.backgroundSize="cover",document.body.style.backgroundClip="content-box"},i.src=t},e.Utils.prodTools.getMenuTop=function(){return e.Starter.main.menuParamManager.menuParam?e.Starter.main.menuParamManager.menuParam:void 0}}(webpublicationNamespace),function(e){function t(){this.worker=null,this.counter=0,this.finalResultElement=null,this.notificationElement=null,this.resultElement=null,this.formField=null}var a=[37,38,39,40],n="";t.prototype.displayEnd=function(){this.setCounter(this.counter),this.finalResultElement.classList.add("search__searched"),0===this.counter?(this.notificationElement.classList.add("alert"),this.finalResultElement.classList.add("search__no-result")):(this.notificationElement.classList.add("notification"),this.finalResultElement.classList.add("search__has-result"))},t.prototype.displayResult=function(t){e.Main.templateManager.loadAppend(e.Param.pathTemplate+"component/searchItem.html",this.resultElement,{page:t.page,displayNumber:e.Utils.byOffsetIndex(t.page),string:t.string,label:t.label}),this.counter++},t.prototype.init=function(){this.worker=new Worker(e.Param.pathJavaScript+"workerSearch.js"),this.worker.addEventListener("message",function(t){"parse"===t.data.method?this.worker.postMessage({method:"parsedString",data:e.JXONTree((new DOMParser).parseFromString(t.data.data,"text/xml")),page:t.data.page}):"result"===t.data.method?this.displayResult(t.data):"end"===t.data.method&&this.displayEnd(t.data)}.bind(this));var t={method:"config",pageLength:e.Main.xmlManager.get("common-configuration","config","pageCount"),xmlUrl:e.Param.pathRootForWorker+e.Main.xmlManager.get("common-configuration","contents","text","path")};t.wordSearch=!0,this.worker.postMessage(t)},t.prototype.reset=function(){this.resetContent(),this.formField.value=""},t.prototype.resetContent=function(){this.notificationElement.classList.remove("alert"),this.notificationElement.classList.remove("notification"),this.finalResultElement.classList.remove("search__no-result"),this.finalResultElement.classList.remove("search__has-result"),this.finalResultElement.classList.remove("search__searched"),e.Main.searchManager.resultElement.innerHTML="",this.setCounter(""),e.Main.urlManager.set("search",null)},t.prototype.search=function(t){a.indexOf(t.keyCode)>=0||13===t.keyCode||(this.resetContent(),this.counter=0,this.formField.value.length>3&&(this.resultElement.innerHTML="",e.Main.searchManager.worker.postMessage({method:"search",search:this.formField.value}),e.Main.urlManager.set("search",this.formField.value),n=this.formField.value))},t.prototype.searchEvent=function(t){this.formField.value.length>3&&(this.eventTimer&&clearTimeout(this.eventTimer),this.eventTimer=setTimeout(function(){e.Main.trackerManager.trackPage({name:"search-alt",variables:{1:this.formField.value}})}.bind(this),1e3))},t.prototype.setCounter=function(e){Array.prototype.slice.call(document.querySelectorAll(".search__counter")).forEach(function(t){t.innerHTML=e})},t.prototype.show=function(){var t=function(t){e.Main.searchManager.finalResultElement=t.querySelector(".search__final-result"),e.Main.searchManager.notificationElement=t.querySelector(".search__notification"),e.Main.searchManager.resultElement=t.querySelector(".search__result"),e.Main.searchManager.formField=t.querySelector(".search__form-field"),e.Main.templateOldManager.callbacks.icons($(this)),e.Main.searchManager.formField.addEventListener("keyup",e.Main.searchManager.search.bind(e.Main.searchManager)),e.Main.searchManager.formField.addEventListener("keyup",e.Main.searchManager.searchEvent.bind(e.Main.searchManager)),e.Main.searchManager.formField.addEventListener("keydown",function(e){return 13===e.keyCode||a.indexOf(e.keyCode)>=0?(13===e.keyCode&&e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1):void 0}),t.querySelector(".search__form-submit").addEventListener(e.Param.eventClick,e.Main.searchManager.search.bind(e.Main.searchManager)),t.querySelector(".search__form-reset").addEventListener(e.Param.eventClick,e.Main.searchManager.reset.bind(e.Main.searchManager)),e.Main.searchManager.resultElement.addEventListener(e.Param.eventClick,function(t){var a=e.Utils.getClosestByClass(t.target,"search__item");if(a!==!1){var n=a.getAttribute("data-page");NIApi.page.open(n),e.Class.LightboxManagerNew.close("search-manager")}});var n=e.Class.LightboxManagerNew.get("search-manager");n.setTitle(document.querySelector(".search__form"))};e.Main.trackerManager.trackPage({name:"search"}),new e.Class.LightboxManagerNew({id:"search-manager",theme:"page",menuButton:!1,animation:"none",subtemplate:{url:e.Param.pathTemplate+"search.html",params:{search:n}},onload:function(e){t(e[0])}})},e.Class.SearchManager=t}(webpublicationNamespace),function(e){e.Class.SecurityXml=function(){var t=this;t.callBack=null,t.securityCheck=null,t.getXmlFile=function(a){var n={};n[e.Starter._CONFIG.securityFileName]=e.Starter._CONFIG.securityFileName,t.securityCheck=new e.Class.XmlLoader(t,"xmlLinksList",e.Starter._CONFIG.xmlNeededToLoadPath,n,a)},t.init=function(e){t.getXmlFile(e)},t.checkIfSecurityNeeded=function(a){t.callBack=a;var n=t.securityCheck.getXml.security,i=$(n).find("auth");if(n&&i.length&&"true"==i.attr("publication")){var r='<table cellspacing="0" cellpadding="0" id="authentification"><tr><td><div id="div_authentication">';r+='<form id="form_authentication" name="form_authentication" action="javascript:void(0)">',r+='<fieldset><label for="login">'+e.Utils.prodTools.getWordLangueByIndex(57)+'</label><input tabindex="1" type="text" name="login" value="" ></fieldset>',r+='<fieldset><label for="pass">'+e.Utils.prodTools.getWordLangueByIndex(58)+'</label><input tabindex="2" type="password" name="pass" value="" ></fieldset>',r+='<fieldset style=""><div class="submitDiv" ><input type="submit" id="okSecurityXml" value="'+e.Utils.prodTools.getWordLangueByIndex(59)+'" /></fieldset>',r+="</form></div></td></tr></table>",t.securityDiv=(new DOMParser).parseFromString(r,"text/xml").firstChild,document.body.appendChild(t.securityDiv),$("#form_authentication").bind("submit",function(a){return t.checkPassword(a),e.Utils.preventDefault(a),!1})}else t.callBack&&t.callBack()},t.animeError=function(e){$("#div_authentication").animate({left:"-5px"},80,function(){$(this).animate({left:"+5px"},80,function(){2>e?(e++,t.animeError(e)):$(this).animate({left:"0"},80)})})},t.checkPassword=function(e){var a=t.securityCheck.getXml.security,n=a.find("auth"),i=e.target;t.myLoginObj=$(i).find("input[name=login]"),t.myPassObj=$(i).find("input[name=pass]"),t.myLogin=t.myLoginObj.val().trim(),t.myPass=t.myPassObj.val().trim(),t.notFound=!0;var r=$(n).children("[login='"+t.myLogin+"'][password='"+t.myPass+"']");return r[0]?(t.callBack&&t.callBack(),t.notFound=!1,document.body.removeChild(t.securityDiv),delete t.securityDiv,!1):(t.animeError(0),!1)}}}(webpublicationNamespace),function(e){function t(t){t||(t=e.Utils.createUrlForPages()),t=e.Utils.whitelistParameters(t),t=t.replace("&","%26");var a="mailto:?subject="+document.title+"&body="+document.title+": %0D%0A "+t;return a}function a(t){parameters={};for(var a=[],i=t.querySelectorAll("input, textarea"),o=!0,s=0;s<i.length;s++){var l=i[s],u=!0;if(l.hasAttribute("data-validation")&&(u=n(l)),u){parameters[l.getAttribute("name")]=l.value;var c=a.indexOf(l.parentNode.getAttribute("data-error"));c>=0&&a.splice(c,1)}else o=!1,a.push(l.parentNode.getAttribute("data-error"))}if(o===!1)return r(a),!1;parameters.language=e.Param.language,parameters.clientId=e.Main.xmlManager.getVariable("client_id"),parameters.genId=e.Main.xmlManager.getVariable("id"),parameters.pubUrl=e.Main.shareMailManager.url?e.Main.shareMailManager.url:e.Utils.createUrlForPages(parameters),parameters.pubUrl=e.Utils.whitelistParameters(parameters.pubUrl);var d=document.createElement("a");d.href=parameters.pubUrl,parameters.querySearch=d.search,parameters.queryHash=d.hash,parameters.queryHost=d.protocol+"//"+d.host+d.pathname;var h=e.Main.xmlManager.getVariables();for(var p in h)0===p.indexOf("transferring")&&"undefined"!=typeof h[p]&&(parameters[p]=h[p]);var g="";return g=parameters.transferring?e.Main.xmlManager.get("common-ui","services","sendmail","templateTransferring"):e.Main.xmlManager.get("common-ui","services","sendmail","template"),g&&(parameters.template=g),parameters.extraAllowedParameters=[e.Main.xmlManager.get("config","transferringVariable")].join(","),parameters}function n(t){if("mails"===t.getAttribute("data-validation")){var a=e.Utils.mailStringToArray(t.value);if(0===a.length)return t.parentNode.classList.add("alert"),!1;t.value=a.join(";").toLowerCase()}else if("required"===t.getAttribute("data-validation")&&!t.value)return t.parentNode.classList.add("alert"),!1;return t.parentNode.classList.remove("alert"),!0}function i(t){return"undefined"==typeof t||0===t.length?e.Main.xmlManager.get("locale","mail_send_error"):1===t.length?e.Main.xmlManager.get("locale","mail_"+t[0]+"_error"):t.length>1?e.Main.xmlManager.get("locale","mail_fields_error"):void 0}function r(t){e.Utils.toast({html:i(t),duration:3e3,position:"bottom"})}function o(t){"response=ok"===t.responseText?(e.Utils.toast({text:e.Main.xmlManager.get("locale","mail_send_success"),duration:3e3}),document.getElementsByName("to")[0].value="",e.Class.LightboxManagerNew.get("shareManager")&&e.Main.shareManager.open("confirm")):e.Utils.toast({text:e.Main.xmlManager.get("locale","mail_send_error"),duration:3e3,type:"error"})}function s(){}var l={};s.prototype.send=function(t){e.Utils.preventDefault(t);var n=a(this);if(n!==!1){l=n,e.Main.trackerManager.trackEvent({name:"shareMail"});var i=e.Main.xmlManager.get("common-ui","services","sendmail","url"),s=e.Utils.serialize(n);e.Utils.promiseXHR("POST",i,[{key:"Content-Type",value:"application/x-www-form-urlencoded; charset=UTF-8"}],s).then(o)["catch"](r)}},s.prototype.load=function(t,a){"undefined"==typeof a&&(a={}),this.url=t?t:null;var n=l,i=e.Main.shareManager.selectedThumb;n.sharedPages=i?i.pages:[],n.title=document.title,new e.Class.LightboxManagerNew({id:"thumbnails-manager",menuButton:e.Param.isDesktop?!1:"close",closeButton:e.Param.isDesktop?!0:this.createSendButton(),title:e.Main.xmlManager.get("locale","menu_mail"),theme:"page",animation:"none",subtemplate:{url:e.Param.pathTemplate+"shareMail.html",params:n},onload:function(t){var a=t[0].querySelector('.webpub-lightbox-page-header-close [data-action="submit"]');a&&a.addEventListener(e.Param.eventClick,function(){var t=document.querySelector(".webpub-lightbox-page-content"),a=t.querySelector('[data-action="submit"]');e.Utils.callEvent(a,"submit")}),t[0].querySelector('.webpub-lightbox-page-content [data-action="submit"]').addEventListener("submit",this.send)}.bind(this)})},s.prototype.createSendButton=function(){var t=document.createElement("div"),a=document.createElement("div"),n=e.Utils.createSvgIcon("send-v4","wpmt-button-icon-center svgicon-new svgicon-v4");return a.classList.add("wpmt-button__default"),a.classList.add("wpmt-button__type-mail"),a.classList.add("wpmt-button__style-tiny"),a.setAttribute("data-action","submit"),a.appendChild(n),t.appendChild(a),t},s.prototype.doMailTo=function(e){location.href=t(e)},e.Class.ShareMailManager=s}(webpublicationNamespace),function(e){e.Class.ShareManager=function(){function t(t,a){if((a||R[t]===!0)&&z[t]){var n=e.Utils.whitelistParameters(document.location.href);return z[t](n),-1===["print","download","mail"].indexOf(t)&&e.Main.trackerManager.trackEvent({name:"shareSocial",variables:{1:e.Utils.capitalize(t)}}),!0}return!1}function a(){if(D="frame",2===U.length)X(E[1]);else{if(G=[e.Main.pageManager.getCurrent()],e.Main.shareManager.selectedThumb.pages=G,"download"===e.Main.shareManager.sharePanelPath||"print"===e.Main.shareManager.sharePanelPath)return void d(e.Main.shareManager.sharePanelPath);X(E[3])}}function n(){return"download"===e.Main.shareManager.sharePanelPath||"print"===e.Main.shareManager.sharePanelPath?(F="pdf",void d(e.Main.shareManager.sharePanelPath)):(D="publication",X(E[2]),void W(1))}function i(){e.Main.thumbnailListManager.show("share",e.Main.shareManager.sharePanelPath)}function r(t,a,n){return D="favorite",G=t,F=a,e.Main.shareManager.sharePanelPath=n,e.Main.shareManager.selectedThumb.pages=t,"download"===e.Main.shareManager.sharePanelPath||"print"===e.Main.shareManager.sharePanelPath?void d(e.Main.shareManager.sharePanelPath):void X(E[3])}function o(e){e.length>0&&(G=e),D="favorite",X(E[3])}function s(){X(N!==E[3]||D===!1||"frame"===D&&1===U.length?E[0]:D)}function l(){if(N===E[1]){if(G=[],0===document.querySelectorAll(".webpub-share__checkbox--checked").length)return;document.querySelector(".webpub-share__left-page").classList.contains("webpub-share__checkbox--checked")?(G.push(U[0]),e.Main.shareManager.selectedThumb.pages.push(U[0])):e.Main.shareManager.selectedThumb.left=!1,document.querySelector(".webpub-share__right-page").classList.contains("webpub-share__checkbox--checked")?(G.push(U[1]),e.Main.shareManager.selectedThumb.pages.push(U[1])):e.Main.shareManager.selectedThumb.right=!1}else N===E[2]&&(document.querySelector(".webpub-share__online-url").classList.contains("webpub-share__checkbox--checked")?F="url":document.querySelector(".webpub-share__pdf").classList.contains("webpub-share__checkbox--checked")&&(F="pdf"));return"download"===e.Main.shareManager.sharePanelPath||"print"===e.Main.shareManager.sharePanelPath?void d(e.Main.shareManager.sharePanelPath):void X(E[3])}function u(t){var a=e.Utils.getClosestByClass(t.target,"webpub-share__item"),n=document.querySelector("[data-page="+a.getAttribute("data-page")+"]");n.classList.toggle("webpub-share__thumbnail-unchecked"),a.classList.toggle("webpub-share__checkbox--checked"),0===document.querySelectorAll(".webpub-share__checkbox--checked").length?document.querySelector(".webpub-share__button-confirm").classList.add("webpub-share__button-disabled"):document.querySelector(".webpub-share__button-confirm").classList.remove("webpub-share__button-disabled")}function c(t){var a=e.Utils.getClosestByClass(t.target,"webpub-share__item");a.classList.contains("webpub-share__online-url")?(a.classList.add("webpub-share__checkbox--checked"),document.querySelector(".webpub-share__pdf").classList.remove("webpub-share__checkbox--checked")):a.classList.contains("webpub-share__pdf")&&(a.classList.add("webpub-share__checkbox--checked"),document.querySelector(".webpub-share__online-url").classList.remove("webpub-share__checkbox--checked"))}function d(t){var a="";a=-1===["print","download","mail"].indexOf(t)?"frame"===D?e.Utils.createUrlForPages({page:G[0]}):"url"===F?e.Utils.createUrlForPages():e.API.pdfGetUrl():document.location.href,"favorite"===D&&(a=e.Utils.addParamsToUrl(a,"bookmarks="+G)),a=e.Utils.whitelistParameters(a),z[t](a),-1===["print","download","mail"].indexOf(t)&&e.Main.trackerManager.trackEvent({name:"shareSocial",variables:{1:e.Utils.capitalize(t)}}),-1===["mail"].indexOf(t)&&X(E[4])}function h(t,a){var n={download:"pdf",print:"print"};return e.Main.shareManager.sharePanelPath=a,e.Class.LightboxManagerNew.closeAll({except:["shareManager"]}),e.Main.shareManager.selectedThumb={left:!0,right:!0,pages:[]},("undefined"==typeof t||E.indexOf(t.toLowerCase())<0)&&(t=E[0]),_=!0,O&&clearTimeout(O),e.Main.trackerManager.trackPage({name:n[a]||"share"}),v(e.Main.pageManager.getCurrent()),X(t)}function p(){g()}function g(){return _?document.querySelector(".lightbox")?void h():(B.close("shareManager"),_=!1,G=[],B=null,e.Utils.empty(A),!0):!1}function m(e,t){_?g():h(e,t)}function f(e){O&&clearTimeout(O),O=setTimeout(v.bind({},e),2e3)}function v(t){U=e.Utils.getVisiblePages(),W(t)}function b(){k.ogType=document.createElement("meta"),k.ogType.setAttribute("property","og:type"),k.ogType.setAttribute("content","article"),k.ogTitle=document.createElement("meta"),k.ogTitle.setAttribute("property","og:title"),k.ogTitle.setAttribute("content","title"),k.ogDescription=document.createElement("meta"),k.ogDescription.setAttribute("property","og:description"),k.ogDescription.setAttribute("content","description"),k.ogImage=document.createElement("meta"),k.ogImage.setAttribute("property","og:image"),k.ogImage.setAttribute("content",e.Main.pageManager.getImage("mdpi",1)),k.ogUrl=document.createElement("meta"),k.ogUrl.setAttribute("property","og:url"),k.ogUrl.setAttribute("content",e.Utils.createUrlForPages({page:1})),k.ogSiteName=document.createElement("meta"),k.ogSiteName.setAttribute("property","og:site_name"),k.ogSiteName.setAttribute("content",document.getElementsByTagName("title")[0].innerText),k.twitterCard=document.createElement("meta"),k.twitterCard.setAttribute("name","twitter:card"),k.twitterCard.setAttribute("content","summary_large_image"),k.twitterSite=document.createElement("meta"),k.twitterSite.setAttribute("name","twitter:site"),k.twitterSite.setAttribute("content","NOUS"),k.twitterTitle=document.createElement("meta"),k.twitterTitle.setAttribute("name","twitter:title"),k.twitterTitle.setAttribute("content","title"),k.twitterDescription=document.createElement("meta"),k.twitterDescription.setAttribute("name","twitter:description"),k.twitterDescription.setAttribute("content",location.href),k.twitterImage=document.createElement("meta"),k.twitterImage.setAttribute("name","twitter:image"),k.twitterImage.setAttribute("content",e.Main.pageManager.getImage("mdpi",1));for(var t in k)document.head.appendChild(k[t])}function y(){}function w(){window.addEventListener(e.Param.eventResize,y)}function C(){NIApi.register("page.shareSocial",function(t){return Promise.resolve(e.Main.shareManager.shareSocial(t,!0))})}function M(e){for(var t in e)"undefined"!=typeof R[t]&&(R[t]=e[t]);_socialsDefault={facebook:R.facebook,twitter:R.twitter,googleplus:R.googleplus,linkedin:R.linkedin,pinterest:R.pinterest,tumblr:R.tumblr,instagram:R.instagram,vkontakte:R.vkontakte},P()}function P(){return"url"===F?(R.download=!1,R.print=!1,R.mail=!0):"pdf"===F&&(R.print=V,R.download=V,R.mail=!1),q={mail:R.mail,print:R.print,download:R.download}}function x(){for(var e={},t=!1,a=Object.keys(_socialsDefault),n=0;n<a.length;n++)R[a[n]]="pdf"===F?!1:_socialsDefault[a[n]],e[a[n]]=R[a[n]],t=t||R[a[n]];return t===!1&&(e=!1),e}function S(t){switch(t){case"download":return e.Main.xmlManager.get("locale","menu_download");case"print":
return e.Main.xmlManager.get("locale","menu_print");default:return t?t:e.Main.xmlManager.get("locale","menu_sharethis")}}function L(t){switch(t){case"download":return e.Main.xmlManager.get("locale","share_downloaded_confirm");case"print":return e.Main.xmlManager.get("locale","share_printed_confirm");default:return e.Main.xmlManager.get("locale","share_shared_confirm")}}function I(t){M(t),C(),b(),w(),e.Param.newViewerVersion?e.Main.pagesLoaderNew.addPageChangeCallback(f):e.Main.pagesLoader.onPageChange(f),T=!0}var T=(e.Param.newThemeVersion,!1),_=!1,O=!1,k={},E=["home","frame","publication","social","confirm"],N="",A=document.createElement("div"),D=!1,F=!1,U=[],G=[],q={},B=null,V=e.Param.userAgent.os.name!==e.Param.userAgent.OS.IOS||parseInt(e.Param.userAgent.os.version)>7,R={mail:!0,print:V,download:V,facebook:!0,twitter:!0,googleplus:!0,linkedin:!0,pinterest:!0,tumblr:!0,instagram:!1,vkontakte:!1},z={mail:function(t){"mailto"===e.Param.mailType?e.Main.shareMailManager.doMailTo(t):e.Main.shareMailManager.load(t)},print:function(){"frame"===D||"favorite"===D?e.Main.pdfManager.print(G.join(",")):e.Main.pdfManager.print()},download:function(){"frame"===D||"favorite"===D?e.Main.pdfManager.download(G.join(",")):e.Main.pdfManager.download()},facebook:function(t){if(t="http://www.facebook.com/sharer.php?u="+encodeURIComponent(t),e.Main.xmlManager.getXml("ui")){var a=e.Main.xmlManager.getXml("ui").querySelector("element#facebook_btn[template]");if(a){var n=a.querySelector("useract");n.hasAttribute("param")&&(t=n.getAttribute("param"))}}window.open(t,"_blank")},twitter:function(t){if(t="https://twitter.com/share?url="+encodeURIComponent(t),e.Main.xmlManager.getXml("ui")){var a=e.Main.xmlManager.getXml("ui").querySelector("element#twitter_btn[template]");if(a){var n=a.querySelector("useract");n.hasAttribute("param")&&(t=n.getAttribute("param"))}}window.open(t,"_blank")},googleplus:function(t){if(t="http://plusone.google.com/_/+1/confirm?hl=fr&url="+encodeURIComponent(t),e.Main.xmlManager.getXml("ui")){var a=e.Main.xmlManager.getXml("ui").querySelector("element#googleplus_btn[template]");if(a){var n=a.querySelector("useract");n.hasAttribute("param")&&(t=n.getAttribute("param"))}}window.open(t,"_blank")},linkedin:function(t){if(t="http://www.linkedin.com/shareArticle?url="+encodeURIComponent(t),e.Main.xmlManager.getXml("ui")){var a=e.Main.xmlManager.getXml("ui").querySelector("element#linkedin_btn[template]");if(a){var n=a.querySelector("useract");n.hasAttribute("param")&&(t=n.getAttribute("param"))}}window.open(t,"_blank")},pinterest:function(t){if(t="http://www.pinterest.com/pin/create/button/?url="+encodeURIComponent(t),e.Main.xmlManager.getXml("ui")){var a=e.Main.xmlManager.getXml("ui").querySelector("element#pinterest_btn[template]");if(a){var n=a.querySelector("useract");n.hasAttribute("param")&&(t=n.getAttribute("param"))}}window.open(t,"_blank")},tumblr:function(t){if(t="http://www.tumblr.com/share/link?url="+encodeURIComponent(t),e.Main.xmlManager.getXml("ui")){var a=e.Main.xmlManager.getXml("ui").querySelector("element#tumblr_btn[template]");if(a){var n=a.querySelector("useract");n.hasAttribute("param")&&(t=n.getAttribute("param"))}}window.open(t,"_blank")},instagram:function(e){},vkontakte:function(e){}},H={home:function(){A.querySelector(".webpub-share__frame").addEventListener(e.Param.eventClick,a),A.querySelector(".webpub-share__publication").addEventListener(e.Param.eventClick,n),A.querySelector(".webpub-share__favorite").addEventListener(e.Param.eventStart,i),A.querySelector(".webpub-share__close").addEventListener(e.Param.eventClick,g),F=!1,D=!1},frame:function(){A.querySelector(".webpub-share__button-confirm").addEventListener(e.Param.eventClick,l),A.querySelector(".webpub-share__button-back").addEventListener(e.Param.eventClick,s);for(var t=A.querySelectorAll(".webpub-share__item"),a=t.length;a--;)t[a].addEventListener(e.Param.eventClick,u,!1),e.Main.shareManager.selectedThumb[t[a].getAttribute("data-page")]&&t[a].classList.add("webpub-share__checkbox--checked")},publication:function(){A.querySelector(".webpub-share__button-confirm").addEventListener(e.Param.eventClick,l),A.querySelector(".webpub-share__button-back").addEventListener(e.Param.eventClick,s);for(var t=A.querySelectorAll(".webpub-share__item"),a=t.length;a--;)t[a].addEventListener(e.Param.eventClick,c,!1);A.querySelector(".webpub-share__online-url").classList.add("webpub-share__checkbox--checked")},social:function(){for(var t in R)R[t]===!0&&A.querySelector(".webpub-share__social-icon-"+t).addEventListener(e.Param.eventClick,d.bind({},t));A.querySelector(".webpub-share__button-back").addEventListener(e.Param.eventClick,s),A.querySelector(".webpub-share__close").addEventListener(e.Param.eventClick,g)},confirm:function(){window.setTimeout(function(){B.close("shareManager")},2e3)}},X=function(){var t=function(){return new Promise(function(t){B?(B.setHTML(A.firstChild),t()):B=new e.Class.LightboxManagerNew({theme:"panel",html:A.firstChild,id:"shareManager",onclose:p,onload:t})})};return function(a){return N=a,e.Utils.empty(A),"favorite"===a&&(a="home"),e.Main.templateManager.loadAppend(e.Param.pathTemplate+"share"+e.Utils.capitalizeWord(a)+".html",A,{sharePanelTitle:S(e.Main.shareManager.sharePanelPath),confirmMessage:L(e.Main.shareManager.sharePanelPath),thumbnailUrlLeftInactive:!e.Main.shareManager.selectedThumb.left,thumbnailUrlRightInactive:!e.Main.shareManager.selectedThumb.right,thumbnailUrlLeft:e.Main.pageManager.getImage("ldpi",U[0]),thumbnailUrlRight:U[1]?e.Main.pageManager.getImage("ldpi",U[1]):!1,socials:x(),sendMethods:P()}).then(H[a]).then(t)}}(),W=function(){var t=!1,a="";return function(n){t!==n&&(a=e.Main.pageManager.getImage("mdpi",n),t=n,k.ogImage.setAttribute("content",a),k.twitterImage.setAttribute("content",a),k.ogUrl.setAttribute("content",location.href),k.twitterDescription.setAttribute("content","description: "+location.href))}}();this.init=I,this.open=h,this.close=g,this.toggle=m,this.shareSocial=t,this.onPageChange=f,this.favoriteThumbnailsShare=r,this.favoriteDownloadShare=o}}(webpublicationNamespace),function(e){function t(){this.modulo=0}t.prototype.getOddEven=function(){return e.Utils.impair(this.modulo++)?"odd":"even"},t.prototype.getTest=function(t,a,n){for(var i=t.childNodes,r={},o=i.length,s={level:n,items:[],textContent:"",itemClass:"",itemTextClass:"",gotopage:null,pageNumber:null},l=0;o>l;l++)r=i[l],r&&r.nodeType!==r.TEXT_NODE&&("text"===r.localName?(s.textContent=r.textContent,s.itemClass=this.getOddEven(),o>1&&(s.itemTextClass="summary-content__chapter"),a&&(s.gotopage=a,s.pageNumber=e.Utils.byOffsetIndex(a))):"it"===r.localName&&s.items.push(this.getTest(r,r.getAttribute("p"),n+1)));return s},t.prototype.show=function(){var t=function(t){t[0]&&t[0].addEventListener(e.Param.eventClick,function(t){var a=e.Utils.getClosestByClass(t.target,"summary-content__link"),n=a.getAttribute("data-page")||t.target.parentNode.getAttribute("data-page");n&&(e.API.pageLoad({number:n}),e.API.lightboxClose())})},a=e.Main.xmlManager.get("summary","xml");new e.Class.LightboxManagerNew({id:"summary-manager",menuButton:!1,theme:"page",animation:"none",subtemplate:{url:e.Param.pathTemplate+"summary.html",params:{pageList:this.getTest(a.childNodes[0],null,0).items}},onload:t}),e.Main.trackerManager.trackPage({name:"contents"})},e.Class.SummaryManager=t}(webpublicationNamespace),function(e){e.Class.TemplateOldManager=function(){var t=function(e,t,a){this.parent=e,this.listTpl=t,this.listTplResult={},this.callback=a,this.getList()},a=t.prototype;return a.getList=function(){var e=Object.keys(this.listTpl).length;this.getHttpRess(e)},a.getHttpRess=function(e){var t=this,a=null,n=null;return this.callback&&!e||1>e?(this.callback(),!1):(a=Object.keys(this.listTpl)[e-1],n=this.listTpl[a],$.get(n,function(n,i){return"success"==i&&(t.listTplResult[a]=n),t.getHttpRess(--e),!1},"html"),!1)},a.setTmplSync=function(e,t,a,n){var i="";if(t){"undefined"==typeof n&&(n={});for(var r in this.plugins)n[r+"Plugin"]=this.plugins[r];i=$.tmpl(t,n);for(var o in this.callbacks)this.callbacks[o](i)}return a&&a.call(e,i),i},a.plugins={button:function(t,a){return wrapper=document.createElement("div"),icon=document.createElement("div"),icon.className="svgicon "+a,arrow=document.createElement("div"),arrow.className="svgicon informations arrow",wrapper.appendChild(icon),wrapper.appendChild(document.createTextNode(e.Utils.prodTools.getWordLangueByIndex(t))),wrapper.appendChild(arrow),wrapper.outerHTML},icon:function(e,t){return icon=document.createElement("div"),icon.className="svgicon "+e,t&&icon.setAttribute("data-color",t),icon.outerHTML},i18n:function(t){return e.Utils.prodTools.getWordLangueByIndex(t)}},a.callbacks={icons:function(t){t.find(".svgicon").length>0&&t.find(".svgicon").each(function(){if(this.getAttribute("data-color")){var t=this.getAttribute("data-color").split(".");e.Utils.getTintedSvg("./publication/mobile/icons/map_icon.svg",webpublicationNamespace.Main.cssManager.getStyle(t[0],t[1]),$(this))}else 0===$(this).find("svg").length&&e.Utils.getTintedSvg("./publication/mobile/icons/map_icon.svg",webpublicationNamespace.Main.cssManager.getStyle("primary","contentColor"),$(this))})}},t}()}(webpublicationNamespace),function(e){e.Class.TrackStatManager=function(){function t(e){return"shareMail"===e?e="sendEmail":"pagePrev"===e?e="prevPage":"pageNext"===e?e="nextPage":"page"===e?e="gotoPage":"link"===e?e="linkClick":"videoPlay"===e?e="videoBegin":"zoom"===e&&(e="pageZoomIn"),e}var a=null,n={};n.WP=!1,n.GA=!0,n.Xiti=!1,n.events={shareMail:{callback:function(e){a.track("shareMail",["sendEmail"])}},zoomIn:{callback:function(e){a.track("zoomIn",["pageZoomIn"],["/zoom/page"+e.variables[1]])}},zoomOut:{callback:function(e){a.track("zoomOut",["pageZoomOut"],["/zoom/page"+e.variables[1]])}},contents:{callback:function(e){a.track("contents",["toggleActivate","panel_summary"],["/action/panel_summary"])}},"share-email":{callback:function(e){a.track("share-email",["toggleActivate","panel_email"],["/action/panel_email"])}},search:{callback:function(e){a.track("search",["toggleActivate","panel_search"],["/action/panel_search"])}},pagePrev:{callback:function(e){a.track("pagePrev",["prevPage"],["/page/page"+e.variables[1]])}},pageNext:{callback:function(e){a.track("pageNext",["nextPage"],["/page/page"+e.variables[1]])}},pageView:{callback:function(e){a.track("pageView",["gotoPage"],["/page/page"+e.variables[1]])}},zoom:{callback:function(e){a.track("zoom",["pageZoomIn"],["/zoom/page"+e.variables[1]])}},link:{callback:function(e){e.variables[2]=encodeURIComponent(e.variables[2]),a.track("link",["linkClick",e.variables[1],e.variables[2]],["/"+e.variables[1]+"/"+e.variables[2]])}},videoPlay:{callback:function(e){a.track("videoPlay",["videoBegin",e.variables[1]],["/videoBegin/"+e.variables[1]])}},videoPause:{callback:function(e){a.track("videoPause",["videoPause",e.variables[1]],["/videoPause/"+e.variables[1]])}},init:{}},n.events.pagePrev=n.events.prevPage,n.events.pageNext=n.events.nextPage,n.events.shareMail=n.events.sendEmail,n.events.page=n.events.gotoPage,n.events.link=n.events.linkClick,n.events.videoPlay=n.events.videoBegin,n.events.zoom=n.events.pageZoomIn;var i=5,r=0,o=[],s=function(e){a=this,this.parent=e,this.piwik.build(),this.GA.build(),this.registerTrackFunctions()},l=s.prototype;return l.piwik={trackerList:[],build:function(){var t=e.Main.xmlManager.getXml("statistics");if(null===t)return!1;for(var a,n,i,r={},o=t.querySelectorAll("Piwik"),s=o.length;s--;)a=o[s].getAttribute("url"),n=o[s].getAttribute("id"),a in r==!1&&(i=document.createElement("script"),i.type="text/javascript",i.src=a.replace(".php",".js"),r[a]=i,document.body.appendChild(i)),r[a].addEventListener("load",function(e,a){try{var n=Piwik.getTracker(e,a);n.trackPageView(),n.enableLinkTracking(),this.trackerList.push(n)}catch(i){}var r=Array.prototype.slice.call(t.querySelectorAll("Event"));for(var o in r)l.piwik.addTrackingListener(r[o].getAttribute("name"))}.bind(l.piwik,a,n))},addTrackingListener:function(e){n.events[e]&&("toggleActivate"===e?(n.events.contents.piwikActivate=!0,n.events["share-email"].piwikActivate=!0,n.events.search.piwikActivate=!0):n.events[e].piwikActivate=!0)},track:function(){var e=Array.prototype.slice.call(arguments),t=e.splice(0,1),a="",n=this.piwik.trackerList.length;-1!==t.indexOf(",")&&(a=t.substring(t.indexOf(",")+1,t.length),t=t.substring(0,t.indexOf(",")));var i="Events/"+document.title+"/"+t;for(""!==a&&(i+="/"+a),e.length>0&&(i+="/"+e.join("/"));n--;)this.piwik.trackerList[n].trackPageView(i)}},l.GA={build:function(){var e="https:"==document.location.protocol?"https://ssl.":"http://www.",t=document.createElement("script");t.src=e+"google-analytics.com/ga.js",t.type="text/javascript",t.async=!0,document.head.appendChild(t)},track:function(t,n,o){if("undefined"==typeof n&&(n=e.Main.xmlManager.get("config","GAStatsId")),"undefined"==typeof o&&(o=e.Main.xmlManager.get("config","GAStatsLabel")),"undefined"==typeof _gat&&i>=r)return setTimeout(function(){r++,a.GA.track(page,n,o)},2e3),!1;if("undefined"==typeof _gat)return!1;var s=_gat._getTracker(n),l="/"+e.Main.x_y_z_Manager.urlVarId;if(t instanceof Array)for(var u=0;u<t.length;u++)s._trackPageview(o+l+t[u]);else s._trackPageview(o+l+t);return!1}},l.track=function(){var e=null,t=null,a=null,n=function(n){n(e,t,a)};return function(i,r,s){e=i,t=r,a=s,o.forEach(n)}}(),l.registerTrackFunctions=function(){e.Starter._CONFIG.trackStatInfo.piwikTrack&&o.push(function(e,t,i){return n.events[e].piwikCallback?(n.events[e].piwikCallback(t),!1):void(t&&n.events[e].piwikActivate===!0&&a.piwik.track.apply(a,t))}),e.Main.xmlManager.get("config","GAStatsEnabled")&&o.push(function(e,t,i){return n.events[e].gaCallback?(n.events[e].gaCallback(i),!1):void(i&&a.GA.track(i))})},l.trackPage=function(e){if("undefined"!=typeof e.name){var a=t(e.name);a in n.events&&n.events[a].callback(e)}},l.trackEvent=function(e){if("undefined"!=typeof e.name){var a=t(e.name);a in n.events&&n.events[a].callback(e)}},s}()}(webpublicationNamespace),function(e){Math.abs=function(e){return 0>e?-e:e},Math.floor=function(e){return e>>0},Math.trunc=Math.trunc||function(e){return 0>e?Math.ceil(e):Math.floor(e)},Math.parseIntToRoman=function(){var e=["I","V","X","L","C","D","M"],t=function(t,a){var n,i="",r=2*t;if(t>2)for(n=0;n<a*Math.pow(10,t-3);n++)i+="M";else if(4>a)for(n=0;a>n;n++)i+=e[r];else if(4==a)i=e[r]+e[r+1];else if(9>a)for(i=e[r+1],n=0;a-5>n;n++)i+=e[r];else 9==a&&(i=e[r]+e[r+2]);return i};return function(e){var a,n="";e=parseInt(e,10).toString();for(var i=0,r=e.length;r>i;i++){var o=parseInt(e.charAt(r-(i+1)));a=n,n=t(i,o)+a}return n}}(),Math.parseRomanToInt=function(){var e=null,t=/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/,a=/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,n={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},i=0;return function(r){if(i=0,r=r.toUpperCase(),!r||!t.test(r))return!1;for(;e=a.exec(r);)i+=n[e[0]];return i}}(),e.Utils.addParamsToUrl=function(e,t){if(""===t)return e;var a,n="";e.indexOf("#")>=0&&(n=e.substr(e.indexOf("#"),e.length),e=e.substr(0,e.indexOf("#"))),a=-1===e.indexOf("?")?e+"?"+t:e+"&"+t;var i=a.split("?")[1],r={};i.split("&").forEach(function(e){r[e.split("=")[0]]=e.split("=")[1]}),a=a.split("?")[0];for(var o in r)a=a+(-1===a.indexOf("?")?"?":"&")+o+"="+r[o];return a+n},e.Utils.createUrlForPages=function(t){var a;if(clientId=t&&t.clientId?t.clientId:e.Main.xmlManager.getVariable("client_id"),genId=t&&t.genId?t.genId:e.Main.xmlManager.getVariable("id"),page=t&&t.page?"page="+t.page:"",e.Param.isLocalReader){var n=e.Main.xmlManager.getVariable("asp_url")+"/";a=n+clientId+"/"+genId+"/",e.Main.urlManager.get("version")&&(a=e.Utils.addParamsToUrl(a,"version="+e.Main.urlManager.get("version"))),a=a+"#"+page}else a=location.href,a=a.replace(/page=\d+/g,page);return a},e.Utils.getBestSreenSize=function(){var t=null;return function(){return t?t:t=window.screen.width>window.screen.height?window.screen.width/e.Starter.defaultViewportScale:window.screen.height/e.Starter.defaultViewportScale}}(),e.Utils.getLocalSize="android"==e.Param.userAgent.os.name?e.Utils.getBestSreenSize:function(){return e.Starter._CONFIG.getDocument[e.Starter._CONFIG.pages.width_or_height]},e.Utils.getFileExtension=function(e){var t=e.split("?").shift().split("#").shift().split(".").pop();return t},e.Utils.getFileFormat=function(t){return"undefined"!=typeof e.Starter._CONFIG.typeFileByExtention[t]?e.Starter._CONFIG.typeFileByExtention[t]:""},e.Utils.getFilenameWithoutExtension=function(e){var t=e.split(".");return t.pop(),t.join(".")},e.Utils.setBestSizeCVS=function(t,a){return(t[a].height!=e.Utils.getBestSreenSize()||t[a].width!=e.Utils.getBestSreenSize())&&(t[a].height=e.Utils.getBestSreenSize(),t[a].width=e.Utils.getBestSreenSize()),!1},e.Utils.componentTemplates={},e.Utils.getTemplate=function(t,a){var n=".html",i="";"component"===t?i="publication/mobile/template/component/":(i="publication/mobile/tmpl/","page"===t?i+="page/":a=t);var r=e.Utils.getFunctionName(this.constructor),o=r.replace("Manager","").toLowerCase();"string"==typeof a&&(o=a,a=void 0),"undefined"==typeof a&&"undefined"!=typeof this.config&&(a=this.config.templateList),"undefined"==typeof a?a={main:i+o+n}:"undefined"==typeof a.main&&(a.main=i+o+n);var s=e.Utils.componentTemplates[o];return"component"===t&&s&&s.tablet&&(a.tablet=s.tablet),"component"===t&&s&&s.phone&&(a.phone=s.phone),"component"===t&&s&&s.desktop&&(a.desktop=s.desktop),"undefined"!=typeof a.phone&&e.Param.isPhone===!0?a.phone:"undefined"!=typeof a.tablet&&e.Param.isTablet===!0?a.tablet:"undefined"!=typeof a.desktop&&e.Param.isUnknown===!0?a.desktop:a.main},e.Utils.GetSwiffyObject=function(){var t="js/swiffy_runtime";return null!==e.Main.startupManager.get("vendor.swiffy")&&(t+="_"+e.Main.startupManager.get("vendor.swiffy").replace(".","_")),function(a){return e.require([t]).then(function(){var t=document.createElement("div");t.classList.add("animation_for_swiffy"),t.id="webpub-swiffy__"+a.url.match(/\/([a-zA-Z0-9]+).json/)[1];var n={swiffyObject:null,swiffyWrapper:t,id:t.id},i=e.Starter._CONFIG.pagesOnInit.width*a.cumulIndex+a.x,r=a.y;t.style.height=2*a.height+"px",t.style.width=2*a.width+"px",e.Utils.styleTransformOrigin(t,"0 0"),e.Utils.styleTransform(t,"translate3d("+i+"px,"+r+"px,0) scale(0.5)");var o=new XMLHttpRequest;return o.open("GET",a.url,!0),o.onreadystatechange=function(e){if(2===o.readyState&&200!==o.status&&0!==o.status)o.abort(),t.parentNode.removeChild(t);else if(4===o.readyState&&o.responseText){var a=new RegExp("swiffyobject\\s*\\=\\s*([\\s\\S]*?\\})\\;$","gmi"),i=a.exec(o.responseText),r=JSON.parse(null===i?o.responseText:i[1]);n.swiffyObject=new swiffy.Stage(t,r),n.swiffyObject.setBackground(null),n.swiffyObject.start()}},o.send(),t.swiffyElement=n,Promise.resolve(n)})}}(),e.Utils.GetSwiffyPromise=function(){var t="js/swiffy_runtime";return null!==e.Main.startupManager.get("vendor.swiffy")&&(t+="_"+e.Main.startupManager.get("vendor.swiffy").replace(".","_")),function(a){return e.require([t]).then(function(){return new Promise(function(e,t){var n=a.file.url.match(/\/([a-zA-Z0-9]+).json/),i=document.createElement("div");i.classList.add("animation_for_swiffy"),i.classList.add("webpub-viewer__link-"+a.id),i.id="webpub-swiffy__"+(n?n[1]:"0"),i.coords={x:a.x,y:a.y,w:a.width,h:a.height,foreground:a.foreground},i.autoPlay=!1,i.swiffyElement={swiffyObject:null,swiffyWrapper:i,id:i.id};var r=new XMLHttpRequest;r.open("GET",a.file.url,!0),r.onreadystatechange=function(){if(2===this.readyState&&200!==this.status&&0!==this.status)i.parentNode&&i.parentNode.removeChild(i),this.abort(),e(!1);else if(4===this.readyState&&this.responseText){var t=new RegExp("swiffyobject\\s*\\=\\s*([\\s\\S]*?\\})\\;$","gmi"),a=t.exec(this.responseText),n=JSON.parse(null===a?this.responseText:a[1]);i.swiffyElement.swiffyObject=new swiffy.Stage(i,n),i.swiffyElement.swiffyObject.setBackground(null),e(i)}},r.send()})})}}(),e.Utils.getImageObject=function(t,a,n){var i=new Image;return a&&a(i),i.onload=function(){this&&n&&(this.width>e.Starter._CONFIG.getDocument.width||this.height>e.Starter._CONFIG.getDocument.height?(n.style.width="100%",n.style.height="100%"):(n.style.width=this.width+"px",n.style.height=this.height+"px"),n.style.backgroundImage="url("+this.src+")")},i.src=t,i},e.Utils.addVideoStats=function(t){t.addEventListener("play",function(t){e.Main.trackerManager.trackEvent({name:"videoPlay",variables:{1:Math.round(t.target.currentTime)}})}),t.addEventListener("pause",function(t){t.target.currentTime!==t.target.duration&&e.Main.trackerManager.trackEvent({name:"videoPause",variables:{1:Math.round(t.target.currentTime)}})}),t.addEventListener("ended",function(t){e.Main.trackerManager.trackEvent({name:"videoEnd"})})},e.Utils.getVideoObject=function(t,a){var n=(e.Utils.uniqueId(),null),i=document.createElement("video"),r=e.Starter._CONFIG.pagesOnInit.width*t.cumulIndex,o=e.Utils.getFilenameWithoutExtension(t.url),s=t.currScale||1;for(i.width=t.width*s,i.height=t.height*s,vdl=e.Starter._CONFIG.VideoTypeSupported.length;vdl--;)n=document.createElement("source"),i.url=o+"."+e.Starter._CONFIG.VideoExtSupported[vdl],n.src=i.url,i.appendChild(n);a&&i.setAttribute("controls",!0),e.Utils.addVideoStats(i);var l;return"android"===e.Param.userAgent.os.name&&"Chrome"!==e.Param.userAgent.browser.name?(l=document.createElement("div"),l.appendChild(i)):l=i,l.style.cssText="visibility:hidden;",setTimeout(function(){l.style.mozTransformOrigin="0 0",l.style.msTransformOrigin="0 0",l.style.webkitTransformOrigin="0 0",l.style.transformOrigin="0 0",l.style.height=t.height*s+"px",l.style.width=t.width*s+"px",e.Utils.styleTransform(l,"translate("+(t.x+r)+"px, "+t.y+"px) scale("+1/s+", "+1/s+")"),window.setTimeout(function(){l.style.visibility=""},16)},200),l},e.Utils.getVideoObjectByExt=function(t,a,n){var i=(e.Utils.uniqueId(),window.document.createElement("video"));return src1=window.document.createElement("source"),src1.src=t,i.appendChild(src1),i.url=t,i.style.height="100%",i.style.width="100%",i.setAttribute("controls",!0),e.Utils.addVideoStats(i),i.addEventListener("loadedmetadata",function(e){n&&(i.style.width=this.videoWidth+"px",i.style.height=this.videoHeight+"px")},!1),a&&a(i),i},e.Utils.getAudioTag=function(){var t=null,a=null,n=null,i=null;return function(r,o,s,l,u,c,d){return-1==r.indexOf("http")&&e.Starter._CONFIG.appInfo&&e.Starter._CONFIG.appInfo.os&&(r=e.Starter._CONFIG.aspUrlRootIndex+r),t="",(l||""!=l)&&(t+="width:"+l+";"),(d||""!=d)&&(t+=d),""!=t&&(t="style = '"+t+"'"),a=e.Utils.getFilenameWithoutExtension(o)+".",n=(new Date).getTime(),i="<audio id='"+s+"' src='"+r+a+"mp3?idaudio="+n+"#"+n+"' class='audio' "+t+" autobuffer='true' "+c+" >",i+="</audio>"}}(),e.Utils.getAudioCustomTag=function(){var t=null,a=null,n=null,i=null;return function(r,o,s,l){return i=""===e.Starter._CONFIG.aspUrlRootIndex?window.location.protocol+"//"+(window.location.host+""+window.location.pathname):e.Starter._CONFIG.aspUrlRootIndex,-1==r.indexOf("http")&&e.Starter._CONFIG.appInfo&&e.Starter._CONFIG.appInfo.os&&(r=i+r),t="",l===!1&&(t='style = "display: none"'),a=e.Utils.getFilenameWithoutExtension(o)+".",n=(new Date).getTime(),e.Main.templateOldManager.setTmplSync(this,e.Main.templateOldManager.listTplResult.audio,function(e){template=e},{id:"audio-"+s,src:r+a+"mp3",globalStyle:t,data:this,getTitle:!0}),template.one(e.Param.eventClick,".audio-player-button",function(){e.Utils.getAudioCustomDOMElement(s,this)}),template}}(),e.Utils.getAudioCustomDOMElement=function(){var t=null,a=function(){var e=null,t=null;return function(a){return e=~~(a/60),t=~~(a%60),10>e&&(e=["0",e].join("")),10>t&&(t=["0",t].join("")),[e,":",t].join("")}}(),n=function(){this.audioPlayerButton.className="audio-player-button"},i=function(){this.audioPlayerButton.className="audio-player-button audio-player-pause"},r=function(){this.audioPlayerTotal.innerText=a(this.duration)},o=function(){var e=null;return function(){"undefined"!=typeof this.audioPlayerProgressValue&&(e=~~(100*(this.currentTime/this.duration)),this.audioPlayerElapsed.innerText=a(this.currentTime),this.audioPlayerProgressValue.style.width=e+"%")}}(),s=function(){this.addEventListener("timeupdate",o)},l=function(e){scale=((e.pageX||e.changedTouches[0].pageX)-this.getBoundingClientRect().left)/this.offsetWidth,this.audioDOMElement.currentTime=this.audioDOMElement.duration*scale};return function(a,o){t=o.parentNode;var u=document.createElement("audio");u.id=a,u.src=o.getAttribute("data-src"),u.className="audio-player-domelement",u.addEventListener("play",n),u.addEventListener("pause",i),u.addEventListener("durationchange",r),u.addEventListener("loadedmetadata",s),u.audioPlayerButton=o,u.audioPlayerElapsed=t.getElementsByClassName("audio-player-elapsed")[0],u.audioPlayerProgress=t.getElementsByClassName("audio-player-progress")[0],u.audioPlayerProgressContainer=t.getElementsByClassName("audio-player-progress-container")[0],u.audioPlayerProgressValue=t.getElementsByClassName("audio-player-progress-value")[0],u.audioPlayerTotal=t.getElementsByClassName("audio-player-total")[0],o.audioDOMElement=u,u.audioPlayerProgressContainer.audioDOMElement=u,u.audioPlayerProgressContainer.addEventListener(e.Param.eventStop,l),o.addEventListener(e.Param.eventClick,function(){this.audioDOMElement.paused?this.audioDOMElement.play():this.audioDOMElement.pause()}),o.parentNode.appendChild(u),e.Main.eventEmul.callEvent("audioBegin",o.getAttribute("data-src")),u.play()}}(),e.Utils.getLinkType=function(){var t=null,a=null,n=null;return function(i){return t=null,a=e.Starter._CONFIG.LinkInfos.Types.LinkTypeNone,0===i.url.length?a=e.Starter._CONFIG.LinkInfos.Types.LinkTypeNone:0===i.url.indexOf("lightbox:")?(t=i.url.replace("lightbox:",""),i.url=t,a=e.Starter._CONFIG.LinkInfos.Types.LinkTypeLightbox):0===i.url.indexOf("anim:")?a=e.Starter._CONFIG.LinkInfos.Types.LinkTypeAnimation:"swf_fiche"==i.target||"swf_video"==i.target?(n=e.Utils.getFileExtension(i.url),"object"==typeof n&&"undefined"!=typeof n[0]?n=n[0].toLowerCase():"undefined"!=typeof n&&(n=n.toLowerCase()),"jpg"==n||"png"==n?a="swf_fiche"==i.target?e.Starter._CONFIG.LinkInfos.Types.LinkTypeImageFiche:e.Starter._CONFIG.LinkInfos.Types.LinkTypeImageIncruster:"swf"==n?a=i.activeHtmlAnim?e.Starter._CONFIG.LinkInfos.Types.LinkTypeAnimation:e.Starter._CONFIG.LinkInfos.Types.LinkTypeNone:"flv"==n||"m4v"==n||"mp4"==n?a="swf_fiche"==i.target?e.Starter._CONFIG.LinkInfos.Types.LinkTypeVideoFiche:e.Starter._CONFIG.LinkInfos.Types.LinkTypeVideoIncruster:i.url.match(/youtube/g)&&(a="swf_fiche"==i.target?e.Starter._CONFIG.LinkInfos.Types.LinkTypeVideoFiche:e.Starter._CONFIG.LinkInfos.Types.LinkTypeVideoIncruster)):"mp3_sound"==i.target?a=e.Starter._CONFIG.LinkInfos.Types.LinkTypeAudioFiche:"gallery_HD"==i.target?a=e.Starter._CONFIG.LinkInfos.Types.LinkTypeGaleriePhoto:"gallery_video"==i.target?a=e.Starter._CONFIG.LinkInfos.Types.LinkTypeGalerieVideo:"_blank"==i.target?0===i.url.indexOf("http")?a=e.Starter._CONFIG.LinkInfos.Types.LinkTypeWeb:0===i.url.indexOf("tel:")&&(a=e.Starter._CONFIG.LinkInfos.Types.LinkTypePhone):"_self"==i.target?0===i.url.indexOf("mailto:")&&(a=e.Starter._CONFIG.LinkInfos.Types.LinkTypeMail):0===i.target.length?0===i.url.indexOf("page:")&&(t=i.url.replace("page:",""),i.url=t,a=e.Starter._CONFIG.LinkInfos.Types.LinkTypeGotoPage):"_blank"==i.target&&(a=e.Starter._CONFIG.LinkInfos.Types.LinkTypeWeb),a}}(),e.Utils.impair=function(e){return 1&e},e.Utils.clone=function(t){if("object"!=typeof t||null==t)return t;var a=t.constructor(),n=null;for(n in t)a[n]=e.Utils.clone(t[n]);return a},e.Utils.getMaskOfSvg=function(){var e=null,t=null,a=null;return function(n,i,r){return n.btn_image?($.ajax({type:"GET",url:n.btn_image,dataType:"xml",success:function(o){if("string"==typeof o&&(o=(new DOMParser).parseFromString(o,"application/xml")),e=o.getElementsByTagName("svg")[0],n["background-color"])for(t=e.getElementsByTagName("*"),a=t.length;--a>=0;)"string"!=typeof t[a].getAttribute("stroke")?t[a].setAttribute("fill",n["background-color"]):t[a].setAttribute("stroke",n["background-color"]);r&&(e.id=r),i[0].appendChild(e)}}),!1):!1}}(),e.Utils.getTintedSvg=function(){var e={},t=null,a=null,n=function(n,i,r){if(i)for(n=e[n].cloneNode(!0),t=n.getElementsByTagName("*"),a=t.length;--a>=0;)"string"!=typeof t[a].getAttribute("stroke")?t[a].setAttribute("fill",i):t[a].setAttribute("stroke",i);r[0].appendChild(n)};return function(t,a,i){if(!t)return!1;if("undefined"==typeof e[t]){var r=new XMLHttpRequest;r.open("GET",t,!1),r.onreadystatechange=function(o){4==r.readyState&&(e[t]=r.responseXML.getElementsByTagName("svg")[0],n(t,a,i))},r.send()}else n(t,a,i);return!1}}(),e.Utils.preventDefault=function(){return function(e){return"object"!=typeof e?!1:("undefined"!=typeof e.stopPropagation&&e.stopPropagation(),"undefined"!=typeof e.cancelBubble&&(e.cancelBubble=!0),"undefined"!=typeof e.preventDefault&&e.preventDefault(),!1)}}(),e.Utils.byPageIfDouble=function(){var t=null,a=null,n=null,i=null,r=null,o={};return function(s,l){return t!==e.Starter._CONFIG.pages.doublePage&&(t=e.Starter._CONFIG.pages.doublePage,o=null,o={}),o[s]?o[s]:(a=0,n=0,i=0,r=e.Main.xmlManager.get("common-configuration","config","pageCount"),(t||l)&&(1===s?(a=1,n=0,i=0):s!==r||e.Utils.impair(r)?e.Utils.impair(s)?e.Utils.impair(s)&&(a=0,n=1,i=1):(a=1,n=0,i=1):(a=0,n=1,i=0)),o[s]={isDoubleDoc:t,isDoublePage:{1:a,2:n},isDouble:i},o[s])}}(),e.Utils.uniqueId=function(){var e=0;return function(){return e++,(new Date).getTime()+"_"+e}}(),e.Utils.byOffsetIndex=function(){var t=null,a=e.Main.xmlManager.get("common-configuration","config","shift");return function(e,n){return n?(t=~~e,e=t||0===t?t+a:Math.parseRomanToInt(e)):(a>=e?e=Math.parseIntToRoman(e):e-=a,e)}}(),e.Utils.isOffsetIndex=function(){var t=e.Main.xmlManager.get("common-configuration","config","shift");return function(e){return 0>=e-t}}(),e.Utils.hex16=function(e){return 8==e.length&&(e=e.substr(2,8)),e},e.Utils.getRadiant=function(){var e=null,t=null,a=null,n=null;return function(i,r,o,s,l,u){for(e=50,u&&(e=u),t=r.split(","),a=0;a<t.length;a++)t[a]=~~(~~t[a]+e),t[a]>255&&(t[a]=255);return n="",n+="background: rgb("+r+");",n+="background: -moz-linear-gradient(-45deg,  rgba("+t+","+l+") 0%, rgba("+r+","+s+") 50%);",n+="background: -webkit-gradient(linear, left top, right bottom, color-stop(0%,rgba("+r+",1)), color-stop(50%,rgba("+r+","+s+")));",n+="background: -webkit-linear-gradient(-45deg,  rgba("+t+","+l+") 0%,rgba("+r+","+s+") 50%);",n+="background: -o-linear-gradient(-45deg,  rgba("+t+","+l+") 0%,rgba("+r+","+s+") 50%);",n+="background: -ms-linear-gradient(-45deg,  rgba("+t+","+l+") 0%,rgba("+r+","+s+") 50%);",n+="background: linear-gradient(135deg,  rgba("+t+","+l+") 0%,rgba("+r+","+s+") 50%);",n+="filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='"+o+","+s+"',GradientType=1 );"}}(),e.Utils.mailValid=function(){var t=document.createElement("input");return t.type="email",t.required=!0,function(a){return t.value=a,t.checkValidity()&&e.Utils.regexEmail.test(a)}}(),e.Utils.isMaster=function(){return e.Starter.isMaster},e.Utils.stringtoXML=function(){var e=null;return function(t){return DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)),e}}(),e.Utils.getBase64Image=function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var a=t.getContext("2d");return a.drawImage(e,0,0),t.toDataURL("image/png")},e.Utils.addVendorEventListener=function(e,t){for(var a=["","webkit","moz"],n=0;n<a.length;n++)if("on"+a[n]+e in document.documentElement){document.addEventListener(a[n]+e,t);break}},e.Utils.styleBorderRadius=function(){return"borderRadius"in document.body.style?function(e,t){e.style.borderRadius=t}:"webkitBorderRadius"in document.body.style?function(e,t){e.style.webkitBorderRadius=t;

}:"mozBorderRadius"in document.body.style?function(e,t){e.style.mozBorderRadius=t}:function(){}}(),e.Utils.styleTransform=function(){return"transform"in document.body.style?function(e,t){e.style.transform=t}:"webkitTransform"in document.body.style?function(e,t){e.style.webkitTransform=t}:"msTransform"in document.body.style?function(e,t){e.style.msTransform=t}:function(){}}(),e.Utils.styleTransformOrigin=function(){return"transformOrigin"in document.body.style?function(e,t){e.style.transformOrigin=t}:"webkitTransformOrigin"in document.body.style?function(e,t){e.style.webkitTransformOrigin=t}:"msTransformOrigin"in document.body.style?function(e,t){e.style.msTransformOrigin=t}:function(){}}(),e.Utils.styleTransition=function(){return"transition"in document.body.style?function(e,t){e.style.transition=t}:"webkitTransition"in document.body.style?function(e,t){e.style.webkitTransition=t}:"msTransition"in document.body.style?function(e,t){e.style.msTransition=t}:function(){}}(),e.Utils.styleTransitionTransform=function(){return"transform"in document.body.style?function(t,a,n){e.Utils.styleTransition(t,"transform "+a+"s "+n)}:"webkitTransform"in document.body.style?function(t,a,n){e.Utils.styleTransition(t,"-webkit-transform "+a+"s "+n)}:"msTransform"in document.body.style?function(t,a,n){e.Utils.styleTransition(t,"-ms-transform "+a+"s "+n)}:function(){}}(),e.Utils.resetDomTransform=function(t){e.Utils.styleTransformOrigin(t,"50% 50%"),e.Utils.styleTransform(t,"none")},e.Utils.scaleDom=function(t,a,n,i){e.Utils.styleTransformOrigin(t,n+("number"==typeof n?"px":"")+" "+i+("number"==typeof i?"px":"")),e.Utils.styleTransform(t,"scale("+a+", "+a+")")},e.Utils.scaleDom3d=function(t,a,n,i){e.Utils.styleTransformOrigin(t,n+("number"==typeof n?"px":"")+" "+i+("number"==typeof i?"px":"")),e.Utils.styleTransform(t,"scale3d("+a+", "+a+", 1)")},e.Utils.translateScaleDom3d=function(t,a,n,i,r,o){e.Utils.styleTransformOrigin(t,r+("number"==typeof r?"px":"")+" "+o+("number"==typeof o?"px":"")),e.Utils.styleTransform(t,"scale3d("+i+", "+i+", 1) translate3d("+a+"px, "+n+"px, 0px)")},e.Utils.matrixDom3dAsync=function(){var t=function(){this.ePubData.optimizeQualityStat!==!0&&(this.ePubData.optimizeQualityStat=!0,e.Utils.styleTransform(this,"matrix("+this.ePubData.scale+",0,0,"+this.ePubData.scale+","+this.ePubData.x+","+this.ePubData.y+")"))};return function(a,n,i,r){n=~~(1e4*n)/1e4,i=~~(1e4*i)/1e4,r=~~(1e4*r)/1e4,(a.ePubData.scale!==n||a.ePubData.x!==i||a.ePubData.y!==r||a.ePubData.optimizeQualityStat!==!0)&&(a.ePubData.scale=n,a.ePubData.x=i,a.ePubData.y=r,a.ePubData.timer=a.ePubData.timer||null,a.ePubData.matrix2d=a.ePubData.matrix2d||t.bind(a),e.Utils.styleTransform(a,"matrix3d("+n+",0,0,0,0,"+n+",0,0,0,0,1,0,"+i+","+r+",0,1)"),a.ePubData.optimizeQualityStat=!1,clearTimeout(a.ePubData.timer),a.ePubData.optimizeQuality===!0&&(a.ePubData.timer=setTimeout(a.ePubData.matrix2d,300)))}}(),e.Utils.eventPreventDefault=function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},e.Utils.preventOverScroll=function(){function e(e){0===e.scrollTop?e.scrollTop++:e.scrollTop===e.scrollHeight-e.clientHeight&&e.scrollTop--}return function(t){t.setAttribute("touch-action","auto"),t.addEventListener("touchstart",function(a){for(var n=a.target;n!==t;)e(n),n=n.parentNode;e(t)})}}(),e.Utils.forceReflow=function(e){e.style.display="none",e.style.display="block"},e.Utils.cubicBezier=function(e,t,a,n,i){return Math.pow(1-i,3)*e+3*Math.pow(1-i,2)*i*t+3*(1-i)*Math.pow(i,2)*a+Math.pow(i,3)*n},e.Utils.getFunctionName=function(e){var t="function"==typeof e,a=t&&(e.name&&["",e.name]||e.toString().match(/function ([^\(]+)/));return!t&&"not a function"||a&&a[1]||"anonymous"},e.Utils.promiseTimeout=function(e,t){return 0===e?t:new Promise(function(a,n){setTimeout(function(){a(t)},e)})},e.Utils.getSegmentLength=function(e,t,a,n){return Math.abs(Math.sqrt(Math.pow(e-a,2)+Math.pow(t-n,2)))},e.Utils.createSvgIcon=function(t,a,n){var i=document.createElement("div");return i.className="svgicon svgicon-"+t+" "+a,e.Utils.svgIcon(i,{icon:t,color:n||null}),i},e.Utils.svgIcon=function(t,a){if(a.color=a.color||null,a.icon=a.icon||null,"svg"!==t.tagName){var n=t.querySelector("svg");null===n&&(n=document.createElement("svg"),t.appendChild(n)),t=n}if(null!==a.color&&a.color.indexOf(".")>0&&(a.color=a.color.split("."),a.color=e.Main.cssManager.getStyle(a.color[0],a.color[1])),null!==a.icon){if(t.firstChild)t.firstChild.setAttribute("xlink:href","#svgicon-"+a.icon);else{var i='xmlns:xlink="http://www.w3.org/1999/xlink"',r='xlink:href="#svgicon-'+a.icon+'"';t.innerHTML="<use "+i+" "+r+"></use>"}t.setAttribute("data-icon",a.icon)}null!==a.color&&(t.style.fill=a.color,t.setAttribute("data-color",a.color))},e.Utils.empty=function(e){if(e){for(var t=e.querySelectorAll("video"),a=0;a<t.length;a++)t[a].pause(),t[a].parentNode.removeChild(t[a]);e.textContent="",e.innerHTML=""}},e.Utils.fadeIn=function(){var e=function(){this.classList.remove("opacity-zero")};return function(t){t&&(t.classList.remove("display-none"),requestAnimationFrame(e.bind(t)))}}(),e.Utils.fadeOut=function(){var e=function(){this.classList.add("display-none")};return function(t){if(t){var a=window.getComputedStyle(t),n=1e3*parseFloat(a.getPropertyValue("transition-duration"));"opacity"===a.getPropertyValue("transition-property")&&n>0&&(t.classList.add("opacity-zero"),setTimeout(e.bind(t),n)),a=null}}}(),e.Utils.getVisiblePages=function(){return e.Param.newViewerVersion?function(){return e.Main.viewerManager.getCurrentPages()}:function(){return e.Main.pagesLoader.getPagesOfFrame(e.Main.pagesLoader.getFrameOfPage(e.Main.pageManager.getCurrent()))}}(),e.Utils.capitalizeWord=function(e){return e[0].toUpperCase()+e.substr(1,e.length).toLowerCase()},e.Utils.regexEmail=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,e.Utils.mailStringToArray=function(t){for(var a=t.split(/[,;\s]+(?=(?:[^"]*"[^"]*")*[^"]*$)/g),n=[],i=0;i<a.length;i++)e.Utils.mailValid(a[i])&&n.push(a[i]);return n},e.Utils.hideShowRemove=function(e,t,a,n){setTimeout(function(){e.classList.add(t),setTimeout(function(){e.classList.remove(t),setTimeout(function(){e.parentNode.removeChild(e)},n)},a)},16)},e.Utils.toast=function(t){var a=function(n){var i=document.querySelector(".webpub-toast--active");i?window.setTimeout(function(){a(n)},1e3):e.Utils.hideShowRemove(n,"webpub-toast--active",t.duration,1e3)},n=document.createElement("div");n.classList.add("webpub-toast");for(var i=t.className?t.className.split(" "):[],r=0;r<i.length;r++)n.classList.add(i[r]);"undefined"!=typeof t.html?(n.classList.add("webpub-toast__position--"+t.position),n.classList.add("webpub-toast__position"),"string"==typeof t.html?n.innerHTML=t.html:n.appendChild(t.html)):n.innerText=t.text,"error"===t.type&&n.classList.add("webpub-toast--error"),document.body.appendChild(n),a(n)},e.Utils.serialize=function(e){var t="";for(var a in e)t+=t?"&":"",t+=a+"="+encodeURIComponent(e[a]);return t}}(webpublicationNamespace),function(e){e.Param.zoom=!1,e.Class.ViewerManager=function(){function t(e){var t=[],a=0;if(e<=i()&&e>=0)for(var n=1;n<=dt.pagesInFrame;n++)a=e*dt.pagesInFrame+n-Ce,a<=dt.pagesQuantity&&a>0&&t.push(a);return t}function a(e){return me.floor((e+Ce-1)/dt.pagesInFrame)}function n(e){return a(e)-we}function i(){return me.ceil((dt.pagesQuantity+Ce)/dt.pagesInFrame)-1}function r(t,a,n,i){var r=Ae(me.abs((t+n)/2),2),o=Ae(me.abs((a+i)/2),2);et=r,tt=o,ut===!1?ut=r:ut+=(r-ut)/ot,ct===!1?ct=o:ct+=(o-ct)/ot,at=e.Utils.getSegmentLength(t,a,n,i),qe=Xe=0,rt&&k("out")}function o(t,a){Ke=Oe=!0,Be=t-qe,Ge=Be-De,De=Be,Fe=me.min(De,Fe),Ue=me.max(De,Ue),(me.abs(Be)>dt.minPxToDrag||Fe<-dt.minPxToDrag||Ue>dt.minPxToDrag)&&(dt.links&&e.Main.linksManagerNew.addFixSwiffyAnims(),e.Utils.styleTransform(be,"translate3d("+De+"px, 0px, 0px)"),Je&&clearTimeout(Je),Je=!1),Oe=!1}function s(t,a){Ke=Oe=!0,We=a-Xe,He=We-Ve,Ve=We,Re=me.min(Ve,Re),ze=me.max(Ve,ze),(me.abs(We)>dt.minPxToDrag||Re<-dt.minPxToDrag||ze>dt.minPxToDrag)&&(dt.links&&e.Main.linksManagerNew.addFixSwiffyAnims(),e.Utils.styleTransform(be,"translate3d(0px, "+Ve+"px, 0px)"),Je&&clearTimeout(Je),Je=!1),Oe=!1}function l(t,a){Ke=Oe=!0,(me.abs(t-qe)>dt.minPxToDrag||me.abs(a-Xe)>dt.minPxToDrag)&&(st=Ae(me.min(me.max(ut-(t-qe)/(ot-1),0),pe),2),lt=Ae(me.min(me.max(ct-(a-Xe)/(ot-1),0),ge),2),dt.verticalSlider?e.Utils.scaleDom3d(be,ot,st,lt+ge*dt.deltaFrameInDOM):e.Utils.scaleDom3d(be,ot,st+pe*dt.deltaFrameInDOM,lt),Je&&clearTimeout(Je),Je=!1),Oe=!1}function u(t){return dt.links&&e.Main.pageManager.hasLinks(t)?e.Main.linksManagerNew.preloadAnimPromise(t):!0}function c(e){var t=ht.getPage(e).image,a=e-ye,i=n(e),r=dt.deltaFrameInCache*dt.pagesInFrame;return r+=(ye+Ce)%dt.pagesInFrame||dt.pagesInFrame,a>-r&&a<=(2*dt.deltaFrameInCache+1)*dt.pagesInFrame-r&&(Me[r+a-1]=t),me.abs(i)<=dt.deltaFrameInDOM&&he.visualizePageAtFrame(t,i,I(t.pageNumber),rt),t}function d(t,a){var n=a?dt.highQualityKey:dt.lowQualityKey;return new Promise(function(i){var r=new Image;r.highQuality=a,r.pageNumber=t,r.idsLinks=[],r.onload=i.bind({},r),r.onerror=i.bind({},!1),r.src=e.Main.pageManager.getImage(n,t)})}function h(e,t){var a=Ie.filter(function(a){return a.pageNumber===e&&a.highQuality===t});if(a.length)return a[0].promise.isNew=!1,a[0].promise;var n=d(e,t).then(function(t){return t!==!1?(Ie.splice(Ie.indexOf(i),1),0===Se&&C(t),t.highQuality?ht.setHighPage(e,t):ht.setLowPage(e,t),c(e),Promise.resolve(t)):void 0}),i={pageNumber:e,highQuality:t,promise:n};return i.promise.isNew=!0,Ie.push(i),i.promise}function p(t){var n,i,r=ht.hasPage(t),o=e.Main.pageManager.hasLinks(t);n=r===!1?h(t,dt.lowQualityDisabled):c(t),i=o===!1?e.Main.pageManager.getLinksPromise(t):e.Main.pageManager.getLinks(t);var s=e.Utils.promiseTimeout(dt.delayLoadingHd,!0),l=function(e){a(t)===we?f(t,e[0].highQuality):d(t,!0).then(function(e,t){ht.setHighPage(e,t),c(e)}.bind(this,t))};"undefined"!=typeof n.then||"undefined"!=typeof i.then?(n.isNew===!0||i.isNew===!0)&&Promise.all([n,i,s]).then(l):dt.delayLoadingHd>0?s.then(l.bind({},[n])):l([n])}function g(a){var n=a-we,i=t(a),r=!1;if(dt.useBgColorPerPage){r=[];for(var o in i)r.push(e.Main.pageManager.getBackgroundColor(i[o]));for(;r.length<dt.pagesInFrame;)1===i[o]?r.unshift(r[0]):r.push(r[r.length-1])}(me.abs(n)<=dt.deltaFrameInDOM||a>=e.Main.xmlManager.get("common-configuration","config","pageCount"))&&he.clearDomFrame(n,r);for(var s in i)p(i[s])}function m(){for(var e=1;e<=dt.deltaFrameInCache;e++)g(we+e),g(we-e)}function f(t,n){if(t<=dt.pagesQuantity&&t>0){var i=n?!0:h(t,!0),r=u(t);Promise.all([i,r]).then(function(n){var i=me.abs(a(t)-we);dt.links&&i<=dt.deltaFrameInDOM&&n[1]&&(dt.delayLoadingAnim>0?e.Utils.promiseTimeout(dt.delayLoadingAnim,t).then(function(){n[0].highQuality&&e.Main.linksManagerNew.removeLinksFromPage(t,!0),e.Main.linksManagerNew.addLinksToPage(t,a(t)-we)}):(n[0].highQuality&&e.Main.linksManagerNew.removeLinksFromPage(t,!0),e.Main.linksManagerNew.addLinksToPage(t,a(t)-we)))})}}function v(e,t){var a=ht.getPage(e).image;if(a&&t.length){for(var i=t.length;i--;){var r=t[i];if(a.idsLinks.indexOf(r.idLink)<0){var o=he.addImageIntoPageDom(a,r);o.highQuality=a.highQuality,o.pageNumber=a.pageNumber,o.idsLinks=a.idsLinks.concat(r.idLink),a=o,o=void 0}}ht.setHighPage(e,a,!0);var s=n(e);me.abs(s)<=dt.deltaFrameInDOM&&he.visualizePageAtFrame(a,s,I(e),!1)}}function b(e,t){var a=ht.getPage(e).image;if(a&&t.length){for(var i=t.length;i--;){var r=t[i];if(a.idsLinks.indexOf(r.id)<0){var o=he.addLinkBoxIntoPageDom(a,r);o.highQuality=a.highQuality,o.pageNumber=a.pageNumber,o.idsLinks=a.idsLinks.concat(r.id),a=o,o=void 0}}ht.setHighPage(e,a,!0);var s=n(e);me.abs(s)<=dt.deltaFrameInDOM&&he.visualizePageAtFrame(a,s,I(e),!1)}}function y(e,t){var a=ht.getPage(e).image;return a&&a.idsLinks.indexOf(t)>=0}function w(e){me.abs(e)<=2*dt.deltaFrameInCache*dt.pagesInFrame?e>0?Me=Me.splice(e,Me.length).concat(new Array(e)):0>e&&(Me=new Array(-e).concat(Me.splice(0,Me.length+e))):Me=new Array((2*dt.deltaFrameInCache+1)*dt.pagesInFrame)}function C(t){Pe===!1&&(Pe=e.Main.xmlManager.get("common-configuration","contents","swf","width")/e.Main.xmlManager.get("common-configuration","contents","swf","height")),Pe&&(Pe>=xe?(Se=Ae(dt.pageMaxWidth-2*dt.pageShadowSize),Le=Ae(dt.pageMaxWidth/Pe-2*dt.pageShadowSize)):(Le=Ae(dt.pageMaxHeight-2*dt.pageShadowSize),Se=Ae(dt.pageMaxHeight*Pe)),Se>dt.pageMaxWidth&&(Le=Ae(Le*dt.pageMaxWidth/Se),Se=dt.pageMaxWidth),Le>dt.pageMaxHeight&&(Se=Ae(Se*dt.pageMaxHeight/Le),Le=dt.pageMaxHeight));var a=(pe-dt.paddingLeft-dt.paddingRight-Se*dt.pagesInFrame)/2;je=a+dt.paddingLeft,Ze=a+dt.paddingRight;var n=(ge-dt.paddingTop-dt.paddingBottom-Le)/2;if(Ye=n+dt.paddingTop,Qe=n+dt.paddingBottom,Pe){var i={width:Se,height:Le,left:je,top:Ye};he.setPageSize(i),dt.links&&e.Main.linksManagerNew.setPageSize(i)}}function M(e){var t=[];if(e>=-dt.deltaFrameInCache||e<=dt.deltaFrameInCache){var a=(e+dt.deltaFrameInCache)*dt.pagesInFrame;t=Me.slice(a,a+dt.pagesInFrame)}return t}function P(e){return((e+Ce)%dt.pagesInFrame||dt.pagesInFrame)-1}function x(){return t(a(ye))}function S(e){return dt.verticalSlider?0:pe*(dt.deltaFrameInDOM+e)}function L(e){return dt.verticalSlider?ge*(dt.deltaFrameInDOM+e):0}function I(e){return je+P(e)*Se}function T(e,t){return Ae(me.min(me.max(t/e*ot,1),dt.maxZoom),2)}function _(t,a,n,i){if(0!==et&&!Oe){dt.links&&e.Main.linksManagerNew.addFixSwiffyAnims(),Oe=!0,it=nt,nt=e.Utils.getSegmentLength(t,a,n,i),at=at||nt;var r=Ae(me.abs((t+n)/2)),o=Ae(me.abs((a+i)/2)),s=Ae(T(at,nt)/ot,2);st=Ae(me.min(me.max(ut-(r-et)/(s*ot-1),0),pe),2),lt=Ae(me.min(me.max(ct-(o-tt)/(s*ot-1),0),ge),2),Ke=$e=!1,s*ot>(it>nt?1.05:1)?dt.verticalSlider?e.Utils.scaleDom3d(be,s*ot,st,lt+ge*dt.deltaFrameInDOM):e.Utils.scaleDom3d(be,s*ot,st+pe*dt.deltaFrameInDOM,lt):rt&&N(),Oe=!1}}function O(){st!==!1&&(ut=st,ct=lt,st=st=Ke=!1)}function k(t){if(dt.zoomRetina&&("in"===t||"out"===t)){var a,n=x();"in"===t?(e.Param.zoom===!1&&(e.Param.zoom=!0,e.Utils.callEvent(window,"webpub-zoom")),he.zoomIn()):(e.Param.zoom===!0&&(e.Param.zoom=!1,e.Utils.callEvent(window,"webpub-zoom")),he.zoomOut());for(var i=n.length;i--;)a=ht.getPage(n[i]).image,a&&he.visualizePageAtFrame(a,0,I(a.pageNumber),"in"===t)}}function E(){rt===!1&&dt.links&&e.Main.linksManagerNew.addFixSwiffyAnims(),rt=!0,$("zoomIn"),e.Main.eventEmul.callEvent("pageZoomIn",e.Main.pagesLoader.pageCurrentOriginalIs),k("in")}function N(){ot=1,rt=!1,$("zoomOut"),dt.links&&e.Main.linksManagerNew.removeFixSwiffyAnims(),et=tt=at=nt=0,ut=ct=st=lt=!1,k("out"),e.Utils.resetDomTransform(be)}function A(){var e=Ae(T(at,nt)/ot,2);ot=Ae(e*ot,2),O(),Oe=!0,at=nt=0,q(!1),1===ot?N():rt===!1?E():k("in"),Oe=!1}function D(){var e=De>0,t=Ue-De;Ke=$e=!1,rt===!1&&(me.abs(Be)>dt.minPxToDrag||Fe<-dt.minPxToDrag||Ue>dt.minPxToDrag)&&(e&&(0===we||0>Ge&&t>dt.minPxToCancelScroll||De<dt.minPxToChangePage)||!e&&(we===i()||Ge>0&&-t>dt.minPxToCancelScroll||-De<dt.minPxToChangePage)?G(0,0,!1):e?G(pe,-1,!1):G(-pe,1,!1))}function F(){var e=Ve>0,t=ze-Ve;Ke=$e=!1,rt===!1&&(me.abs(We)>dt.minPxToDrag||Re<-dt.minPxToDrag||ze>dt.minPxToDrag)&&(e&&(0===we||0>He&&t>dt.minPxToCancelScroll||Ve<dt.minPxToChangePage)||!e&&(we===i()||He>0&&-t>dt.minPxToCancelScroll||-Ve<dt.minPxToChangePage)?G(0,0,!0):e?G(ge,-1,!0):G(-ge,1,!0))}function U(t){if(e.Utils.styleTransition(be,"none"),Ue=Fe=De=ze=Re=Ve=0,dt.links&&e.Main.linksManagerNew.removeFixSwiffyAnims(),0!==t){for(var a=M(t),n=a.length;n--;)a[n]&&he.visualizePageAtFrame(a[n],0,I(a[n].pageNumber),!1);e.Utils.styleTransform(be,"none"),J(t>0?"next":"prev",!1)}_e=Oe=!1}function G(t,a,n){Oe=!0,e.Utils.styleTransitionTransform(be,dt.animationTimePerPage*dt.pagesInFrame/1e3,"ease-out"),n?e.Utils.styleTransform(be,"translate3d(0px, "+t+"px, 0px)"):e.Utils.styleTransform(be,"translate3d("+t+"px, 0px, 0px)"),_e&&clearTimeout(_e),_e=setTimeout(U.bind({},a),dt.animationTimePerPage*dt.pagesInFrame-10)}function q(t){t===!1&&e.Main.menuManager.hideMenu(),ke!==t&&(ke="undefined"==typeof t?!ke:t,e.Main.menuManager.onDocumentClick(),e.Main.controlManager&&e.Main.controlManager.showTools(ke))}function B(t){if(32===t.keyCode)q();else if(dt.draggable!==!1){if(e.Class.LightboxManagerNew.getLength()>0)return;dt.verticalSlider?[38,40].indexOf(t.keyCode)>=0&&ee(38===t.keyCode?"prev":"next"):[37,39].indexOf(t.keyCode)>=0&&ee(37===t.keyCode?"prev":"next")}}function V(e,t,a){Je?(clearTimeout(Je),Je=!1,H(e,t)):Je=setTimeout(function(e){0===nt&&$e===!1&&Ke===!1&&z(a,e),Je=!1}.bind({},we),dt.doubleTapDelay)}function R(t){if(!Oe&&!Ke&&("mousedown"!==t.type&&"click"!==t.type||0===t.button)){var a=t.clientX,n=t.clientY;if(rt&&(a=Ae((a+ut*(ot-1))/ot),n=Ae((n+ct*(ot-1))/ot)),dt.links&&a>je&&pe-Ze>a&&n>Ye&&ge-Qe>n){a-=je,n-=Ye;var i=me.trunc(a/Se),r=dt.pagesInFrame*we+i+1-Ce;r>0&&(a-=i*Se,e.Main.linksManagerNew.onLayerClick(r,a,n,t))}}}function z(t,a){if(!Oe&&!Ke&&("mousedown"!==t.type&&"click"!==t.type||0===t.button)){var n=t.clientX>=0?t.clientX:t.touches[0].clientX,i=t.clientY>=0?t.clientY:t.touches[0].clientY;rt&&(n=Ae((n+ut*(ot-1))/ot),i=Ae((i+ct*(ot-1))/ot));var r=!0;if(dt.links&&n>je&&pe-Ze>n&&i>Ye&&ge-Qe>i){n-=je,i-=Ye;var o=me.trunc(n/Se),s=dt.pagesInFrame*a+o+1-Ce;s>0&&(n-=o*Se,e.Main.linksManagerNew.findClickedUserActs(s,n,i,t)&&(r=!1))}r&&q()}}function H(t,a){Oe||(Oe=!0,rt?N():dt.zoomDoubleClick&&(E(),q(!1),ot=dt.maxZoom,ut=t,ct=a,dt.verticalSlider?e.Utils.scaleDom3d(be,ot,t,a+ge*dt.deltaFrameInDOM):e.Utils.scaleDom3d(be,ot,t+pe*dt.deltaFrameInDOM,a)),Oe=!1)}function X(e){pt(e),Oe||(1===ve.length?(qe=ve[0].x,Xe=ve[0].y,$e=!0,V(qe,Xe,e)):r(ve[0].x,ve[0].y,ve[1].x,ve[1].y))}function W(e){e.preventDefault(),pt(e),Oe||(1===ve.length?$e&&(rt?l(ve[0].x,ve[0].y):dt.draggable!==!1&&(dt.verticalSlider?s(ve[0].x,ve[0].y):o(ve[0].x,ve[0].y))):ve.length>1&&dt.zoomPinch&&_(ve[0].x,ve[0].y,ve[1].x,ve[1].y))}function j(e){pt(e),("mouseout"!==e.type||"CANVAS"!==e.target.nodeName)&&(rt?nt>0?dt.zoomPinch&&A():O():nt>0?dt.zoomPinch&&A():0===ve.length&&$e&&Ke&&(dt.verticalSlider?F():D()),$e=!1)}function Y(t){var n=document.activeElement?"INPUT"===document.activeElement.tagName:!1;if(!document.hasFocus()||!n){pe=window.innerWidth,ge=window.innerHeight,xe=pe/ge,"canvas"===dt.domMode&&(dt.maxZoom=me.min(dt.maxZoom,Ae(10*me.sqrt(Ee/(pe*ge)))/10),dt.zoomScale=Math.min(dt.zoomScale,me.round(100*me.sqrt(Ee/(pe*ge*dt.maxZoom*dt.maxZoom)))/100)),rt&&N(),dt=te(dt),dt.verticalSlider?(be.style.width="100%",be.style.height=2*dt.deltaFrameInDOM+1+"00%",be.style.left="0px",be.style.top=-dt.deltaFrameInDOM+"00%",e.Param.viewMain.classList.add("webpub-viewer__container-vertical")):(be.style.width=2*dt.deltaFrameInDOM+1+"00%",be.style.height="100%",be.style.left=-dt.deltaFrameInDOM+"00%",be.style.top="0px"),dt.pageOnFirstFrame=e.Main.pageManager.pagesOnFirstScreen(),dt.pagesInFrame=e.Main.pageManager.pagePerScreen(),Ce=dt.pagesInFrame-dt.pageOnFirstFrame;for(var i=Ne.length;i--;){var r=Ne[i],o=dt[r];"string"==typeof o&&o.indexOf("px")>0?dt[r]=parseInt(o)||0:"string"==typeof o&&o.indexOf("%")>0&&(dt[r]=Ae(["paddingLeft","paddingRight"].indexOf(r)>=0?pe*(parseInt(o)||0)/100:ge*(parseInt(o)||0)/100))}dt.pageMaxWidth=Ae((pe-dt.paddingLeft-dt.paddingRight)/dt.pagesInFrame),dt.pageMaxHeight=Ae(ge-dt.paddingTop-dt.paddingBottom);var s={pageOnFirstFrame:dt.pageOnFirstFrame,pagesInFrame:dt.pagesInFrame,maxZoom:dt.maxZoom,zoomScale:dt.zoomScale};if(C(),he.setConfig(s),he.onResize(t),dt.links){e.Main.linksManagerNew.setConfig(s),e.Main.linksManagerNew.onResize(t);var l=x();l.forEach(function(t){e.Main.linksManagerNew.addLinksToPage(t,a(t)),e.Main.linksManagerNew.removeLinksFromPage(t,a(t))})}Te&&(we=a(ye),Me=new Array((2*dt.deltaFrameInCache+1)*dt.pagesInFrame),g(we),m())}}function Z(e){if("string"==typeof e){var t=!1,a=!1,n=e.toUpperCase();if("NEXT"===n?e="+"+dt.pagesInFrame:"PREV"===n?e="-"+dt.pagesInFrame:"FIRST"===n?e=1:"LAST"===n&&(e=dt.pagesQuantity),["-","+"].indexOf(e[0])>=0&&(a=!0,t="-"===e[0],e=e.substr(1,e.length)),e=parseInt(e),0===e)e=ye||1;else{if(!e)return;a&&(e=t?me.max(ye-e,1):me.min(ye+e,dt.pagesQuantity))}}return"number"==typeof e&&e>0&&e<=dt.pagesQuantity?e:!1}function Q(n,i){"string"==typeof n&&(n=n.toUpperCase());var r=t(a(i));e.Main.trackerManager.trackPage(1===r.length?{name:"page",variables:{1:r[0]}}:{name:"page",variables:{1:r[0],2:r[1]}});for(var o=r.length;o--;)e.Main.trackerManager.trackEvent({name:"pageView",variables:{1:r[o]}});"NEXT"===n?e.Main.trackerManager.trackEvent({name:"pageNext",variables:{1:ye}}):"PREV"===n&&e.Main.trackerManager.trackEvent({name:"pagePrev",variables:{1:ye}})}function $(a){var n=t(we);e.Main.trackerManager.trackEvent(1===n.length?{name:a,variables:{1:ye}}:{name:a,variables:{1:n[0]+"-"+n[1]}})}function K(t){rt&&N();var n=a(t),i=n-we;i&&(dt.links&&e.Main.linksManagerNew.adjustLinksCache(n),w(i*dt.pagesInFrame),ye=t,we=n,e.Main.pagesLoaderNew.setCurrentPage(t),g(we),m())}function J(t,a){var n=Z(t);!n||n===ye&&a!==!0||(e.Main.pageManager.set(n),Q(t,n),q(!1),K(n))}function ee(e){"prev"===e||-1===e?we>0&&(dt.verticalSlider?G(ge,-1,!0):G(pe,-1,!1)):("next"===e||1===e)&&we<i()&&(dt.verticalSlider?G(-ge,1,!0):G(-pe,1,!1))}function te(t){var a=e.Main.xmlManager.get("common-ui","configs","viewer","padding");if(a)for(var n in a)t[n]=a[n];return t}function ae(t){dt.pagesQuantity=e.Main.pagesLoaderNew.getPageQuantity();for(var a in t)"undefined"!=typeof dt[a]&&(dt[a]=t[a]);Ce=dt.pagesInFrame-dt.pageOnFirstFrame,Te&&Y(),"undefined"==typeof t.animationTimePerPage&&t.verticalSlider===!0&&(dt.animationTimePerPage=400)}function ne(t){if(e.Utils.getClosestByClass(t.target,"webpub-lightbox")||e.Utils.getClosestByClass(t.target,"webpub-aside-menu")||t.target.classList.contains("webpub-topnav"));else{var a=(new Date).getTime();if(a-750>gt){gt=a;var n=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));ee(1===n?"prev":"next")}}}function ie(){be=document.createElement("div"),be.id="webpub-viewer__container",be.addEventListener(e.Param.eventClick,R,!0),be.addEventListener(e.Param.eventStart,X,!0),be.addEventListener(e.Param.eventMove,W,!0),window.addEventListener(e.Param.eventStop,j,!0),dt.container.appendChild(be),dt.keyboardFeature&&document.addEventListener(e.Param.eventKeyboardDown,B,!1);var t=!1;e.Param.userAgent.browser.name===e.Param.userAgent.BROWSER.CHROME&&(t={passive:!0}),window.addEventListener(e.Param.eventResize,Y),dt.draggable!==!1&&e.Param.viewBody.addEventListener(e.Param.eventMouseWheel,ne,t)}function re(){var t={};for(var a in dt)t[a]=dt[a];if(t.container=be,"canvas"===dt.domMode)he=new e.Class.CanvasViewerManager;else{if("html"!==dt.domMode)return!1;he=new e.Class.HtmlViewerManager}he.init(t),dt.links&&(e.Main.linksManagerNew=new e.Class.LinksManagerNew,e.Main.linksManagerNew.init(t))}function oe(){NIApi.register("page.open",function(t){return e.Utils._assertInteger(t,"Page number must be an integer"),J(t),Promise.resolve()}),NIApi.register("page.openNext",function(){return ee("next"),Promise.resolve()}),NIApi.register("page.openPrevious",function(){return ee("prev"),Promise.resolve()}),NIApi.register("page.openFirst",function(){return J("first"),Promise.resolve()}),NIApi.register("page.openLast",function(){return J("last"),Promise.resolve()}),NIApi.register("page.clickLink",function(t,a){return e.Utils._assertInteger(t,"Page number must be an integer")&&e.Utils._assertInteger(a,"Link index must be an integer")&&t>0&&t<=dt.pagesQuantity&&a>=0&&e.Main.linksManagerNew.linkClick(t,{index:a}),Promise.resolve()})}function se(t){ae(t||{}),"canvas"===dt.domMode&&(Ee=e.Main.performanceManager.getMaxCanvasSize()),ie(),re(),Y(),Me=new Array((2*dt.deltaFrameInCache+1)*dt.pagesInFrame),Te=!0,oe();var a=e.Main.urlManager.get("page")||dt.startPage;J(a),e.Main.pageManager.onChange(function(t){e.Main.viewerManager.goToPage(t)}),k("out")}function le(){var e=window.innerWidth/2,t=window.innerWidth/2;H(e,t)}function ue(){rt=!1,le()}function ce(){rt=!0,le()}function de(){return rt}var he={},pe=0,ge=0,me=Math,fe=(e.Param.newThemeVersion,{}),ve=[],be=null,ye=0,we=-1,Ce=0,Me=[],Pe=!1,xe=!1,Se=0,Le=0,Ie=[],Te=!1,_e=!1,Oe=!1,ke=!1,Ee=0,Ne=["paddingBottom","paddingRight","paddingTop","paddingLeft"],Ae=function(e,t){var a=t?me.pow(10,t):1;return me.round(e*a)/a},De=0,Fe=pe,Ue=0,Ge=0,qe=0,Be=0,Ve=0,Re=ge,ze=0,He=0,Xe=0,We=0,je=0,Ye=0,Ze=0,Qe=0,$e=!1,Ke=!1,Je=!1,et=0,tt=0,at=0,nt=0,it=0,rt=!1,ot=1,st=!1,lt=!1,ut=!1,ct=!1,dt={deltaFrameInCache:2,deltaFrameInDOM:1,pagesInFrame:1,pageOnFirstFrame:1,pageMaxWidth:0,pageShadowSize:0,pagesQuantity:0,lowQualityCacheLength:20,highQualityCacheLength:6,domMode:"canvas",startPage:1,highQualityKey:"hdpi",lowQualityKey:"mdpi",lowQualityDisabled:!1,links:!0,pagesRetina:!0,linksRetina:!1,zoomRetina:!0,linksBoxWithDom:!0,autoPlayVideo:!0,autoPlayAnim:!1,linkClickMargin:6,keyboardFeature:!0,zoomPinch:!0,zoomDoubleClick:!0,draggable:!0,delayLoadingHd:0,delayLoadingAnim:400,maxZoom:2.5,zoomScale:2,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,pageMaxHeight:0,minPxToChangePage:30,minPxToCancelScroll:60,minPxToDrag:5,doubleTapDelay:250,animationTimePerPage:125,pageBgColor:"rgba(240, 240, 240, 1)",useBgColorPerPage:!0,linkBoxAspect:e.Class.LinksManagerNew.linksBehaviors.blink,linkBlinkDuration:1e3,verticalSlider:!1,container:e.Param.viewMain},ht=function(){function e(e){var t,a=[],n={},i=0;"high"===e?(n=s,i=dt.highQualityCacheLength):"low"===e&&(n=o,i=dt.lowQualityCacheLength);var r=Object.keys(n);for(t=r.length;t--;)a.push(n[r[t]].date);a.sort(l);var u=a[i-1];NIApi.page.getVisiblePages().then(function(t,a,n){for(var i=[].concat(n),l=1;l<=dt.pagesInFrame;l++)i.push(n[n.length-1]+l);for(var u=1;u<=dt.pagesInFrame;u++)i.unshift(n[0]-u);for(i=i.map(function(e){return e.toString()}),l=r.length;l--;)-1===i.indexOf(r[l])&&t[r[l]].date<a&&(t[r[l]]=void 0,delete t[r[l]]);"high"===e?s=t:"low"===e&&(o=t)}.bind(null,n,u))}function t(t){"low"===t?Object.keys(o).length>dt.lowQualityCacheLength&&e(t):"high"===t&&Object.keys(s).length>dt.highQualityCacheLength&&e(t)}function a(e){var t=!1;return"undefined"!=typeof s[e]?t="high":"undefined"!=typeof o[e]&&(t="low"),t}function n(e){var t=!1;return"undefined"!=typeof s[e]?(s[e].date=new Date,t=s[e],t.highQuality=!0):"undefined"!=typeof o[e]&&(o[e].date=new Date,t=o[e],t.highQuality=!1),t}function i(e,a){o[e]&&(delete o[e],o[e]=void 0),a.setAttribute("data-pageNumber",e),o[e]={image:a,date:new Date},window.requestAnimationFrame(t.bind({},"low"))}function r(e,a,n){s[e]&&!n?s[e].date=new Date:(a.setAttribute("data-pageNumber",e),s[e]={image:a,date:new Date},window.requestAnimationFrame(t.bind({},"high")))}var o={},s={},l=function(e,t){return t-e};return{hasPage:a,getPage:n,setLowPage:i,setHighPage:r}}(),pt=function(){function t(){ve=[];for(var e in fe)ve.push({x:fe[e].x,y:fe[e].y})}return function(a){if(a.type.indexOf("mouse")>=0)ve=a.type===e.Param.eventStop||a.type===e.Param.eventOut?[]:[{x:a.pageX,y:a.pageY}];else if(a.type.toLowerCase().indexOf("pointer")>=0)a.type===e.Param.eventStop||a.type===e.Param.eventOut?delete fe[a.pointerId]:a.type.toLowerCase().indexOf("move")>=0&&$e===!1||(fe[a.pointerId]={x:a.pageX,y:a.pageY}),t();else if(a.type.indexOf("touch")>=0){fe={};for(var n=a.touches.length;n--;)fe[a.touches[n].identifier]={x:a.touches[n].clientX,y:a.touches[n].clientY};t()}}}(),gt=0;return{init:se,setConfig:ae,goToPage:J,scrollFrame:ee,addImagesOnPage:v,addLinksBoxOnPage:b,linkChargedInPage:y,getPagesInCacheAtFrame:M,getPagePosition:P,getPageCoordX:I,getFrameCoordX:S,getFrameCoordY:L,getFrameOfPage:a,getPagesOfFrame:t,getDeltaFrameForPage:n,getCurrentPages:x,zoomIn:ue,zoomOut:ce,isZoomed:de}}}(webpublicationNamespace),function(e){e.Class.X_y_z_Manager=function(){this.urlVarId=!1,this.activeAnimHtml=!1,this.osInfo=null,this._construct=function(){var t="";t=e.Starter.isMaster?"projet":"v3"===e.Starter.versionASP?"publication":e.Main.urlManager.get("id"),t&&(this.urlVarId=t);var a=parseInt(e.Main.urlManager.get("startPage"));a&&(e.Starter.urlStartPage=a);var n=parseInt(e.Main.urlManager.get("page"));n&&(e.Starter.urlStartPage=n);var i=e.Main.urlManager.get("animHtml");"true"==i&&(e.Starter.activeAnimHtml=this.activeAnimHtml=!0),this.varAllId=!1,this.getInfoIfApp()},this.getInfoIfApp=function(){return this.osInfo||(this.osInfo=e.Main.urlManager.get("os")),e.Starter.appInfo.os=this.osInfo,this.osInfo},this._construct()}}(webpublicationNamespace),function(e){e.Class.XmlContentsConnector=function(){var t=function(t,a,n){this.parent=t,this.rootXml=null,this.rootXml=a.children("root");try{if(e.Main.urlManager.contains("isApp")){var i=this.rootXml[0].getElementsByTagName("media")[0];i.setAttribute("value",i.getAttribute("value").replace("assets/",""))}}catch(r){}return this.setVariablesXml(this.rootXml.children("variables").children()),this.setContentsXml(this.rootXml.children("contents")),this.setForConfig(),this.callBack=n,this.callBack&&this.callBack(),!1},a=t.prototype;return a.setVariablesXml=function(e){return this.parent.getVariablesXmlManage(e),!1},a.setContentsXml=function(e){return this.parent.setVariablesAndPrefixForTag(e),!1},a.creatPathByElem=function(e){return e.attr("path")+e.attr("prefix")+"."+e.attr("ext")},a.setForConfig=function(){var e=this.rootXml.children("contents");return this.setPageLength(e),this.setPathTmplImageZoom(e),this.setPathTmplImageSwf(e),this.setPathTmplImageLow(e),this.setPathTmplImageDiapo(e),this.setPathTmplImagePdf(e),this.setPathTmplLinks(e),this.setSecurity(e),!1},a.setPageLength=function(e){var t=this.parent.getXmlByName("contents").children("root").children("contents").attr("pages_nr");return t&&(this.parent.param.defaultParam.nbPages=~~t),!1},a.setPathTmplImageZoom=function(e){var t=e.children("[id=Zoom]");return t&&t.attr("path")&&(this.parent.param.defaultParam.pathTextureHigh=this.creatPathByElem(t)),!1},a.setPathTmplImageSwf=function(e){var t=e.children("[id=swf]");return t&&t.attr("path")&&(this.parent.param.defaultParam.page_width=t.attr("width"),this.parent.param.defaultParam.page_height=t.attr("height")),!1},a.setPathTmplImageLow=function(e){var t=e.children("[id=Low]");return t&&t.attr("path")&&(this.parent.param.defaultParam.pathTextureLow=this.creatPathByElem(t)),!1},a.setPathTmplImageDiapo=function(e){var t=e.children("[id=thumbnails]");return t&&t.attr("path")&&(this.parent.param.defaultParam.pathDiapo=this.creatPathByElem(t)),!1},a.setPathTmplImagePdf=function(e){var t=e.children("[id=pdf]");return t&&t.attr("path")&&(this.parent.param.defaultParam.pathPagePdf=this.creatPathByElem(t)),!1},a.setPathTmplLinks=function(e){var t=e.children("[id=links]");return t&&t.attr("path")&&(this.parent.param.defaultParam.pathLinks=this.creatPathByElem(t)),!1},a.setSecurity=function(e){var t=e.children("[id=security]");return t&&t.attr("path")&&(this.parent.param.defaultParam.pathXmlSecurity=this.creatPathByElem(t)),!1},t}(),e.Class.XmlUIConnector=function(){var t=function(e,t,a){return this.parent=e,this.rootXml=null,this.uiElements=null,this.uiElementsGroups=null,this.rootXml=t.children(" root"),this.uiElements=this.rootXml.children("uielements"),this.uiElementsGroups=this.uiElements.find("Group"),this.setUIXml(this.uiElements),this.callBack=a,this.logoManage(),this.callBack&&this.callBack(),!1},a=t.prototype;return a.logoManage=function(){var t=this.uiElements.children("element[id='logo']")[0];if(t){var a=t.querySelector("content file"),n=t.querySelector("useract"),i=t.querySelectorAll("scale");a&&n&&i&&(e.Starter._CONFIG.logo.exists=!0,e.Starter._CONFIG.logo.conf=t,e.Starter._CONFIG.logo.mediaSrc=a.getAttribute("url"),e.Starter._CONFIG.logo.mediaLink=n.getAttribute("param"),e.Starter._CONFIG.logo.mediaScale=i.length>0)}else e.Starter._CONFIG.logo.exists=!1;return!1},a.setUIXml=function(e){return this.parent.setVariablesAndPrefixForTag(e),!1},t}()}(webpublicationNamespace),function(e){e.Class.XmlInterface=function(){var t=function(e,t){this.callBack=t,this.publicationPath="publication",this.xmlPubInfoConnector=null,this.globalsXmlVariables={},
this.xmlByNameList={},this.txtByNameList={},this.loadDefaultParamTxt()},a=t.prototype;return a.helpGetUrl=function(e){return 0===e.length?"":e[0].getAttribute("url_html5")||e[0].getAttribute("url")},a.getXmlByName=function(e){return this.xmlByNameList[e]?this.xmlByNameList[e]:null},a.setXmlByName=function(e,t){this.xmlByNameList[e]=t},a.getTxtByName=function(e){return this.txtByNameList[e]?this.txtByNameList[e]:null},a.setTxtByName=function(e,t){this.txtByNameList[e]=t},a.loadDefaultParamTxt=function(){this.param=new e.Class.Param,this.loadContentsManage(),this.param.setMailService()},a.loadContentsManage=function(){var t=this,a=null;a=e.Main.xmlManager.getXml("contents"),t.setXmlByName("contents",$(a)),t.xmlContentsConnector=new e.Class.XmlContentsConnector(t,t.getXmlByName("contents"),function(){t.loadUIManage()})},a.loadUIManage=function(){var t=this;t.xmlUI=e.Main.xmlManager.getXml("ui"),t.param.init(),t.setXmlByName("UI",$(t.xmlUI)),t.xmlUIConnector=new e.Class.XmlUIConnector(t,t.getXmlByName("UI"),function(){t.callBack()})},a.getVariablesXmlManage=function(){var e=null,t=null,a=null,n=/\$([^\$]*)\$/g,i="~",r=null,o=function(e,t){return"undefined"!=typeof r.globalsXmlVariables[t]?r.globalsXmlVariables[t]:e};return function(s){for(r=this,e=s.length,t=0;e>t;)r.globalsXmlVariables[s[t].tagName.toLowerCase()]=s[t].getAttribute("value").replace(i,r.publicationPath),r.globalsXmlVariables[s[t].tagName]=s[t].getAttribute("value").replace(i,r.publicationPath),t++;for(t=0;e>t;)a=s[t].getAttribute("value"),a=a.replace(i,r.publicationPath).replace(n,o),s[t].setAttribute("value",a),r.globalsXmlVariables[s[t].tagName.toLowerCase()]=a,r.globalsXmlVariables[s[t].tagName]=a,t++}}(),a.setVariablesAndPrefixForTag=function(t,a){var n=null,i=null,r=null,o=null,s=null,l=null,u=null,c=null,d=null,h=!0,p=0,g=0,m=0,f=0,v=this;if(p=t.length)for(c=t;p--;){for(n=c[p],i=$(n),o=n.attributes,m=o.length;m--;)if(s=o[m].value,l=s.match(/\$[^\$]*\$/g))for(f=l.length;f--;)u=l[f].substring(1,l[f].length-1),e.Main.xmlManager.getVariable(u)&&(s=s.replace(l[f],e.Main.xmlManager.getVariable(u)),o[m].value=s);if(r=n.textContent.trim(),1===n.childNodes.length&&n.childNodes[0].nodeType===n.TEXT_NODE&&r&&""!==r&&(l=r.match(/\$[^\$]*\$/g)))for(g=l.length;g--;)u=l[g].substring(1,l[g].length-1),e.Main.xmlManager.getVariable(u)&&(r=r.replace(l[g],e.Main.xmlManager.getVariable(u)),n.textContent=r);d=n.getAttribute("prefix"),i.parent("[prefix]")&&h?a=i.parent("[prefix]").attr("prefix"):h=!1,a&&!d&&i.attr("prefix",a),i.children()[0]&&v.setVariablesAndPrefixForTag(i.children(),a)}},t}()}(webpublicationNamespace),function(e){e.Class.XmlLoader=function(){var t=function(e,t,a,n,i,r,o,s){this.parent=e,this.path=a,this.onProgressCallBack=o,this.naturalObject=s,this.callBack=i,this.format=".xml",this.xmlNeededToLoad=n,this.percentComplete=0,this.getXml={},this.xmlCounter=0,r&&(this.format=r),this.whileListXml()},a=t.prototype;return a.loadCurrXml=function(e,t,a){var n=this;if(n.xmlCounter>=a)return n.callBack&&n.callBack(!0,n),!1;var i=new XMLHttpRequest;return i.onprogress=function(e){e.lengthComputable&&(n.percentComplete=e.loaded/e.total*100,n.onProgressCallBack&&(n.percentComplete=100*n.xmlCounter+n.percentComplete,n.onProgressCallBack(n.percentComplete)))},i.open("GET",e,!0),i.onreadystatechange=function(e){4==i.readyState&&(e.lengthComputable===!1&&(n.percentComplete=100,n.onProgressCallBack&&n.onProgressCallBack(n.percentComplete)),200!==i.status&&(n.notFound=!0),n.percentComplete=0,n.getXml[Object.keys(n.xmlNeededToLoad)[t]]=".xml"!=n.format||n.naturalObject?i.response:i.responseXML?$(i.responseXML):document.createElement("root"),n.addUrlParamAsVariable(Object.keys(n.xmlNeededToLoad)[t]),n.xmlCounter++,t++,n.loadCurrXml(n.getPathByIndex(t),t,a))},i.send(),!1},a.addUrlParamAsVariable=function(){var t=null,a=null,n=null,i=null,r=null,o=null;return function(s){if(!Object.keys(e.Main.urlManager.getAll()).length)return!1;if(o=this.getXml[s][0],"object"!=typeof o)return!1;if(t=o.querySelector("variables")){a=e.Main.urlManager.getAll();for(var l in a)n=a[l],i=t.querySelectorAll(l),i[0]?i[0].setAttribute("value",n):(r=document.createElement(l),r.setAttribute("value",n),t.appendChild(r))}}}(),a.getPathByIndex=function(e){return this.path?this.path+this.xmlNeededToLoad[Object.keys(this.xmlNeededToLoad)[e]]+this.format:this.xmlNeededToLoad[Object.keys(this.xmlNeededToLoad)[e]]},a.whileListXml=function(){var e=null;return function(){return e=Object.keys(this.xmlNeededToLoad).length,this.loadCurrXml(this.getPathByIndex(0),0,e),!1}}(),t}()}(webpublicationNamespace),function(e){"use strict";var t={CONTAIN:"contain",COVER_MIDDLE:"coverMiddle",COVER_TOP:"coverTop",CUSTOM:"custom"};e.Class.EpubConfig=function(){function a(a){this._paddingBottom=0,this._paddingTop=0,this._paddingLeft=0,this._paddingRight=0,this._spreadsLength=3,this._pagesBySpread=2,this._pageQuantity=0,this._firstCoverPage=1,this._pageOnFirstFrame=1,this._pageSizeType=t.CONTAIN,this._currentPageAtInit=e.Main.urlManager.get("page")||1,this._currentPage=null,this._htmlVerticalAligner="<div class='webpub-viewer__epub-container-spread-vertical-aligner'></div>",this.domMode="html",this.draggable=!0,this.ePubConfig=null,this.highQualityKey="hdpi",this.linkBoxAspect="flash",this.pageBgColor="#fff",this.pagesRetina=!0,this.verticalSlider=!1,this.zoomDoubleClick=!0,this.zoomPinch=!0,this.zoomRetina=!0,this.switchLandScapeUsingPageSize=!1,this.pagesBySpreadMax=2,this.zoomFactor=.008,this.maxPageTotalScale=3,this._pageSizeTypeConf={},this._pageSizeTypeConf[t.COVER_TOP]={switchablePageBySpread:!1},this._pageSizeTypeConf[t.COVER_MIDDLE]={switchablePageBySpread:!1},this._pageSizeTypeConf[t.CONTAIN]={switchablePageBySpread:!0},this._pageSizeTypeConf[t.CUSTOM]={switchablePageBySpread:!0},this.mainViewElementClassName="webpub-viewer__epub-container",this.spreadViewElementClassName="webpub-viewer__epub-container-spread",this.zoomableViewElementClassName="webpub-viewer__epub-container-spread-zoomable"}return Object.defineProperty(a.prototype,"paddingBottom",{get:function(){return this._paddingBottom},set:function(e){this._paddingBottom=e}}),Object.defineProperty(a.prototype,"paddingTop",{get:function(){return this._paddingTop},set:function(e){this._paddingTop=e}}),Object.defineProperty(a.prototype,"paddingLeft",{get:function(){return this._paddingLeft},set:function(e){this._paddingLeft=e}}),Object.defineProperty(a.prototype,"paddingRight",{get:function(){return this._paddingRight},set:function(e){this._paddingRight=e}}),Object.defineProperty(a.prototype,"navigationType",{get:function(){return this.verticalSlider===!1?"x":"y"},set:function(e){this.verticalSlider="x"===e?!1:!0}}),Object.defineProperty(a.prototype,"pagesBySpread",{get:function(){return this._pagesBySpread},set:function(e){this._pageSizeTypeConf[this._pageSizeType].switchablePageBySpread!==!1&&(this._pagesBySpread=e)}}),Object.defineProperty(a.prototype,"pagesInFrame",{get:function(){return this.pagesBySpread},set:function(e){this.pagesBySpread=e}}),Object.defineProperty(a.prototype,"pageQuantity",{get:function(){return this._pageQuantity},set:function(e){this._pageQuantity=e}}),Object.defineProperty(a.prototype,"currentPage",{get:function(){return this._currentPage=~~(this._currentPage||this._currentPageAtInit),this._currentPage},set:function(e){e=~~e,e>this.pageQuantity?e=this.pageQuantity:1>e&&(e=1),1===this._firstCoverPage&&(e=~~(e/this.pagesBySpread)*this.pagesBySpread||1),this._currentPage=e}}),Object.defineProperty(a.prototype,"firstCoverPage",{get:function(){return 1===this.pagesBySpread?0:this._firstCoverPage}}),Object.defineProperty(a.prototype,"pageOnFirstFrame",{set:function(e){return this._pageOnFirstFrame=e,this._pageOnFirstFrame>1?void(this._firstCoverPage=0):void(this._firstCoverPage=1)},get:function(){return this._pageOnFirstFrame}}),Object.defineProperty(a.prototype,"spreadsLength",{get:function(){return this.pageQuantity<this._spreadsLength?this.pageQuantity:this._spreadsLength}}),Object.defineProperty(a.prototype,"pageWidth",{get:function(){return this.ePubConfig.width}}),Object.defineProperty(a.prototype,"pageHeight",{get:function(){return this.ePubConfig.height}}),Object.defineProperty(a.prototype,"htmlVerticalAligner",{get:function(){return this._htmlVerticalAligner}}),Object.defineProperty(a.prototype,"pageSizeType",{get:function(){return this._pageSizeType},set:function(e){this._pageSizeType=e}}),a.prototype.setConfig=function(){var e="";return function(t){for(e in t)"undefined"!=typeof this[e]&&(this[e]=t[e])}}(),a}()}(webpublicationNamespace),function(e){"use strict";e.EpubDomApi=function(t,a){return e.Utils.callEvent(window,"EpubDomApiEvents_"+t,a),!1}}(webpublicationNamespace),function(e){"use strict";var t=!1,a=500,n=300,i=10,r=200,o=7,s=100,l=0,u={MOUSE:{MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEMOVE:"mousemove"},TOUCH:{TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove"},MSPOINTER:{MSPOINTERDOWN:"MSPointerDown",MSPOINTERUP:"MSPointerUp",MSPOINTERMOVE:"MSPointerMove"},POINTER:{POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTERMOVE:"pointermove"},MOUSEWHEEL:"mousewheel",DOMMOUSESCROLL:"DOMMouseScroll"},c={PINCHGESTURE:"pinchGesture",PRESSGESTURE:"pressGesture",PANGESTURE:"panGesture",TAPGESTURE:"tapGesture",DBLTAPGESTURE:"dblTapGesture",SWIPEGESTURE:"swipeGesture",MOUSEWHEELGESTURE:"mouseWheelGesture"},d={};Object.defineProperty(d,"data",{get:function(){return{start:{stat:!1,time:0,lastTime:0,"true":{time:0,lastTime:0},"false":{time:0,lastTime:0},timer:0},end:{stat:!1,time:0,lastTime:0,"true":{time:0,lastTime:0},"false":{time:0,lastTime:0},timer:0},move:{stat:!1,time:0,lastTime:0,"true":{time:0,lastTime:0},"false":{time:0,lastTime:0},timer:0}}}});var h=null,p=null,g=[],m=function(){var e=0,t=0;return function(){for(e=0,t=g.length;t>e;e++)clearTimeout(g[e]);g=[]}}();e.Class.EpubGesturesEvent=function(){function e(e,t){this.parent=e,this.element=t,this.preventDefaultOnMove=!1,this.element.epubGesturesEvent=this,this.gestureID=Date.now()+("_UID_"+l++),this.gestureEventList={},this.gestureEventList[c.PINCHGESTURE]=[],this.gestureEventList[c.PRESSGESTURE]=[],this.gestureEventList[c.PANGESTURE]=[],this.gestureEventList[c.TAPGESTURE]=[],this.gestureEventList[c.DBLTAPGESTURE]=[],this.gestureEventList[c.SWIPEGESTURE]=[],this.gestureEventList[c.MOUSEWHEELGESTURE]=[],this.eventsStatus=d.data,this.moveDifferer={x:{diff:0,count:0,countDiff:0,pos:0,vector:0,vectorDiff:0},y:{diff:0,count:0,countDiff:0,pos:0,vector:0,vectorDiff:0},hypotenuse:0,hypotenuseDiff:0},this.gestureData={type:null,pinchZoomDiff:0,wheel:{isX:!1,isY:!1},x:{point:0,vectorDiff:0,client:0,isVector:!1},y:{point:0,vectorDiff:0,client:0,isVector:!1}},this.wheelData={currentTime:0,deltaX:0,deltaY:0},v(this)}function f(e,t,a,n,i,r,o,s,l,u,c,d,h,p){e.gestureData.type=a,e.gestureData.pinchZoomDiff=d,e.gestureData.x.pointDiff=n,e.gestureData.x.vectorDiff=r,e.gestureData.x.countDiff=s,e.gestureData.x.isVector=u,e.gestureData.x.client=h,e.gestureData.y.pointDiff=i,e.gestureData.y.vectorDiff=o,e.gestureData.y.countDiff=l,e.gestureData.y.isVector=c,e.gestureData.y.client=p,t.gestureData=e.gestureData}function v(e){"ontouchstart"in window?(e.element.addEventListener(u.TOUCH.TOUCHSTART,M),e.element.addEventListener(u.TOUCH.TOUCHEND,P),e.element.addEventListener(u.TOUCH.TOUCHMOVE,x)):(e.element.addEventListener(u.MOUSE.MOUSEDOWN,y),e.element.addEventListener(u.MOUSE.MOUSEUP,w),e.element.addEventListener(u.MOUSE.MOUSEMOVE,C)),navigator.maxTouchPoints>0?(e.element.addEventListener(u.POINTER.POINTERDOWN,S),e.element.addEventListener(u.POINTER.POINTERUP,L),e.element.addEventListener(u.POINTER.POINTERMOVE,I)):navigator.msMaxTouchPoints>0&&(e.element.addEventListener(u.MSPOINTER.POINTERDOWN,S),e.element.addEventListener(u.MSPOINTER.POINTERUP,L),e.element.addEventListener(u.MSPOINTER.POINTERMOVE,I)),e.element.addEventListener(u.MOUSEWHEEL,k,!1),e.element.addEventListener(u.DOMMOUSESCROLL,b,!1)}function b(e){console.log(e)}function y(e){e.hypotenuse=0,G(e)}function w(e){e.hypotenuse=0,O(e)}function C(e){e.hypotenuse=0,q(e)}function M(e){e.changedTouches.length>0&&F(e.currentTarget.epubGesturesEvent),N(e,e.touches),G(e)}function P(e){return 0===e.touches.length?(N(e,e.changedTouches),void O(e)):void F(e.currentTarget.epubGesturesEvent)}function x(e){e.currentTarget.epubGesturesEvent.preventDefaultOnMove&&e.preventDefault(),N(e,e.touches),q(e)}function S(e){G(e)}function L(e){O(e)}function I(e){q(e)}function T(e,t){return e[t]}function _(e,t,a,n){p=n,e[t].stat=a,a=a?"true":"false",e[t].lastTime=e[t].time,e[t].time=n,e[t][a]=e[t][a],e[t][a].lastTime=e[t][a].time,e[t][a].time=n,clearTimeout(e[t].timer)}function O(e){h=e.currentTarget.epubGesturesEvent.eventsStatus,_(h,"start",!1,Date.now()),_(h,"end",!0,p),X(e.currentTarget.epubGesturesEvent,e,"end"),F(e.currentTarget.epubGesturesEvent)}var k=function(){var e=null,t=!1,a=!1;return function(n){e=n.currentTarget.epubGesturesEvent,t=n.deltaX*e.wheelData.deltaX<0,a=n.deltaY*e.wheelData.deltaY<0,0===n.deltaX&&(t=!1),0===n.deltaY&&(a=!1),e.gestureData.wheel.isX=t,e.gestureData.wheel.isY=a,n.gestureData=e.gestureData,Date.now()-e.wheelData.currentTime<100&&t===!1&&a===!1||(0!==n.deltaX?t=!0:0!==n.deltaY&&(a=!0),e.gestureData.wheel.isX=t,e.gestureData.wheel.isY=a,E(e,c.MOUSEWHEELGESTURE,n)),e.wheelData.deltaX=n.deltaX||e.wheelData.deltaX,e.wheelData.deltaY=n.deltaY||e.wheelData.deltaY,e.wheelData.currentTime=Date.now()}}(),E=function(){var e=0,t=0;return function(a,n,i,r){for(e=0,t=a.gestureEventList[n].length;t>e;e++)a.gestureEventList[n][e](i,r)}}(),N=function(){var e=0,t=0,a=0,n=0,i=0,r=0,o=0,s=0,l=function(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))};return function(u,c){for(e=0,t=c.length,a=0,i=0,r=0,n=0,o=0,s=0;t>e;e++)i+=c[e].clientX,r+=c[e].clientY,o=o||c[0].clientX,s=s||c[0].clientY,o-=c[e].clientX,s-=c[e].clientY,a+=l(o,s),o=c[e].clientX,s=c[e].clientY;u.hypotenuse=a,u.clientX=i/t,u.clientY=r/t}}(),A=function(e,t){return e.moveDifferer.x.count=e.moveDifferer.x.count||t.clientX,e.moveDifferer.y.count=e.moveDifferer.y.count||t.clientY,e.moveDifferer.x.countDiff+=Math.abs(t.clientX-e.moveDifferer.x.count),e.moveDifferer.y.countDiff+=Math.abs(t.clientY-e.moveDifferer.y.count),e.moveDifferer.x.count=t.clientX,e.moveDifferer.y.count=t.clientY,e.moveDifferer.hypotenuse=e.moveDifferer.hypotenuse||t.hypotenuse,e.moveDifferer.hypotenuseDiff=t.hypotenuse-e.moveDifferer.hypotenuse,e.moveDifferer.hypotenuse=t.hypotenuse,e.moveDifferer.x.countDiff<i&&e.moveDifferer.y.countDiff<i&&0===e.moveDifferer.hypotenuseDiff?!1:(e.moveDifferer.x.pos=e.moveDifferer.x.pos||t.clientX,e.moveDifferer.y.pos=e.moveDifferer.y.pos||t.clientY,e.moveDifferer.x.diff=t.clientX-e.moveDifferer.x.pos,e.moveDifferer.y.diff=t.clientY-e.moveDifferer.y.pos,e.moveDifferer.x.vector=e.moveDifferer.x.vector||t.clientX,e.moveDifferer.y.vector=e.moveDifferer.y.vector||t.clientY,Math.abs(t.clientX-e.moveDifferer.x.vector)<Math.abs(e.moveDifferer.x.vectorDiff)&&(e.moveDifferer.x.vector=t.clientX),Math.abs(t.clientY-e.moveDifferer.y.vector)<Math.abs(e.moveDifferer.y.vectorDiff)&&(e.moveDifferer.y.vector=t.clientY),e.moveDifferer.x.vectorDiff=t.clientX-e.moveDifferer.x.vector,e.moveDifferer.y.vectorDiff=t.clientY-e.moveDifferer.y.vector,!0)},D=function(e,t){e.moveDifferer[t].diff=0,e.moveDifferer[t].count=0,e.moveDifferer[t].countDiff=0,e.moveDifferer[t].pos=0,e.moveDifferer[t].vector=0,e.moveDifferer[t].vectorDiff=0,e.moveDifferer.hypotenuseDiff=0,e.moveDifferer.hypotenuse=0},F=function(e){D(e,"x"),D(e,"y")},U=function(e){e.eventsStatus=d.data},G=function(){var e=null;return function(t){h=t.currentTarget.epubGesturesEvent.eventsStatus,e=T(h,"start"),e.stat!==!0&&(F(t.currentTarget.epubGesturesEvent),_(h,"start",!0,Date.now()),_(h,"end",!1,p),_(h,"move",!1,p),X(t.currentTarget.epubGesturesEvent,t,"start"))}}(),q=function(){var e=null,t=!1;return function(a){h=a.currentTarget.epubGesturesEvent.eventsStatus,_(h,"move",!1,Date.now()),e=T(h,"start"),e.stat===!0&&T(h,"end").stat===!1&&(B(a),t=A(a.currentTarget.epubGesturesEvent,a),t===!0&&(m(),_(h,"move",!0,p),X(a.currentTarget.epubGesturesEvent,a,"move")))}}(),B=function(){var e=null;return function(t){e=t.target,"VIDEO"===e.tagName||"AUDIO"===e.tagName?console.log(e.tagName):t.preventDefault()}}(),V=function(){var e=null,t=null,a=null;return function(i,r,o){return"end"===o?(h=r.currentTarget.epubGesturesEvent.eventsStatus,e=T(h,"start"),t=T(h,"end"),a=T(h,"move"),a.stat===!1&&t.stat===!0&&0!==e.lastTime&&(r.defaultPreventGesture===!0?m():clearTimeout(e.timer),f(i,r,c.TAPGESTURE,i.moveDifferer.x.diff,i.moveDifferer.y.diff,i.moveDifferer.x.vectorDiff,i.moveDifferer.y.vectorDiff,i.moveDifferer.x.countDiff,i.moveDifferer.y.countDiff,!1,!1,i.moveDifferer.hypotenuseDiff,r.clientX,r.clientY),e.timer=setTimeout(function(){E(i,c.TAPGESTURE,r)},n),g.push(e.timer)),!1):void 0}}(),R=function(){var e=null,t=null,n=null;return function(i,r,o){return"end"===o?(h=r.currentTarget.epubGesturesEvent.eventsStatus,e=T(h,"start"),t=T(h,"end"),n=T(h,"move"),n.stat===!1&&t["true"].time-e["true"].lastTime<a?(m(),f(i,r,c.DBLTAPGESTURE,i.moveDifferer.x.diff,i.moveDifferer.y.diff,i.moveDifferer.x.vectorDiff,i.moveDifferer.y.vectorDiff,i.moveDifferer.x.countDiff,i.moveDifferer.y.countDiff,!1,!1,i.moveDifferer.hypotenuseDiff,r.clientX,r.clientY),!0):!1):void 0}}(),z=function(){var e=null;return function(t,a,n){return"end"===n||"start"===n?!1:(h=t.eventsStatus,e=T(h,"move"),e.stat===!1?!1:(a.preventDefault(),f(t,a,c.PANGESTURE,t.moveDifferer.x.diff,t.moveDifferer.y.diff,t.moveDifferer.x.vectorDiff,t.moveDifferer.y.vectorDiff,t.moveDifferer.x.countDiff,t.moveDifferer.y.countDiff,!1,!1,t.moveDifferer.hypotenuseDiff,a.clientX,a.clientY),!0))}}(),H=function(){var e=null,t=null,a=null,n=!1,i=!1,l=function(e,t){return 0!==e.moveDifferer.x.vectorDiff||0!==e.moveDifferer.y.vectorDiff?(t.preventDefault(),f(e,t,c.SWIPEGESTURE,e.moveDifferer.x.diff,e.moveDifferer.y.diff,e.moveDifferer.x.vectorDiff,e.moveDifferer.y.vectorDiff,e.moveDifferer.x.countDiff,e.moveDifferer.y.countDiff,!1,!1,e.moveDifferer.hypotenuseDiff,t.clientX,t.clientY),!0):!1};return function(u,d){return h=u.eventsStatus,n=!1,i=!1,t=T(h,"start"),a=T(h,"end"),e=T(h,"move"),e.stat===!1||a.stat===!1?!1:(Math.abs(u.moveDifferer.x.vectorDiff)>s?n=!0:Math.abs(u.moveDifferer.x.vectorDiff)>o&&a.time-t.lastTime<=r&&(n=!0),Math.abs(u.moveDifferer.y.vectorDiff)>s?i=!0:Math.abs(u.moveDifferer.y.vectorDiff)>o&&a.lastTime-t.lastTime<=r&&(i=!0),n===!1&&i===!1?l(u,d):(f(u,d,c.SWIPEGESTURE,u.moveDifferer.x.diff,u.moveDifferer.y.diff,u.moveDifferer.x.vectorDiff,u.moveDifferer.y.vectorDiff,u.moveDifferer.x.countDiff,u.moveDifferer.y.countDiff,n,i,u.moveDifferer.hypotenuseDiff,d.clientX,d.clientY),!0))}}(),X=function(){var e=null;return function(a,n,i){return n.defaultPreventGesture===!0||t===!0?(U(a),F(a),void m()):(h=n.currentTarget.epubGesturesEvent.eventsStatus,e=T(h,"start"),R(a,n,i)===!0?(E(a,c.DBLTAPGESTURE,n),void m()):(V(a,n,i)===!0,H(a,n,i)===!0?(E(a,c.SWIPEGESTURE,n),void((n.defaultPreventGesture===!0||t===!0)&&m())):z(a,n,i)===!0?(E(a,c.PANGESTURE,n),void((n.defaultPreventGesture===!0||t===!0)&&m())):void 0))}}();return e.prototype.addEventListener=function(e,t){return"undefined"!=typeof t["gesture_"+e+"_"+this.gestureID]?!1:(t["gesture_"+e+"_"+this.gestureID]=!0,this.gestureEventList[e].push(t),!0)},e.prototype.removeEventListener=function(){var e=0,t=0;return function(a,n){if(e=0,"undefined"==typeof n["gesture_"+a+"_"+this.gestureID])return!1;for(t=this.gestureEventList[a].length;t>e;e++)if(typeof this.gestureEventList[a][e]["gesture_"+a+"_"+this.gestureID]!==!0)return this.gestureEventList[a][e]["gesture_"+a+"_"+this.gestureID]=null,delete this.gestureEventList[a][e]["gesture_"+a+"_"+this.gestureID],!0;return!1}}(),e.prototype.preventAllGesture=function(){var e=null,a=function(){t=!1};return function(){clearTimeout(e),t=!0,e=setTimeout(a,100)}}(),e.prototype.resetMoveXDifferer=function(){D(this,"x")},e.prototype.resetMoveYDifferer=function(){D(this,"y")},e.prototype.resetMoveDifferer=function(){F(this)},e.prototype.STARTMOVEAT=i,e.prototype.GESTURESNAME=c,e}()}(webpublicationNamespace),function(e){"use strict";e.Class.EpubManager=function(){function t(t,a){this.parent=t,console.log(a),this.viewMain=a,this.epubMode=!0,this.config=new e.Class.EpubConfig(this),this.epubNavigationTypeManager=null,this.epubSpreads=null,this.screenSize={width:0,height:0,ratio:0}}function a(e){NIApi.register("page.open",e.pageChange.bind(e)),NIApi.register("page.openNext",e.pageNext.bind(e)),NIApi.register("page.openPrevious",e.pagePrevious.bind(e)),NIApi.register("page.openFirst",e.pageFirst.bind(e)),NIApi.register("page.openLast",e.pageLast.bind(e))}return Object.defineProperty(t.prototype,"navigationType",{get:function(){return this.config.navigationType},set:function(e){this.config.navigationType=e,this.epubSpreads.updateSpreads()}}),Object.defineProperty(t.prototype,"currentPage",{get:function(){return this.config.currentPage},set:function(e){this.config.currentPage=e,this.epubSpreads.updateSpreads()}}),Object.defineProperty(t.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity}}),Object.defineProperty(t.prototype,"pagesBySpreadMax",{get:function(){return this.config.pagesBySpreadMax}}),Object.defineProperty(t.prototype,"pagesBySpread",{get:function(){return this.config.pagesBySpread},set:function(e){if(e!==this.config.pagesBySpread){if(this.config.pagesBySpread=e,null===this.epubSpreads)return;this.epubSpreads.updateSpreads()}}}),t.prototype.pageChange=function(e){return ctx.epubSpreads.pageChange(e),Promise.resolve()},t.prototype.pageNext=function(){return this.currentPage+=this.pagesBySpread,Promise.resolve()},t.prototype.pagePrevious=function(){return this.currentPage-=this.pagesBySpread,Promise.resolve()},t.prototype.pageFirst=function(){return this.currentPage=1,Promise.resolve()},t.prototype.pageLast=function(){return this.currentPage=this.pageQuantity,Promise.resolve()},t.prototype.goToPage=function(e,t){this.currentPage=e},t.prototype.gotoPageByCoordsDiff=function(){var e=0,t=function(e,t,a){return e!==!0?0:t>0?0>a?0:-1:0>t?a>0?0:1:0};return function(a){return e="x"===this.navigationType?t(a.x.isVector,a.x.vectorDiff,a.x.pointDiff):t(a.y.isVector,a.y.vectorDiff,a.y.pointDiff),e>0?void this.pageNext():0>e?void this.pagePrevious():void(this.currentPage=this.currentPage)}}(),t.prototype.getPagePosition=function(){console.log(arguments)},t.prototype.getPageCoordX=function(){console.log(arguments)},t.prototype.getFrameCoordX=function(){console.log(arguments)},t.prototype.getFrameCoordY=function(){console.log(arguments)},t.prototype.getDeltaFrameForPage=function(){console.log(arguments)},t.prototype.scrollFrame=function(e){"next"===e||1===e?this.pageNext():("prev"===e||-1===e)&&this.pagePrevious()},t.prototype.getCurrentPages=function(){var e=null,t=null,a=0,n=0;return function(i){if(t=[],a=0,null===this.epubSpreads)return t;for(e=this.epubSpreads.getPagesFromSpreadByPageIndex(i||this.currentPage),n=e.length;n>a;a++)"undefined"!=typeof e[a]&&t.push(e[a].pageIndex);return t}}(),t.prototype.getPagesOfFrame=function(e){return[]},t.prototype.getFrameOfPage=function(e){return this.getCurrentPages(e).length},t.prototype.setConfig=function(e){this.config.setConfig(e)},t.prototype.updateSpreadsSize=function(){null!==this.epubSpreads&&this.epubSpreads.updateSpreadsSize()},t.prototype.switchPageBySpread=function(e){return e?void(this.pagesBySpread=e||this.pagesBySpread):void(this.pagesBySpread=this.pagesBySpread%this.pagesBySpreadMax+1)},t.prototype.switchNavigation=function(e){return e?(this.navigationType=e,this.navigationType):"x"===this.navigationType?void(this.navigationType="y"):void(this.navigationType="x")},t.prototype.init=function(t){this.setConfig(t),this.epubNavigationTypeManager=new e.Class.EpubNavigationTypeManager(this,this.config,this.viewMain),this.epubSpreads=new e.Class.EpubSpreads(this,this.config,this.viewMain),this.screenSize=this.epubNavigationTypeManager.screenSize,this.epubNavigationTypeManager.forceResize(),a(this)},t}()}(webpublicationNamespace),function(e){"use strict";e.Class.EpubNavigationTypeManager=function(){function t(t,n,i){this.parent=t,this.config=n,this.screenSize=this.parent.screenSize,this.pageSize={width:this.pageWidth,height:this.pageHeight,ratio:1.5*this.pageWidth/this.pageHeight},a(this),this.epubScreenElement=i,this.onResizeTimer=null,window.addEventListener(e.Param.eventResize,r.bind(this)),r.bind(this)()}function a(e){var t=!0;return(e.screenSize.width!==e.innerWidth||e.screenSize.height!==e.innerHeight)&&(t=!1),e.screenSize.width=e.innerWidth,e.screenSize.height=e.innerHeight,e.screenSize.ratio=e.screenSize.width/e.screenSize.height,t}function n(e){e.parent.switchPageBySpread(e.screenSize.width>e.screenSize.height?2:1)}function i(e){e.parent.switchPageBySpread(e.screenSize.ratio>e.pageSize.ratio?2:1)}function r(){return clearTimeout(this.onResizeTimer),a(this)===!0?(this.switchLandScapeUsingPageSize===!0?i(this):n(this),void this.parent.updateSpreadsSize()):void(this.onResizeTimer=setTimeout(r.bind(this),100))}return Object.defineProperty(t.prototype,"pagesBySpreadMax",{get:function(){return this.config.pagesBySpreadMax}}),Object.defineProperty(t.prototype,"pageWidth",{get:function(){return this.config.pageWidth}}),Object.defineProperty(t.prototype,"pageHeight",{get:function(){return this.config.pageHeight}}),Object.defineProperty(t.prototype,"switchLandScapeUsingPageSize",{get:function(){return this.config.switchLandScapeUsingPageSize}}),Object.defineProperty(t.prototype,"innerWidth",{get:function(){return window.innerWidth}}),Object.defineProperty(t.prototype,"innerHeight",{get:function(){return window.innerHeight}}),t.prototype.forceResize=function(){r.bind(this)()},t}()}(webpublicationNamespace),function(e){"use strict";e.Class.EpubPage=function(){function t(t,a,n){this.parent=t,this.config=a,this.pageIndex=n,this.element=document.createElement("div"),i(this.element,n),this.inCache=!1,this.isOnLoad=!1,this.urlPage=null,this.epubPageEnrichment=new e.Class.EpubPageEnrichment(this,this.element),this.loadList=[],this._lastSpreadOffset=0,this._spreadOffset=0}function a(e){return 0===e._spreadOffset&&e._spreadOffset!==e._lastSpreadOffset?void e.epubPageEnrichment.start():void e.epubPageEnrichment.stop()}function n(e,t,a){return t.innerHTML=a,t}function i(e,t){e.classList.add("spread-page-"+t),e.classList.add("webpub-viewer__epub-container-spread-page")}function r(e,t){return e.inCache===!0?void t.bind(e)(!0):void e.loadList.push(t)}Object.defineProperty(t.prototype,"src",{set:function(e){this.inCache!==!0&&(this.urlPage=e)}}),Object.defineProperty(t.prototype,"onload",{set:function(e){r(this,e)}}),Object.defineProperty(t.prototype,"atSpreadOffset",{set:function(e){this._lastSpreadOffset=this._spreadOffset,this._spreadOffset=e}});var o=function(){var t=function(e){this.inCache=!0,this.isOnLoad=!1,n(this,this.element,e.responseText),a(this),s(this,!0)},i=function(){this.inCache=!1,this.isOnLoad=!1,s(this,!1)};return function(n){return 3===n.pageIndex,n.inCache===!0?void a(n):void(n.isOnLoad!==!0&&(n.isOnLoad=!0,e.Utils.promiseXHR("GET",n.urlPage).then(t.bind(n))["catch"](i.bind(n))))}}(),s=function(){var e=0,t=0;return function(a,n){for(e=0,t=a.loadList.length;t>e;e++)a.loadList[e].bind(a)(n);a.loadList=[]}}();return t.prototype.syncElemWithSpread=function(e){return o(this),this.element},t.prototype.epubPageEnrichmentStat=function(){a(this)},t.prototype.flush=function(){return this.inCache!==!1?(this.loadList=[],this.inCache=!1,this.element.innerHTML="",this.element):void 0},t}()}(webpublicationNamespace),function(w){"use strict";w.Class.EpubPageEnrichment=function(){function EpubPageEnrichment(e,t){this.parent=e,this.element=t,this.element.scriptCtx=this,this.eventListeners=[],this.enableRegisterInteractiveHandlers=!1,this.epubAnimationsData={actions:[]}}function removeEventListeners(e){for(var t=0,a=e.eventListeners.length;a>t;t++)e.eventListeners[t].element.removeEventListener(e.eventListeners[t].type,e.eventListeners[t].func,e.eventListeners[t].useCapture);e.eventListeners=[]}function addToEventListeners(e,t,a,n,i){t.addEventListener(n,a,i),e.eventListeners.push({element:t,type:n,func:a,useCapture:i})}function getActionHistoryTemplate(){return{func:null,args:[]}}function reloadActionHistory(e){for(var t=e.epubAnimationsData.actions.length;t--;)e.epubAnimationsData.actions[t].func(e.epubAnimationsData.actions[t].args[0],e.epubAnimationsData.actions[t].args[1]);e.epubAnimationsData.actions=[]}function RegisterInteractiveHandlers(e){RegisterButtonEventHandlers(e),ProcessAnimations(e),ProcessMediaGesture(e)}function ProcessMediaGesture(e){for(var t=e.element.querySelectorAll("video,audio"),a=0;a<t.length;a++)addToEventListeners(e,t[a],onMediaChange.bind(e,e.element),"volumechange",!0),addToEventListeners(e,t[a],onMediaChange.bind(e,e.element),"seeking",!0)}function ProcessMedia(ctx){for(var oFrame=ctx.element.querySelectorAll("._idGenMedia"),i=0;i<oFrame.length;i++){var actions=oFrame[i].getAttribute("data-mediaOnPageLoadActions");if(actions)for(var descendants=oFrame[i].querySelectorAll("video,audio"),j=0;j<descendants.length;j++)if(descendants[j].paused){var selfContainerID=descendants[j];selfContainerID.scriptCtx=ctx,eval(actions)}}}function ProcessAnimations(ctx){for(var oFrame=ctx.element.querySelectorAll("._idGenAnimation"),i=0;i<oFrame.length;i++){var actions=oFrame[i].getAttribute("data-animationOnPageLoadActions");if(actions){var selfContainerID=oFrame[i];selfContainerID.scriptCtx=ctx,eval(actions)}var cn=oFrame[i].className;if(-1!=cn.indexOf("_idGenCurrentState")){var actions=oFrame[i].getAttribute("data-animationOnStateLoadActions");if(actions){var selfContainerID=oFrame[i];selfContainerID.scriptCtx=ctx,eval(actions)}}actions=oFrame[i].getAttribute("data-animationOnSelfClickActions"),actions&&(addToEventListeners(ctx,oFrame[i],onTouchEndForAnimations.bind(ctx,ctx.element),"touchend",!1),addToEventListeners(ctx,oFrame[i],onMouseUpForAnimations.bind(ctx,ctx.element),"mouseup",!1)),actions=oFrame[i].getAttribute("data-animationOnSelfRolloverActions"),actions&&addToEventListeners(ctx,oFrame[i],onMouseOverForAnimations.bind(ctx,ctx.element),"mouseover",!1)}addToEventListeners(ctx,ctx.element,onPageTouchEndForAnimations.bind(ctx,ctx.element),"touchend",!1),addToEventListeners(ctx,ctx.element,onPageMouseUpForAnimations.bind(ctx,ctx.element),"mouseup",!1)}function onMediaChange(e,t){this.makeDefaultPreventGesture()}function onPageTouchEndForAnimations(element,event){for(var oFrame=element.querySelectorAll("._idGenAnimation"),i=0;i<oFrame.length;i++){var actions=oFrame[i].getAttribute("data-animationOnPageClickActions");if(actions){var selfContainerID=oFrame[i];selfContainerID.scriptCtx=ctx,eval(actions)}}}function onPageMouseUpForAnimations(element,event){var is_touch_device="ontouchstart"in document.documentElement;if(!is_touch_device)for(var oFrame=element.querySelectorAll("._idGenAnimation"),i=0;i<oFrame.length;i++){var actions=oFrame[i].getAttribute("data-animationOnPageClickActions");if(actions){var selfContainerID=oFrame[i];selfContainerID.scriptCtx=ctx,eval(actions)}}}function onTouchEndForAnimations(element,event){for(var classID="."+element.getAttribute("data-animationObjectType"),oFrame=element.querySelectorAll(classID),i=0;i<oFrame.length;i++){var actions=oFrame[i].getAttribute("data-animationOnSelfClickActions");if(actions){var selfContainerID=oFrame[i];selfContainerID.scriptCtx=ctx,eval(actions)}}}function onMouseUpForAnimations(element,event){var is_touch_device="ontouchstart"in document.documentElement;if(!is_touch_device)for(var classID="."+element.getAttribute("data-animationObjectType"),oFrame=element.querySelectorAll(classID),i=0;i<oFrame.length;i++){var actions=oFrame[i].getAttribute("data-animationOnSelfClickActions");if(actions){var selfContainerID=oFrame[i];selfContainerID.scriptCtx=ctx,eval(actions)}}}function onMouseOverForAnimations(element,event){
var is_touch_device="ontouchstart"in document.documentElement;if(!is_touch_device){var animationClassName=element.getAttribute("data-idGenAnimationClass"),cn=element.className;if(-1==cn.indexOf(animationClassName))for(var classID="."+element.getAttribute("data-animationObjectType"),oFrame=element.querySelectorAll(classID),i=0;i<oFrame.length;i++){var actions=oFrame[i].getAttribute("data-animationOnSelfRolloverActions");if(actions){var selfContainerID=oFrame[i];selfContainerID.scriptCtx=ctx,eval(actions)}}}}function RegisterButtonEventHandlers(e){for(var t=e.element.querySelectorAll("._idGenButton"),a=0;a<t.length;a++)t[a].scriptCtx=e,addToEventListeners(e,t[a],onTouchStart.bind(e,t[a]),"touchstart",!1),addToEventListeners(e,t[a],onTouchEnd.bind(e,t[a]),"touchend",!1),addToEventListeners(e,t[a],onMouseDown.bind(e,t[a]),"mousedown",!1),addToEventListeners(e,t[a],onMouseUp.bind(e,t[a]),"mouseup",!1),addToEventListeners(e,t[a],onMouseOver.bind(e,t[a]),"mouseover",!1),addToEventListeners(e,t[a],onMouseOut.bind(e,t[a]),"mouseout",!1)}function hasAppearance(e,t){for(var a=e.children,n=0;n<a.length;n++){var i=a[n].className;if(-1!=i.indexOf(t))return!0}return!1}function isDescendantOf(e,t){for(var a=e;a;){if(a==t)return!0;a=a.parentNode}return!1}function addClass(e,t){actionHistoryTemplate=getActionHistoryTemplate(),actionHistoryTemplate.func=removeClass,actionHistoryTemplate.args.push(e),actionHistoryTemplate.args.push(t),e.scriptCtx.epubAnimationsData.actions.push(actionHistoryTemplate);var a=e.className;-1==a.indexOf(t)&&(""!=a&&(t=" "+t),e.className=a+t)}function removeClass(e,t){var a=e.className,n=new RegExp("\\s?\\b"+t+"\\b","g");a=a.replace(n,""),a!==e.className&&(actionHistoryTemplate=getActionHistoryTemplate(),actionHistoryTemplate.func=addClass,actionHistoryTemplate.args.push(e),actionHistoryTemplate.args.push(t),e.scriptCtx.epubAnimationsData.actions.push(actionHistoryTemplate)),e.className=a}function onMouseDown(element,event){var is_touch_device="ontouchstart"in document.documentElement;if(!is_touch_device){hasAppearance(element,"_idGen-Appearance-Click")&&addClass(element,"_idGenStateClick");var actions=element.getAttribute("data-clickactions");actions&&eval(actions)}}function onMouseUp(element,event){var is_touch_device="ontouchstart"in document.documentElement;if(!is_touch_device){removeClass(element,"_idGenStateClick");var actions=element.getAttribute("data-releaseactions");actions&&eval(actions)}}function onMouseOver(element,event){var is_touch_device="ontouchstart"in document.documentElement;if(!(is_touch_device||event.relatedTarget&&isDescendantOf(event.relatedTarget,element))){hasAppearance(element,"_idGen-Appearance-Rollover")&&addClass(element,"_idGenStateHover");var actions=element.getAttribute("data-rolloveractions");actions&&eval(actions)}}function onMouseOut(element,event){var is_touch_device="ontouchstart"in document.documentElement;if(!(is_touch_device||event.relatedTarget&&isDescendantOf(event.relatedTarget,element))){removeClass(element,"_idGenStateHover"),removeClass(element,"_idGenStateClick");var actions=element.getAttribute("data-rolloffactions");actions&&eval(actions)}}function onTouchStart(element,event){hasAppearance(element,"_idGen-Appearance-Click")&&addClass(element,"_idGenStateClick");var actions=element.getAttribute("data-clickactions");actions&&eval(actions)}function onTouchEnd(element,event){removeClass(element,"_idGenStateClick");var actions=element.getAttribute("data-releaseactions");actions&&eval(actions)}function handleMSOStateParentOfObject(e){for(var t,a=e,n=a.parentNode;n&&!t;){var i=n.className;i&&-1!=i.indexOf("_idGenMSO")?t=!0:a=n,n=a.parentNode}if(t)for(var r,o=a,s=n.children,l=0;r=s[l];l++){var i=r.className;if(-1!=i.indexOf("_idGenCurrentState"))return handleMediaInMSOState(r),removeClass(r,"_idGenCurrentState"),addClass(r,"_idGenStateHide"),removeClass(o,"_idGenStateHide"),void addClass(o,"_idGenCurrentState")}}function handleMediaInMSOState(e){for(var t=e.querySelectorAll("video,audio"),a=0;a<t.length;a++)t[a].paused||(t[a].currentTime=0,t[a].pause())}function playAnimatedElement(e,t,a){removeClass(e,"_idGenStateHide"),removeClass(e,"_idGenPauseAnimation");var n=e.className,i=e.getAttribute("data-idGenAnimationClass");-1==n.indexOf(t)&&-1==n.indexOf(i)?(addClass(e,t),e.setAttribute("data-idGenAnimationClass",t)):(removeClass(e,t),removeClass(e,i),e.removeEventListener("webkitAnimationEnd",function(e){onPlayAnimationEnd(this,a,e)}),e.removeEventListener("animationend",function(e){onPlayAnimationEnd(this,a,e)}),setTimeout(function(){addClass(e,t)},10),e.setAttribute("data-idGenAnimationClass",t)),addToEventListeners(e.scriptCtx,e,onPlayAnimationEnd.bind(e.scriptCtx,e,a),"webkitAnimationEnd"),addToEventListeners(e.scriptCtx,e,onPlayAnimationEnd.bind(e.scriptCtx,e,a),"animationend")}function playAnimation(e,t,a,n){var i=null;if(i="object"==typeof e?e:document.getElementById(e)){handleMSOStateParentOfObject(i);var r=i.getAttribute("data-idGenAnimationStartState"),o=i.getAttribute("data-idGenAnimationEndState");removeClass(i,o),addClass(i,r),setTimeout(function(){playAnimatedElement(i,t,n)},1e3*a)}}function onPlayAnimationEnd(e,t,a){var n=e.getAttribute("data-idGenAnimationClass"),i=e.getAttribute("data-idGenAnimationStartState"),r=e.getAttribute("data-idGenAnimationEndState");removeClass(e,n),removeClass(e,i),addClass(e,r),t&&addClass(e,"_idGenStateHide"),a.stopPropagation()}var actionHistoryTemplate=null;return EpubPageEnrichment.prototype.makeDefaultPreventGesture=function(){w.Class.EpubGesturesEvent.prototype.preventAllGesture()},EpubPageEnrichment.prototype.start=function(){var e=this.element.childNodes[0].getAttribute("data-onload");return null!==e&&-1===e.indexOf("RegisterInteractiveHandlers")?void(this.enableRegisterInteractiveHandlers=!1):(this.enableRegisterInteractiveHandlers=!0,void RegisterInteractiveHandlers(this))},EpubPageEnrichment.prototype.stop=function(){this.enableRegisterInteractiveHandlers!==!1&&(removeEventListeners(this),reloadActionHistory(this))},EpubPageEnrichment}()}(webpublicationNamespace),function(e){"use strict";e.Class.EpubPages=function(){function t(e,t){this.parent=e,this.config=t,this.currentPage=this.config.currentPage,this.pageQuantity=this.config.pageQuantity,this.epubPages=null,this.epubPagesRequested=null,this.setPagesObject()}return t.prototype.setPagesQty=function(){this.epubPages=new Array(this.pageQuantity),this.epubPagesRequested=new Array(this.pageQuantity)},t.prototype.setPageObject=function(t,a){t.src=e.Main.pageManager.getEpubHtml(a)},t.prototype.setPagesObject=function(){this.setPagesQty();for(var t=0;t<this.pageQuantity;t++)this.epubPages[t]=new e.Class.EpubPage(this,this.config,t+1),this.setPageObject(this.epubPages[t],t+1)},t.prototype.pageExist=function(e){return"undefined"!=typeof this.epubPages[e]?!0:!1},t.prototype.pageGetForSpread=function(e){return this.epubPagesRequested[e]=!0,this.epubPages[e]},t.prototype.pageGet=function(e){return this.epubPages[e]},t.prototype.resetRequested=function(){var e=0,t=0;return function(){for(e=0,t=this.pageQuantity-1;t>e;e++)this.epubPagesRequested[e]=!1}}(),t.prototype.flushNotRequested=function(){var e=0,t=0;return function(){for(e=0,t=this.pageQuantity-1;t>e;e++)this.epubPagesRequested[e]===!1&&this.epubPages[e].flush()}}(),t}()}(webpublicationNamespace),function(e){"use strict";e.Class.EpubScrollable=function(){function e(e,t,a){this.parent=e,this.config=t,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.epubSpread=a,this.x=0,this.y=0}return e}()}(webpublicationNamespace),function(e){"use strict";var t=400;e.Class.EpubScrollables=function(){function a(t,a,i){this.parent=t,this.config=a,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.element=i,this.scrollables=[],this.scrollablesLength=0,this.xStart=0,this.yStart=0,this.x=0,this.y=0,this.lastActionForTapGesture=new Array(2),this.epubGesturesEvent=new e.Class.EpubGesturesEvent(this,this.element),this.epubGesturesEvent.addEventListener(this.epubGesturesEvent.GESTURESNAME.SWIPEGESTURE,this.trySwip.bind(this)),this.epubGesturesEvent.addEventListener(this.epubGesturesEvent.GESTURESNAME.PANGESTURE,this.tryDrag.bind(this)),this.epubGesturesEvent.addEventListener(this.epubGesturesEvent.GESTURESNAME.TAPGESTURE,this.checkLastActionForTapGesture.bind(this)),this.epubGesturesEvent.addEventListener(this.epubGesturesEvent.GESTURESNAME.MOUSEWHEELGESTURE,n.bind(null,this)),window.addEventListener("EpubDomApiEvents_gotoPage",this.goToPageFromEvent.bind(this)),window.addEventListener("EpubDomApiEvents_mailto",this.mailtoFromEvent.bind(this))}var n=function(e,t){console.log(t.gestureData.wheel.isX),console.log(t.gestureData.wheel.isY)},i=function(e,t,a){e.xStart=t,e.yStart=a},r=function(){var e=[0,0];return function(t,a,n){return t.x=a-t.xStart,t.y=n-t.yStart,e[0]=t.x,e[1]=t.y,e}}(),o=(function(){var e=[0,0];return function(t){return t.xStart=0,t.yStart=0,t.x=0,t.y=0,e[0]=0,e[1]=0,e}}(),function(){return function(e,t,a){(0!==a[0]||0!==a[1])&&e.parent.gotoPageByCoordsDiff(t.gestureData)}}()),s=function(){var e=0;return function(t,a,n){e=0,t.parent.scrollTo(n[0],n[1])}}();return a.prototype.trySwip=function(e){this.resetLastActionForTapGesture(),e.defaultPreventGesture=!0,o(this,e,r(this,e.clientX,e.clientY))},a.prototype.tryDrag=function(e){this.resetLastActionForTapGesture(),e.defaultPreventGesture=!0,0===e.gestureData.x.pointDiff&&0===e.gestureData.y.pointDiff&&i(this,e.clientX,e.clientY),s(this,e,r(this,e.clientX,e.clientY))},a.prototype.addScrollable=function(t){this.scrollables.push(new e.Class.EpubScrollable(this,this.config,t)),this.scrollablesLength++},a.prototype.goToPageFromEvent=function(e){this.lastActionForTapGesture[0]=Date.now(),this.lastActionForTapGesture[1]=this.parent.goToPage.bind(this.parent,e.args[1])},a.prototype.mailtoFromEvent=function(){var e=function(e){window.location.href=e};return function(t){this.lastActionForTapGesture[0]=Date.now(),this.lastActionForTapGesture[1]=e.bind({},t.args[1])}}(),a.prototype.resetLastActionForTapGesture=function(e){this.lastActionForTapGesture[0]=0,this.lastActionForTapGesture[1]=null},a.prototype.checkLastActionForTapGesture=function(e){return this.lastActionForTapGesture[0]=this.lastActionForTapGesture[0]||0,"function"!=typeof this.lastActionForTapGesture[1]||Date.now()-this.lastActionForTapGesture[0]>t?void this.resetLastActionForTapGesture():(this.lastActionForTapGesture[1](),void this.resetLastActionForTapGesture())},a}()}(webpublicationNamespace),function(e){"use strict";e.Class.EpubSpread=function(){function t(e,t,n,i){this.parent=e,this.config=t,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.mainViewElement=i,this.spreadIndex=n,this.pagesInSpread=[],this.element=null,this.optimizeQuality=!1,this.elementSize={width:0,height:0},this.epubSpreadZoomable=null,this.lastOffset=0,this.spreadOffset=0,a(this)}function a(t){t.element=document.createElement("div"),t.element.ePubData={},t.element.ePubData.optimizeQuality=t.optimizeQuality,t.element.classList.add(t.spreadViewElementClassName),t.element.classList.add(t.spreadViewElementClassName+"-"+t.spreadIndex),t.element.innerHTML="",t.epubSpreadZoomable=new e.Class.EpubSpreadZoomable(t,t.config),t.element.appendChild(t.epubSpreadZoomable.getElement())}function n(e,t,a){return t+e*a}function i(e,t,a){return 1===e.pagesBySpread?0:1===t&&1===a?1:t===e.pageQuantity&&1===a?-1:0}Object.defineProperty(t.prototype,"width",{get:function(){return this.elementSize.width}}),Object.defineProperty(t.prototype,"height",{get:function(){return this.elementSize.height}}),Object.defineProperty(t.prototype,"spreadViewElementClassName",{get:function(){return this.config.spreadViewElementClassName}}),Object.defineProperty(t.prototype,"currentPage",{get:function(){return this.config.currentPage}}),Object.defineProperty(t.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity}}),Object.defineProperty(t.prototype,"firstCoverPage",{get:function(){return this.parent.firstCoverPage}}),Object.defineProperty(t.prototype,"epubPages",{get:function(){return this.parent.epubPages}}),Object.defineProperty(t.prototype,"pagesBySpread",{get:function(){return this.parent.pagesBySpread}}),Object.defineProperty(t.prototype,"htmlVerticalAligner",{get:function(){return this.config.htmlVerticalAligner}});var r=function(){var e=0,t=0,a=0,n=!1;return function(r,o){if(n=!1,e=0,t=0,!o.length)return void r.epubSpreadZoomable.resetContent();for(r.pagesInSpread=o,a=r.pagesInSpread.length,r.epubSpreadZoomable.contentLength!==a&&(n=!0);a>e;e++)-1===r.epubSpreadZoomable.lastContentIDs.indexOf(r.pagesInSpread[e].pageIndex)&&(n=!0);for(e=0,n===!0&&r.epubSpreadZoomable.resetContent(),r.epubSpreadZoomable.contentLength=a,t=i(r,r.pagesInSpread[0].pageIndex,a),r.epubSpreadZoomable.contentPosition=t;a>e;e++)r.pagesInSpread[e].atSpreadOffset=r.spreadOffset,n===!0?r.epubSpreadZoomable.updateContent(r.pagesInSpread[e]):r.pagesInSpread[e].epubPageEnrichmentStat()}}();return t.prototype.displaySpread=function(){this.mainViewElement.appendChild(this.element)},t.prototype.updateSpread=function(){var e=null;return function(t){this.lastOffset=this.spreadOffset,this.spreadOffset=t,this.epubSpreadZoomable.reset(),e=n(t,this.currentPage,this.pagesBySpread),r(this,this.getPagesByPageIndex(e))}}(),t.prototype.updateSpreadSize=function(){return function(){this.elementSize.width=this.element.offsetWidth,this.elementSize.height=this.element.offsetHeight,this.epubSpreadZoomable.updateSize(),this.elementSize.width=this.element.offsetWidth,this.elementSize.height=this.element.offsetHeight}}(),t.prototype.getPagesByPageIndex=function(){var e=null,t=null,a=null,n=0;return function(i){for(n=0,a=[],i-=1,e=~~((i+this.firstCoverPage)/this.pagesBySpread)*this.pagesBySpread,t=e+this.pagesBySpread;t>e;)this.epubPages.pageExist(e-this.firstCoverPage)===!0&&a.push(this.epubPages.pageGetForSpread(e-this.firstCoverPage)),e++;return a}}(),t}()}(webpublicationNamespace),function(e){"use strict";var t=1e-4,a=.8,n=1,i=300;e.Class.EpubSpreadAnimations=function(){function r(e,a,n,i){this.parent=e,this.config=a,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.element=n,this.element.ePubData={},this.element.ePubData.optimizeQuality=!1,this.spreadIndex=i,this.lastOffset=null,this.currentElementPosition={x:0,y:0},this.elementData={x:0,y:0},this.epubTweens={x:null,y:null,scale:null},this.epubTweens.x=new Tween(this.elementData,"x",Tween.strongEaseOut,0,0,t),this.epubTweens.x.onMotionChanged=s.bind(this),this.changedOffsetDate=0,this.epubTweens.y=new Tween(this.elementData,"y",Tween.strongEaseOut,0,0,t),this.epubTweens.y.onMotionChanged=s.bind(this)}function o(e,t,a){return"x"===e.navigationType?(e.currentElementPosition.y=0,t):(e.currentElementPosition.x=0,a)}function s(t){this.currentElementPosition[t.target.prop]=t.target._pos,e.Utils.matrixDom3dAsync(this.element,n,this.currentElementPosition.x,this.currentElementPosition.y)}function l(t,a,i){t.epubTweens[a].stop(),t.epubTweens[a]._pos=i,e.Utils.matrixDom3dAsync(t.element,n,t.currentElementPosition.x,t.currentElementPosition.y)}function u(e,t,a,n){e.epubTweens[t].continueTo(a,n)}return Object.defineProperty(r.prototype,"navigationType",{get:function(){return this.config.navigationType}}),r.prototype.updatePositionSizeOffset=function(e){this.updatePosition(e,0,0)},r.prototype.animatePositionOffset=function(){var e=0,t=0;return function(n){return e=a,0!==n&&(0!==this.lastOffset||null===this.lastOffset)||Date.now()-this.changedOffsetDate<i?(this.changedOffsetDate=Date.now(),this.lastOffset=n,void this.updatePosition(n,0,0)):(this.changedOffsetDate=Date.now(),t=o(this,n*this.mainViewElementSize.width,n*this.mainViewElementSize.height),this.lastOffset=n,void u(this,this.navigationType,t,e))}}(),r.prototype.updatePosition=function(){var e=0;return function(t,a,n){this.lastOffset=t,"x"===this.navigationType?(e=this.currentElementPosition.x=t*this.mainViewElementSize.width+a,this.currentElementPosition.y=0):(this.currentElementPosition.x=0,e=this.currentElementPosition.y=t*this.mainViewElementSize.height+n),l(this,this.navigationType,e)}}(),r}()}(webpublicationNamespace),function(e){"use strict";e.Class.EpubSpreadZoomable=function(){function t(t,n){this.parent=t,this.config=n,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.element=document.createElement("div"),this.element.classList.add(this.zoomableViewElementClassName),this.contentLength=0,this.lastContentIDs=[],this.contentPosition=0,this.timeoutId=null,this.maxPageTotalScale=this.config.maxPageTotalScale,this._pageSizeType={coverTop:o,coverMiddle:r,contain:s,custom:a},this.elementSize={width:0,height:0},this.scale=0,this._x=0,this._y=0,this._xOrigin=0,this._yOrigin=0,this.widthScaled=0,this.heightScaled=0,this.mousedown=!1,this.epubZoom=new e.Class.EpubZoom(this,this.config),this.epubSpreadZoomableAnimations=new e.Class.EpubSpreadZoomableAnimations(this,this.config,this.element),this.epubGesturesEvent=new e.Class.EpubGesturesEvent(this,this.element),this.epubGesturesEvent.addEventListener(this.epubGesturesEvent.GESTURESNAME.DBLTAPGESTURE,this.tryZoom.bind(this)),this.epubGesturesEvent.addEventListener(this.epubGesturesEvent.GESTURESNAME.TAPGESTURE,this.tryClick.bind(this)),this.epubGesturesEvent.addEventListener(this.epubGesturesEvent.GESTURESNAME.PANGESTURE,this.tryDrag.bind(this))}function a(e,t,a){console.log("pageTypeCustom")}function n(e,t){e.epubSpreadZoomableAnimations.animateScale(t,e.spreadOffset)}function i(e,t){e.epubSpreadZoomableAnimations.scaleDrag(t,e.spreadOffset)}Object.defineProperty(t.prototype,"pagesBySpread",{get:function(){return this.config.pagesBySpread}}),Object.defineProperty(t.prototype,"spreadOffset",{get:function(){return this.parent.spreadOffset}}),Object.defineProperty(t.prototype,"width",{get:function(){return this.elementSize.width}}),Object.defineProperty(t.prototype,"height",{get:function(){return this.elementSize.height}}),Object.defineProperty(t.prototype,"pageSizeType",{get:function(){return"function"==typeof this._pageSizeType[this.config.pageSizeType]?this._pageSizeType[this.config.pageSizeType]:this._pageSizeType.contain}}),Object.defineProperty(t.prototype,"htmlVerticalAligner",{get:function(){return this.config.htmlVerticalAligner}}),Object.defineProperty(t.prototype,"zoomableViewElementClassName",{get:function(){return this.config.zoomableViewElementClassName}});var r=function(){var e=0,t=0,a=0,n=0,r=0,o=0,s=0,l=[0,0,0,0,0];return function(u,c,d){return o=u.width,s=u.height,0===o||0===s?!1:(e=c/o,t=d/s,a=t>e?t:e,u.widthScaled=a*u.width,u.heightScaled=a*u.height,n=c/2-u.widthScaled/2,r=d/2-u.heightScaled/2,u.scale!==a&&(u.scale=a,u._x=n,u._y=r,l[0]=a,l[3]=n,l[4]=r,i(u,l)),!0)}}(),o=function(){var e=0,t=0,a=0,n=0,r=0,o=0,s=0,l=[0,0,0,0,0];return function(u,c,d){return o=u.width,s=u.height,0===o||0===s?!1:(e=c/o,t=d/s,a=t>e?t:e,u.widthScaled=a*u.width,u.heightScaled=a*u.height,n=c/2-u.widthScaled/2,r=0,u.scale!==a&&(u.scale=a,u._x=n,u._y=r,l[0]=a,l[3]=n,l[4]=r,i(u,l)),!0)}}(),s=function(){var e=0,t=0,a=0,n=0,r=0,o=0,s=0,l=[0,0,0,0,0];return function(u,c,d){return o=u.width,s=u.height,0===o||0===s?!1:(e=c/o,t=d/s,a=e>t?t:e,u.widthScaled=a*u.width,u.heightScaled=a*u.height,n=0===u.contentPosition?.5*c-.5*u.widthScaled:1===u.contentPosition?c-u.widthScaled:0,r=.5*d-.5*u.heightScaled,n+u.widthScaled>c&&(n-=n+u.widthScaled-c),u.scale!==a&&(u.scale=a,u._x=n,u._y=r,l[0]=a,l[3]=n,l[4]=r,i(u,l)),!0)}}();return t.prototype.tryClick=function(e){},t.prototype.tryZoom=function(){var e=null;return function(t){return t.defaultPreventGesture=!0,e=this.element.getBoundingClientRect(),0!==this.epubZoom.scale?void n(this,this.epubZoom.resetZoom()):void n(this,this.epubZoom.getZoom(t,this.maxPageTotalScale,t.clientX,t.clientY,e))}}(),t.prototype.tryDrag=function(){var e=null,t=null;return function(a){(0!==this.epubZoom.scale||0!==a.gestureData.pinchZoomDiff)&&(e=this.element.getBoundingClientRect(),a.defaultPreventGesture=!0,0===a.gestureData.x.pointDiff&&0===a.gestureData.y.pointDiff&&this.epubZoom.initdrag(a,a.clientX,a.clientY,e),t=this.epubZoom.scale+a.gestureData.pinchZoomDiff*this.config.zoomFactor,this.epubZoom.getZoom(a,t,a.clientX,a.clientY,e),i(this,this.epubZoom.drag(a,a.clientX,a.clientY)))}}(),t.prototype.reset=function(){n(this,this.epubZoom.resetZoom())},t.prototype.resetContent=function(e){this.lastContentIDs=[],this.element.innerHTML=""},t.prototype.updateContent=function(e){this.lastContentIDs.push(e.pageIndex),this.element.appendChild(e.syncElemWithSpread()),e.onload=this.updateSize.bind(this)},t.prototype.getElement=function(){return this.element},t.prototype.updateSize=function(){this.scale=0,this.elementSize.width=this.element.offsetWidth,this.elementSize.height=this.element.offsetHeight,this.pageSizeType(this,this.parent.width,this.parent.height)===!1&&(clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.updateSize.bind(this),16))},t}()}(webpublicationNamespace),function(e){"use strict";var t=1e-4,a=.5;e.Class.EpubSpreadZoomableAnimations=function(){function n(e,a,n){this.parent=e,this.config=a,this.element=n,this.element.ePubData={},this.element.ePubData.optimizeQuality=!1,this.lastOffset=this.parent.lastOffset,this.fromPosition={x:0,y:0,scale:0},this.toPosition={x:0,y:0,scale:0},this.elementData={prc:0},this.epubTweens=new Tween(this.elementData,"prc",Tween.regularEaseInOut,0,0,t),this.epubTweens.onMotionChanged=i.bind(this)}function i(t){this.fromPosition.scale+=(this.toPosition.scale-this.fromPosition.scale)*t.target._pos,this.fromPosition.x+=(this.toPosition.x-this.fromPosition.x)*t.target._pos,this.fromPosition.y+=(this.toPosition.y-this.fromPosition.y)*t.target._pos,e.Utils.matrixDom3dAsync(this.element,this.fromPosition.scale,this.fromPosition.x,this.fromPosition.y)}function r(t){e.Utils.matrixDom3dAsync(t.element,t.toPosition.scale,t.toPosition.x,t.toPosition.y)}function o(e,t){return 0===t?void(e.element.ePubData.optimizeQuality=!0):void(e.element.ePubData.optimizeQuality=!1)}return n.prototype.animateScale=function(e,t){this.lastOffset=this.parent.lastOffset,o(this,t),this.toPosition.scale=e[0],this.toPosition.x=e[3],this.toPosition.y=e[4],this.epubTweens.stop(),this.epubTweens._pos=0,this.epubTweens.continueTo(1,a)},n.prototype.scaleDrag=function(e,t){this.lastOffset=this.parent.lastOffset,o(this,t),this.fromPosition.scale=this.toPosition.scale=e[0],this.fromPosition.x=this.toPosition.x=e[3],this.fromPosition.y=this.toPosition.y=e[4],this.epubTweens.stop(),this.epubTweens._pos=1,r(this)},n}()}(webpublicationNamespace),function(e){"use strict";e.Class.EpubSpreads=function(){function t(t,n,r){this.parent=t,this.config=n,this.viewMain=r,this.screenSize=this.parent.screenSize,this.mainViewElementSize={width:0,height:0},this.mainViewElementClassName=this.config.mainViewElementClassName,this.mainViewElement=null,this.epubSpreads=new Array(this.spreadsLength),this.extractedSpreads=[],this.epubPages=new e.Class.EpubPages(this,this.config),i(this),this.epubScrollables=new e.Class.EpubScrollables(this,this.config,this.mainViewElement),this.epubSpreadsAnimations=new e.Class.EpubSpreadsAnimations(this,this.config,this.epubSpreads,this.mainViewElement),a(this,this.epubSpreads,this.mainViewElement),o(this)}function a(t,a,i){for(var r=0,o=a.length;o>r;r++)a[r]=new e.Class.EpubSpread(t,t.config,r,i),t.epubScrollables.addScrollable(a[r]);t.updateSpreads(a),n(t,a)}function n(e,t){for(var a=0,n=t.length;n>a;a++)t[a].displaySpread()}function i(e){e.mainViewElement=document.createElement("div"),e.mainViewElement.classList.add(e.mainViewElementClassName)}function r(e){e.mainViewElementSize.width=e.mainViewElement.offsetWidth,e.mainViewElementSize.height=e.mainViewElement.offsetHeight,e.mainViewElementSize.rect=e.mainViewElement.getBoundingClientRect()}function o(e){e.viewMain.appendChild(e.mainViewElement)}function s(e,t){return Math.ceil((t+e.firstCoverPage)/e.pagesBySpread)}function l(e,t){return(s(e,t)%e.epubSpreads.length||e.epubSpreads.length)-1}function u(e,t){return e.epubSpreads[l(e,t)]}Object.defineProperty(t.prototype,"currentPage",{get:function(){return this.config.currentPage}}),Object.defineProperty(t.prototype,"firstCoverPage",{get:function(){return this.config.firstCoverPage}}),Object.defineProperty(t.prototype,"pagesBySpread",{get:function(){return this.config.pagesBySpread}}),Object.defineProperty(t.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity}}),Object.defineProperty(t.prototype,"spreadsLength",{get:function(){return this.config.spreadsLength}});var c=function(){var e=0,t=0,a=0,n=null,i=0,r=0,o=0,s=0;return function(c,d){for(a=c.epubSpreads.length,n=new Array(a),t=l(c,d),d=u(c,d).getPagesByPageIndex(d)[0].pageIndex,i=Math.ceil(a/2),r=~~(a/2),s=1+c.pageQuantity-(d+i),0>s&&(r-=s,i+=s),s=d-1-r,0>s&&(r+=s,i-=s),r>=a?(r=a-1,i++):i>=a&&d>1&&(i=a-1,r++),o=0,e=t;a>e&&0!==i;e++)n[e]=o,o++,i--;if(0!==i)for(e=0;i+e>e;e++)n[e]=o,o++,i--;else if(a>e){for(;a>e;e++)n[e]=-r,r--;e=0}else e=0;for(;a>e&&0!==r;e++)n[e]=-r,r--;return n}}();return t.prototype.getSpreadsOffsetByPageIndex=function(e){return c(this,e)},t.prototype.getPagesFromSpreadByPageIndex=function(e){return c(this,e)},t.prototype.updateSpreads=function(){var e=0,t=0,a=0;return function(){for(this.epubPages.resetRequested(),e=0,t=this.epubSpreads.length,a=c(this,this.currentPage);t>e;e++)this.epubSpreads[e].updateSpread(a[e]);this.epubSpreadsAnimations.animatePositionOffset(a),this.epubPages.flushNotRequested()}}(),t.prototype.updateSpreadsSize=function(){var e=0,t=0;return function(){for(r(this),this.epubSpreadsAnimations.updatePositionSizeOffset(),e=0,t=this.epubSpreads.length;t>e;e++)this.epubSpreads[e].updateSpreadSize()}}(),t.prototype.scrollTo=function(e,t){this.epubSpreadsAnimations.updatePosition(e,t)},t.prototype.gotoPageByCoordsDiff=function(e,t){this.parent.gotoPageByCoordsDiff(e,t)},t.prototype.goToPage=function(e){this.parent.goToPage(e)},t}()}(webpublicationNamespace),function(e){"use strict";var t=1e-4,a=1,n=.8;e.Class.EpubSpreadsAnimations=function(){function i(e,a,n,i){this.parent=e,this.config=a,this.epubSpreads=n,this.epubSpreadsLength=n.length,this.mainViewElement=i,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.epubSpreadsData=new Array(this.epubSpreads.length),r(this.epubSpreadsData),this.currentPosition={width:0,height:0,inX:0,inY:0,diffCoord:0},this.elementData={prc:null},this.epubTweens={prc:null},this.epubTweens.prc=new Tween(this.elementData,"prc",Tween.strongEaseOut,0,0,t),this.epubTweens.prc.onMotionChanged=o.bind(this)}function r(e){for(var t=0;t<e.length;t++)e[t]={spreadOffset:0}}function o(e){l(this,this.currentPosition.width,this.currentPosition.height,this.currentPosition.inX,this.currentPosition.inY,this.currentPosition.diffCoord,e.target._pos)}function s(t,n,i,r,o){e.Utils.matrixDom3dAsync(n,a,i,r)}Object.defineProperty(i.prototype,"navigationType",{get:function(){return this.config.navigationType}});var l=function(){var e=0,t=0,a=0,n=0,i=0,r=0,o=0,l=null,u=0;return function(c,d,h,p,g,m,f){for(e=0,t=c.epubSpreadsLength;t>e;e++)u=f,l=c.epubSpreads[e],0!==l.spreadOffset&&0!==l.lastOffset&&(u=1),o=l.spreadOffset-l.lastOffset,i=l.lastOffset*d+o*d*u+m*(1-u),r=l.lastOffset*h+o*h*u+m*(1-u),a=p*i,n=g*r,s(c,l.element,a,n)}}();return i.prototype.updatePositionSizeOffset=function(){this.updatePosition(0,0)},i.prototype.animatePositionOffset=function(){var e=0,t=0,a=0,i=0,r=0;return function(){e=this.epubSpreadsLength,"x"===this.navigationType?(t=1,a=0):(t=0,a=1),i=this.mainViewElementSize.width,r=this.mainViewElementSize.height,this.currentPosition.width=i,this.currentPosition.height=r,this.currentPosition.inX=t,this.currentPosition.inY=a,this.epubTweens.prc.continueTo(1,n)}}(),i.prototype.updatePosition=function(){var e=0,t=0,a=0,n=0,i=0,r=0,o=0,l=0,u=null;return function(c,d){for(e=0,t=this.epubSpreadsLength,this.epubTweens.prc.stop(),o=this.mainViewElementSize.width,l=this.mainViewElementSize.height,this.epubTweens.prc._pos=0,"x"===this.navigationType?(a=1,n=0,this.currentPosition.diffCoord=c):(a=0,n=1,this.currentPosition.diffCoord=d);t>e;e++)u=this.epubSpreads[e],this.epubSpreadsData[e].spreadOffset=u.spreadOffset,i=a*(u.spreadOffset*o+c),r=n*(u.spreadOffset*l+d),s(this,u.element,i,r)}}(),i}()}(webpublicationNamespace),function(e){"use strict";e.Class.EpubZoom=function(){function t(t,a){this.parent=t,this.config=a,this.maxTotalScale=this.config.maxPageTotalScale,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.epubZoomDraggable=new e.Class.EpubZoomDraggable(this,this.config),this.scaleMax=10,this.totalScale=0,this.totalWidth=0,this.totalHeight=0,this.totalX=0,this.totalY=0,this._scale=0,this._x=0,this._y=0,this.xLimited=!1,this.yLimited=!1,this.xLimit=0,this.yLimit=0}function a(e,t,a,n){return n.status=!1,a>t?(n.status=!0,a/2-t/2):e}function n(e,t,a,n,i){if(1===e){if(t+a>0)return-t;if(i>t+a+n)return i-(t+n)}return a}return Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e}}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e}}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e}}),Object.defineProperty(t.prototype,"scaleOrig",{get:function(){return this.parent.scale}}),Object.defineProperty(t.prototype,"xOrig",{get:function(){return this.parent._x}}),Object.defineProperty(t.prototype,"yOrig",{get:function(){return this.parent._y}}),Object.defineProperty(t.prototype,"widthOrig",{get:function(){return this.parent.width}}),Object.defineProperty(t.prototype,"heightOrig",{get:function(){return this.parent.height}}),t.prototype.setMaxX=function(){var e={status:!0};return function(){return this.totalX=a(this.totalX,this.totalWidth,this.mainViewElementSize.width,e),e.status}}(),t.prototype.setMaxY=function(){var e={status:!0};return function(){return this.totalY=a(this.totalY,this.totalHeight,this.mainViewElementSize.height,e),e.status}}(),t.prototype.getZoom=function(){var e=[0,0,0,0,0],t=0,a=0,i=0,r=0,o=0,s=0,l=0,u=0,c=0,d=0;return function(h,p,g,m,f){return l=g-f.left,u=m-f.top,p=p||0,l=l||0,u=u||0,i=this.scale,this.scale=p,o=this.x,s=this.y,this.scale+this.scaleOrig<this.scaleOrig?this.scale=0:this.scale+this.scaleOrig>this.maxTotalScale&&(this.scale=this.maxTotalScale-this.scaleOrig),this.totalScale=this.scale+this.scaleOrig,r=this.scaleOrig+i,t=l/(this.widthOrig*r),a=u/(this.heightOrig*r),c=this.widthOrig*this.totalScale,d=this.heightOrig*this.totalScale,this.x=(this.widthOrig*r-c)*t,this.y=(this.heightOrig*r-d)*a,this.x+=o,this.y+=s,this.totalX=this.xOrig+this.x,this.totalY=this.yOrig+this.y,this.totalWidth=c,this.totalHeight=d,this.xLimited=this.setMaxX(),this.yLimited=this.setMaxY(),this.xLimit=this.xLimited?0:1,this.yLimit=this.yLimited?0:1,this.totalX=n(this.xLimit,this.epubZoomDraggable.totalX,this.totalX,c,this.mainViewElementSize.width),this.totalY=n(this.yLimit,this.epubZoomDraggable.totalY,this.totalY,d,this.mainViewElementSize.height),e[0]=this.totalScale,e[1]=0,e[2]=0,e[3]=this.epubZoomDraggable.totalX+this.totalX,e[4]=this.epubZoomDraggable.totalY+this.totalY,e}}(),t.prototype.resetZoom=function(){var e=[0,0,0,0,0];return function(){return this.epubZoomDraggable.resetdrag(),this.scale=0,this.x=0,this.y=0,this.totalX=0,this.totalY=0,this.totalScale=0,e[0]=this.scaleOrig,e[1]=0,e[2]=0,e[3]=this.xOrig,e[4]=this.yOrig,e}}(),t.prototype.initdrag=function(e,t,a,n){return this.epubZoomDraggable.initdrag(e,t,a,n)},t.prototype.drag=function(e,t,a){return this.epubZoomDraggable.drag(e,t,a)},t.prototype.resetdrag=function(){return this.epubZoomDraggable.resetdrag()},t}()}(webpublicationNamespace),function(e){"use strict";

e.Class.EpubZoomDraggable=function(){function e(e,t){this.parent=e,this.epubZoom=this.parent,this.config=t,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.xRect=0,this.yRect=0,this.xStart=0,this.yStart=0,this.totalX=0,this.totalY=0,this._x=0,this._y=0,this.xLimit=1,this.yLimit=1}function t(e,t,a,n,i){if(1===e){if(t+a>0)return-t;if(i>t+a+n)return i-(t+n)}return a}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e}}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e}}),Object.defineProperty(e.prototype,"scaleOrig",{get:function(){return this.parent.scale}}),Object.defineProperty(e.prototype,"xOrig",{get:function(){return this.parent.xOrig}}),Object.defineProperty(e.prototype,"yOrig",{get:function(){return this.parent.yOrig}}),e.prototype.initdrag=function(e,t,a,n){this.xRect=n.left,this.yRect=n.top,this.xStart=t-this.xRect-this.x,this.yStart=a-this.yRect-this.y},e.prototype.drag=function(){var e=[0,0,0,0,0],a=0,n=0,i=0,r=0;return function(o,s,l){return this.xLimit=this.parent.xLimited?0:1,this.yLimit=this.parent.yLimited?0:1,this.totalX=this.x=(s-this.xRect-this.xStart)*this.xLimit,this.totalY=this.y=(l-this.yRect-this.yStart)*this.yLimit,i=this.totalX,r=this.totalY,a=this.epubZoom.totalX||this.xOrig,n=this.epubZoom.totalY||this.yOrig,this.totalX=this.x=t(this.xLimit,a,this.x,this.parent.totalWidth,this.mainViewElementSize.width),this.totalY=this.y=t(this.yLimit,n,this.y,this.parent.totalHeight,this.mainViewElementSize.height),this.totalX-i!==0&&(console.log(this.totalX-i),o.currentTarget.epubGesturesEvent.resetMoveXDifferer()),this.totalY-r!==0&&(console.log(this.totalY-r),o.currentTarget.epubGesturesEvent.resetMoveYDifferer()),e[0]=this.epubZoom.totalScale||this.epubZoom.scaleOrig,e[1]=0,e[2]=0,e[3]=a+this.x,e[4]=n+this.y,e}}(),e.prototype.resetdrag=function(){var e=[0,0,0,0,0];return function(){return this.xStart=0,this.yStart=0,this.totalX=0,this.totalY=0,this.x=0,this.y=0,e[0]=this.epubZoom.totalScale||this.epubZoom.scaleOrig,e[1]=0,e[2]=0,e[3]=this.epubZoom.totalX||this.xOrig,e[4]=this.epubZoom.totalY||this.yOrig,e}}(),e}()}(webpublicationNamespace),function(e){function t(t,a){var n=t.querySelectorAll("[data-action='close']");n=Array.prototype.slice.call(n),t.hasAttribute("data-action")&&"close"===t.getAttribute("data-action")&&n.push(t);for(var i=0;i<n.length;i++)n[i].addEventListener(e.Param.eventClick,m.close.bind(null,a))}function a(t){var a=t.querySelectorAll("[data-action='menu']");a=Array.prototype.slice.call(a),t.hasAttribute("data-action")&&"menu"===t.getAttribute("data-action")&&a.push(t);for(var n=0;n<a.length;n++)a[n].addEventListener(e.Param.eventClick,NIApi.menu.toggle.bind(null))}function n(t,a){if(this.params.disableOverlay!==!0){var n=t.querySelectorAll("[data-action='overlay']");n=Array.prototype.slice.call(n),t.hasAttribute("data-action")&&"overlay"===t.getAttribute("data-action")&&n.push(t);for(var i=0;i<n.length;i++)n[i].addEventListener(e.Param.eventClick,r.bind(n[i],a))}}function i(e){var t=e.querySelectorAll("[data-section='header']");t=Array.prototype.slice.call(t),e.hasAttribute("data-section")&&"header"===e.getAttribute("data-section")&&t.push(e);for(var a=0;a<t.length;a++)"none"===this.params.header?t[a].style.display="none":"invisible"===this.params.header&&(t[a].style.display="none")}function r(e,t){t.target===this&&m.close.call(null,e)}function o(e){for(var t,a=0;a<this.tpl.length;a++){var n=this.tpl[a].querySelector("[data-section='"+e+"']");n&&(t=n)}return t}function s(e){var t=e.querySelectorAll("iframe");Array.prototype.slice.call(t).forEach(function(e){"complete"===e.readyState?l.call(e):e.addEventListener("load",l)})}function l(){this.parentNode.style.display="none",this.parentNode.offsetHeight,this.parentNode.style.display=""}function u(e){}function c(){e.Main.urlManager["delete"]("lightbox")}function d(e){this.parentNode.removeChild(this),e.params.onclose&&e.params.onclose()}function h(){return g.call(this),Promise.resolve()}function p(){f[this.params.id]&&(f[this.params.id].params.animation="none",this.close(this.params.id),this.params.animation="none"),f[this.params.id]=this;var r;w.indexOf(this.params.theme)>-1?r=e.Utils.resolveVariable("${root}mobile/template/lightbox-"+this.params.theme+".html"):(r=e.Utils.resolveVariable("${template}html/template/lightbox-"+this.params.theme+".html"),e.require(["../../${template}html/template/lightbox-"+this.params.theme+".css"]));var o=this.params.target||e.Param.viewMain,l={id:this.params.id,height:this.params.height,width:this.params.width,title:this.params.title,priority:this.params.priority,animation:this.params.animation,header:this.params.header,headerSpacer:this.params.headerSpacer,menuButton:this.params.menuButton,closeButton:this.params.closeButton,position:this.params.position};this.params.url&&(l.url=e.Utils.addParamsToUrl(this.params.url,"_zonesecure_sessionID="+e.Param.sessionId),e.Main.trackerManager.trackEvent({name:"lightboxOpen",variables:{1:this.params.url}})),this.params.activeElement&&e.Main.menuManager.setActive(this.params.activeElement),e.Main.templateManager.loadAppend(r,o,l).then(function(r){this.tpl=r;for(var o,l=0;l<r.length;l++){i.call(this,r[l]),a.call(this,r[l]),t.call(this,r[l],this.params.id),n.call(this,r[l],this.params.id),s.call(this,r[l]);var u=r[l].querySelector("[data-section='content']");u&&(o=u),o&&this.params.html&&this.setHTML(this.params.html),this.params.DOMcloseButton&&this.setHTML(this.params.DOMcloseButton.innerHTML,"right")}return this.params.subtemplate?o?e.Main.templateManager.load(this.params.subtemplate.url,o,this.params.subtemplate.params).then(e.Utils.promiseTimeout.bind({},16)).then(h.bind(this)):void console.error('You need one data-section="content" in your lightbox template'):e.Utils.promiseTimeout(16).then(h.bind(this))}.bind(this))}function g(){e.Param.viewBody.setAttribute("data-lightbox",this.params.id),window.setTimeout(function(){var t=o.call(this,"content");"theater"===this.params.theme&&t&&"100%"===t.style.height&&e.Param.userAgent.browser.name===e.Param.userAgent.BROWSER.SAFARI&&(t.style.height="calc(100% - 108px)"),e.Main.menuManager.hideMenu();for(var a=0;a<this.tpl.length;a++)this.tpl[a].classList.add("webpub--active");this.params.onload&&this.params.onload.call(this,this.tpl,{rightSection:o.call(this,"right")})}.bind(this),16)}function m(t){if(this.params=t||{},this.params.theme=this.params.theme||"default",this.params.position=this.params.position||"bottom",this.params.priority=this.params.priority||"normal",this.params.header=this.params.header||"visible",this.params.headerSpacer=this.params.headerSpacer!==!1,this.params.menuButton=this.params.menuButton||!1,this.params.id=this.params.id||btoa(Math.random()).replace(/=/g,""),"undefined"==typeof this.params.closeButton&&(this.params.closeButton=!0),"string"!=typeof this.params.closeButton&&"boolean"!=typeof this.params.closeButton&&(this.params.DOMcloseButton=this.params.closeButton,this.params.closeButton=""),this.params.url&&(this.params.url=e.Utils.resolveVariable(this.params.url)),this.params.height&&this.params.height.match(/^[0-9]+$/)&&(this.params.height+="px"),this.params.width&&this.params.width.match(/^[0-9]+$/)&&(this.params.width+="px"),this.params.animation="default"===this.params.theme?this.params.animation||"slideup":"theater"===this.params.theme?this.params.animation||"fadepop":"modale"===this.params.theme?this.params.animation||"fadepop":"page"===this.params.theme?this.params.animation||"fadepop":"panel"===this.params.theme?this.params.animation||"fadeslideup":this.params.animation||"fade",["theater","modale","panel"].indexOf(this.params.theme)>-1&&-1===this.params.animation.indexOf("fade")){var a="fade"+this.params.animation;y.indexOf(a)>-1&&(this.params.animation="fade"+this.params.animation)}"false"===this.params.header&&(this.params.header="none"),e.Utils._assertString(this.params.theme,"The theme key must be string"),e.Utils._assertBoolean(this.params.menuButton,"The menuButton key must be boolean"),e.Utils._assertBoolean(this.params.headerSpacer,"The headerSpacer key must be boolean"),e.Utils._assertOneOf(this.params.animation,y,"The animation key must be one of: "+y.join(", ")),e.Utils._assertOneOf(this.params.header,v,"The header key must be one of: "+v.join(", ")),e.Utils._assertOneOf(this.params.priority,b,"The priority key must be one of: "+b.join(", ")),u.call(this,this.params),e.Utils._assertString(this.params.id,"You need a lightbox ID"),p.call(this)}var f={},v=["visible","none","invisible"],b=["normal","high"],y=["none","slideup","slidedown","slideleft","slideright","fade","pop","fadeslideup","fadeslidedown","fadeslideleft","fadeslideright","fadepop"],w=["default","theater","modale","page","panel"];m.prototype.close=function(t){if("undefined"!=typeof f[t]){f[t].params.url&&e.Main.trackerManager.trackEvent({name:"lightboxClose",variables:{1:f[t].params.url}}),c(),document.activeElement&&document.activeElement.blur&&document.activeElement.blur();for(var a="none"===f[t].params.animation?0:500,n=0;n<f[t].tpl.length;n++)f[t].tpl[n].classList.remove("webpub--active"),window.setTimeout(d.bind(f[t].tpl[n],f[t]),a);e.Param.viewBody.removeAttribute("data-lightbox"),delete f[t]}},m.prototype.closeAll=function(e){var t=e?e.except:[];for(var a in f)-1===t.indexOf(a)&&m.close(a)},m.prototype.get=function(e){return f[e]},m.prototype.getLength=function(){return Object.keys(f).length},m.prototype.exists=function(e){return f.hasOwnProperty(e)},m.prototype.setSubtemplate=function(t,a){"undefined"==typeof a&&(a="content");var n=o.call(this,a);if(n){this.params.onload=t.onload,this.params.subtemplate.params=t;var i=e.Main.templateManager.load(this.params.subtemplate.url,n,this.params.subtemplate.params);return t.onload&&(i=i.then(e.Utils.promiseTimeout.bind({},16)).then(h.bind(this))),i}console.error('You need one data-section="content" in your lightbox template')},m.prototype.setHTML=function(e,t){"undefined"==typeof t&&(t="content");var a=o.call(this,t);return a&&("string"==typeof e?a.innerHTML=e:null!==e&&(a.innerHTML="",a.appendChild(e))),Promise.resolve()},m.prototype.setTitle=function(e){var t=o.call(this,"title");t&&("string"==typeof e&&(e=document.createTextNode(e)),t.innerHTML="",t.appendChild(e))},m.prototype.setUrl=function(e){var t=o.call(this,"iframe");t&&(t.src=e)},m.close=m.prototype.close,m.closeAll=m.prototype.closeAll,m.get=m.prototype.get,m.getLength=m.prototype.getLength,e.Class.LightboxManagerNew=m,NIApi.register("lightbox.open",function(t,a){if(null===t)return Promise.resolve(new e.Class.LightboxManagerNew(a));var n={},i=arguments;"url"!==t&&(i=a.split("/"),n.url=t);for(var r=0;r<i.length;r+=2)n[i[r]]=i[r+1];return Promise.resolve(new e.Class.LightboxManagerNew(n))}),NIApi.register("lightbox.openPopup",function(t,a){if(null===t)return Promise.resolve(new e.Class.LightboxManagerNew(a));var n={},i=arguments;"url"!==t&&(i=a.split("/"),n.url=t);for(var r=0;r<i.length;r+=2)n[i[r]]=i[r+1];return Promise.resolve(new e.Class.LightboxManagerNew(n))}),NIApi.register("lightbox.closeAll",function(){return Promise.resolve(new e.Class.LightboxManagerNew.closeAll)}),NIApi.register("lightbox.close",function(t){return Promise.resolve(new e.Class.LightboxManagerNew.close(t))}),NIApi.register("lightbox.getOpenList",function(e){return Promise.resolve(Object.keys(f))})}(webpublicationNamespace),function(e){function t(){i=e.Starter._CONFIG.pages.beginPage}function a(e,t){return e.index-t.index}function n(t){for(var a=t.length;a--;)t[a].content.forEach(function(n){if(n.circle)t[a].type="circle";else if(n.text)t[a].type="text";else if(n.file){"/"===n.file.url[n.file.url.length-1]&&-1===n.file.url.indexOf("http:")&&(n.file.url+="index.html");var i=/(?:\.([^.]+))?$/.exec(n.file.url)[1];i?(i=i.toUpperCase(),["JPG","JPEG","PNG","SVG","GIF"].indexOf(i)>=0?t[a].type="image":"JSON"===i?t[a].type="swiffy":"HTML"===i.substring(0,4)?(t[a].content[0].file.url=e.Utils.addParamsToUrl(t[a].content[0].file.url,"_zonesecure_sessionID="+e.Param.sessionId),t[a].type="iframe"):t[a].type="boh"):t[a].type="boh"}else t[a].type=n.roundrect?"roundrect":n.rect?"rect":n.roundrectcomplex?"roundrectcomplex":n.symbol?"symbol":n.video?"video":"boh";n.x=parseInt(n.x),n.y=parseInt(n.y),n.width=parseInt(n.width),n.height=parseInt(n.height)});return t}var i,r={},o={},s="zoom";t.prototype.getCurrent=function(){return e.Param.newViewerVersion?e.Main.pagesLoaderNew.getCurrentPage():e.Main.pagesLoader.pageCurrentOriginalIs},t.prototype.getImage=function(t,a){if("undefined"==typeof a&&(a=e.Main.pageManager.getCurrent()),"mdpi"===t)return e.Main.xmlManager.get("common-configuration","contents","low","path").replace("%num%",a);if("ldpi"===t){var n=e.Main.xmlManager.get("common-configuration","contents","thumbnails_xdpi","path"),i=e.Main.xmlManager.get("common-configuration","contents","thumbnails","path");return n?n.replace("%num%",a):i.replace("%num%",a)}return"svg"===t?e.Main.xmlManager.get("common-configuration","contents","svg","path").replace("%num%",a):e.Main.xmlManager.get("common-configuration","contents",s,"path").replace("%num%",a)},t.prototype.getEpubHtml=function(t){return"undefined"==typeof t&&(page=e.Main.pageManager.getCurrent()),e.Main.xmlManager.get("common-configuration","contents","epub-HTML","path").replace("%num%",t)},t.prototype.hasLinks=function(e){return r[e]?!0:!1},t.prototype.getLinks=function(t){return(r[t]||[]).filter(function(t){return"single"===t.layout&&2===this.pagePerScreen()?!1:"double"===t.layout&&1===this.pagePerScreen()?!1:"landscape"===t.orientation&&e.Param.isPortrait===!0?!1:"portrait"===t.orientation&&e.Param.isPortrait===!1?!1:!0},this)},t.prototype.getLinksPromise=function(t){return r[t]?!0:(void 0===o[t]?(o[t]=new Promise(function(i,s){var l=new XMLHttpRequest,u=e.Main.xmlManager.get("common-configuration","contents","links","path").replace("%num%",t);l.open("GET",u,!0),l.onreadystatechange=function(){if(4===l.readyState){for(var s=[],u=null,c=l.responseXML?l.responseXML.querySelectorAll("lk"):[],d=0;d<c.length;d++)if(u=c[d].getAttribute("aim"),null===u||-1!==u.split(",").indexOf("html")){for(var h={index:c[d].getAttribute("index")||null,id:c[d].getAttribute("id")||null,layout:c[d].getAttribute("layout")||null,orientation:c[d].getAttribute("orientation")||null,useract:[],content:[]},p=c[d].querySelectorAll("content"),g=0;g<p.length;g++){var m,f={y:p[g].getAttribute("y"),x:p[g].getAttribute("x"),width:p[g].getAttribute("width"),height:p[g].getAttribute("height"),id:p[g].getAttribute("id")},v=p[g].querySelector("*");f[v.tagName]={};for(var b=0;b<v.attributes.length;b++)m=v.attributes[b].value,f[v.tagName][v.attributes[b].name]="true"===m?!0:"false"===m?!1:e.Utils.resolveVariable(m);v.textContent&&(f.textContent=v.textContent),h.content.push(f)}for(var y=c[d].querySelectorAll("useract"),w=0;w<y.length;w++){for(var C={},M=0;M<y[w].attributes.length;M++)C[y[w].attributes[M].name]=y[w].attributes[M].value;C.textField=y[w].textContent,h.useract.push(C)}s.push(h)}s=n(s.sort(a)),r[t]=s,i(s),o[t]=void 0,delete o[t]}},l.send()}),o[t].isNew=!0):o[t].isNew=!1,o[t])},t.prototype.pagePerScreen=function(){var t=e.Main.xmlManager.get("common-ui","configs","pageLayout");return"single"===t?function(){return 1}:"double"===t?function(){return 2}:function(){var t=e.Main.xmlManager.get("common-configuration","contents","zoom","width"),a=e.Main.xmlManager.get("common-configuration","contents","zoom","height");return t>a?1:e.Param.isPortrait?1:2}}(),t.prototype.pagesOnFirstScreen=function(){return 1},t.prototype.getBackgroundColor=function(t){return e.Main.commonLayout.get("pages."+t+".backgroundColor")||"transparent"},t.prototype.set=function(t){e.Main.xmlManager.get("common-ui","configs","deepLinking")===!0&&t!==i&&(i=t,e.Main.urlManager.set("page",t))},t.prototype.onChange=function(){var t=[];return window.addEventListener("hashchange",function(a){e.Main.urlManager.init();var n=parseInt(e.Main.urlManager.get("page"),10);if(n!==i)for(var r=0;r<t.length;r++)t[r](n)}),function(e){t.push(e)}}(),t.prototype.init=function(){var t=screen.height||window.innerHeight,a=screen.width||window.innerWidth,n=!0;e.Param.isDesktop===!1&&Math.max(t,a)*window.devicePixelRatio<=1300&&(n=!1),e.Main.performanceManager.checkPerformanceLevel(6)&&null!==e.Main.xmlManager.get("common-configuration","contents","zoom_hd","path")&&n&&(s="zoom_hd")},e.Class.PageManager=t}(webpublicationNamespace),function(e){function t(){NIApi.register("page.downloadPDF",function(t){return Promise.resolve(e.Main.pdfManager.download(t.toUpperCase()))}),NIApi.register("page.print",function(t){return"undefined"==typeof t&&(t="ALL"),"string"==typeof t&&(t=t.toUpperCase()),"ALL"===t?Promise.resolve(e.Main.pdfManager.print()):Promise.resolve().then(function(){console.log("TODO : in developpement")})})}function a(){t()}a.prototype.download=function(t){if(t=t||"ALL",-1!==t.indexOf(";")||-1!==t.indexOf("-")){for(var a=t.split(";"),n=e.Main.xmlManager.get("common-configuration","config","pageCount"),i=[],r=0;r<a.length;r++)if(-1!==a[r].indexOf("-"))for(var o=parseInt(a[r].split("-")[0],10),s=parseInt(a[r].split("-")[1],10)>n?n:parseInt(a[r].split("-")[1],10);s>=o;o++)-1===i.indexOf(o)&&i.push(o);else{var l=parseInt(a[r],10)>n?n:parseInt(a[r],10);-1===i.indexOf(l)&&i.push(l)}return i=i.filter(Boolean).sort(function(e,t){return e-t}),t=i.join(","),Promise.resolve(!0)}var u=e.Utils.resolveVariable("${manager_host}/services/rest/playerGateway/pdfmerge");return u=e.Utils.addParamsToUrl(u,"genId="+e.Main.xmlManager.getVariable("id")),u=e.Utils.addParamsToUrl(u,"clientId="+e.Main.xmlManager.getVariable("client_id")),u=e.Utils.addParamsToUrl(u,"pages="+t),e.Main.trackerManager.trackEvent({name:"pdfDownload",variables:{1:t}}),location.href=u,Promise.resolve(!0)},a.prototype.print=function(t){if(t=t||"ALL",e.Param.isDesktop||e.Param.isUnknown){if(e.Main.trackerManager.trackEvent({name:"print",variables:{1:t}}),e.Param.userAgent.browser.name===e.Param.userAgent.BROWSER.IE&&e.Param.userAgent.browser.version<=11||e.Param.userAgent.browser.name===e.Param.userAgent.BROWSER.FIREFOX)return void window.open(e.API.pdfGetUrl(),"_blank");var a=document.getElementById("pdfFrame");a&&document.body.removeChild(a),a=document.createElement("iframe"),a.src=e.API.pdfGetUrl(),a.style.visibility="hidden",a.id="pdfFrame",a.onload=function(e){var t=e.target;t.focus(),t.contentWindow.print()},document.body.appendChild(a)}else this.download(t)},e.Class.PdfManager=a}(webpublicationNamespace),function(e){function t(t){if(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this.classList.toggle("webpub-data-item--favorited"),e.Main.thumbnailListManager.saveFavoritedThumbnails(this.getAttribute("data-favorite")),"favorite"===e.Main.thumbnailListManager.filter){var a=document.querySelector("[data-page='"+this.getAttribute("data-favorite")+"']");a.classList.remove("webpub-thumbnails-list__item-fade"),window.setTimeout(function(){a.style.display="none"},200);var n=document.querySelectorAll(".webpub-data-item--favorited");0===n.length&&e.Main.thumbnailListManager.updateContent(e.Main.thumbnailListManager.filter)}}function a(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var a=document.querySelectorAll("[data-page]"),n=this.getAttribute("data-filter-bookmarks");if(Array.prototype.forEach.call(a,function(e){e.classList.remove("webpub-thumbnails-list__item-fade")}),e.Param.isPhone){var i=t.target;n=i.options[i.selectedIndex].getAttribute("data-filter-bookmarks")}window.setTimeout(function(){e.Main.thumbnailListManager.updateContent(n)}.bind(this),200)}function n(t){var n,i=document.querySelectorAll("[data-filter-bookmarks]");if(e.Param.isPhone){var r=document.querySelector(".webpub-thumbnails-list__menu-select");r.addEventListener("change",a)}Array.prototype.forEach.call(i,function(i){e.Param.isPhone?(n=i.getAttribute("data-filter-bookmarks"),i.removeAttribute("selected"),n===t&&(i.setAttribute("selected",!0),i.parentNode.value=i.value)):(i.addEventListener(e.Param.eventClick,a),n=i.getAttribute("data-filter-bookmarks"),i.classList.remove("webpub-thumbnails-list__menu-item-active"),n===t&&i.classList.add("webpub-thumbnails-list__menu-item-active"))})}function i(e){var t=parseInt(this.getAttribute("data-page"),10);NIApi.page.open(t),NIApi.lightbox.closeAll()}function r(e){var t=document.querySelector(".webpub-action-bar__wrapper-display");t.style.display="block",window.setTimeout(function(){t.classList.toggle("webpub-action-bar__wrapper-display-visible")},200)}function o(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var a=[];if("none"!==e.Main.thumbnailListManager.filter){var n=document.querySelectorAll("[data-favorite]");Array.prototype.forEach.call(n,function(e){e.classList.contains("webpub-data-item--favorited")&&a.push(e.getAttribute("data-favorite"))})}e.Main.shareManager.open("social","download").then(function(){e.Main.shareManager.favoriteDownloadShare(a)})}function s(a){var s=a[0];n(e.Main.thumbnailListManager.filter);var c=s.querySelectorAll("[data-page]");Array.prototype.forEach.call(c,function(t){t.addEventListener(e.Param.eventClick,i),window.setTimeout(function(){t.classList.add("webpub-thumbnails-list__item-fade")}.bind(this),100)});var d=s.querySelectorAll("[data-favorite]");Array.prototype.forEach.call(d,function(a){a.addEventListener(e.Param.eventClick,t)});var h=s.querySelector('[data-action="confirm"]'),p=s.querySelectorAll(".webpub-action-bar__item");h&&h.addEventListener(e.Param.eventClick,l),Array.prototype.forEach.call(p,function(t){t.addEventListener(e.Param.eventClick,u)});var g=s.querySelector('[data-action="share"]');g&&g.addEventListener(e.Param.eventClick,r);var m=s.querySelector('[data-action="download"]');m&&m.addEventListener(e.Param.eventClick,o);var f=s.querySelector(".webpub-thumbnails-list__thumbnail");f&&(f.onload=function(){var e=s.querySelectorAll(".webpub-thumbnails-list__item-faker"),t=window.getComputedStyle(this).width;Array.prototype.forEach.call(e,function(e){e.style.width=t})},f.complete&&f.onload())}function l(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var a=document.querySelectorAll("[data-favorite]"),n=[],i=document.querySelector(".webpub-action-bar__share-mode.webpub-share__checkbox--checked");if(null===i)return void e.Utils.toast({text:e.Main.xmlManager.get("locale","multilinks_title"),duration:3e3,type:"error"});var r=i.getAttribute("data-share-mode");Array.prototype.forEach.call(a,function(t){"none"===e.Main.thumbnailListManager.filter?n.push(t.getAttribute("data-favorite")):t.classList.contains("webpub-data-item--favorited")&&n.push(t.getAttribute("data-favorite"))}),e.Main.shareManager.open("social").then(function(){e.Main.shareManager.favoriteThumbnailsShare(n,r,e.Main.thumbnailListManager.sharePanelPath)})}function u(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var a=e.Utils.getClosestByClass(t.target,"webpub-action-bar__item"),n=document.querySelectorAll(".webpub-action-bar__item");Array.prototype.forEach.call(n,function(e){e.classList.remove("webpub-share__checkbox--checked")}),a.classList.add("webpub-share__checkbox--checked")}var c=function(){this.initFavoritedStorage(),this.sharedFavorite=e.Main.urlManager.get("bookmarks")||e.Main.urlManager.get("bookmark"),this.sharedWithMeFilter="undefined"!=typeof this.sharedFavorite?!0:!1,this.filter="none"};c.prototype.updateContent=function(e,t){var a=this.setParams(e,t);a.onload=s,this.popup.setSubtemplate(a)},c.prototype.setParams=function(t,a){this.filter=t||"",this.sharePanelPath=a;for(var n={},i=!1,r=0;r<e.Main.xmlManager.get("common-configuration","config","pageCount");r++)n[r+1]=e.Main.pageManager.getImage("ldpi",r+1);("favorite"===this.filter||"share"===this.filter)&&(n=this.filterThumbnailsFromShare(n)),this.sharedFavorite&&"sharedBy"===this.filter&&(n=this.filterThumbnailsFromShare(n),i=!0),this.sharedFavorite&&"favorite"===this.filter&&(i=!0);var o=this.getFavoritedThumbnails();return{images:0===Object.keys(n).length?[]:n,actionBar:"share"===this.filter?!0:!1,favorite:""!==this.filter?!0:!1,sharedActionBar:i,sharedByFilter:this.sharedWithMeFilter,favorited:o,printable:"print"===a||"download"===a?!0:!1,current:e.Main.xmlManager.get("common-configuration","config","pageCount"),offset:e.Main.xmlManager.get("common-configuration","config","shift")}},c.prototype.show=function(t,a){var n=this.setParams(t,a),i="thumbnails",r=e.Main.xmlManager.get("locale","menu_thumbnail");("favorite"===this.filter||"share"===this.filter)&&(r=e.Main.xmlManager.get("locale","favorites_selection"),i="favorites"),this.sharedFavorite&&"sharedBy"===this.filter&&(r=e.Main.xmlManager.get("locale","favorited_selection"),i="sharedby"),e.Main.trackerManager.trackPage({name:i}),this.popup=new e.Class.LightboxManagerNew({id:"thumbnails-manager",title:r,subtemplate:{url:e.Param.pathTemplate+"thumbnails.html",params:n},menuButton:!1,theme:"page",animation:"none",onload:s})},c.prototype.filterThumbnailsFromShare=function(e){var t={};sharedPages=this.getDataFromFilter(this.filter);for(var a in sharedPages)t[sharedPages[a]]=e[sharedPages[a]];return t},c.prototype.getDataFromFilter=function(t){var a;if(this.sharedFavorite&&"sharedBy"===this.filter&&(a=this.sharedFavorite.split(","),e.Main.urlManager.contains("bookmark")))for(var n=0;n<a.length;n++)a[n]=parseInt(a[n])+1;return("favorite"===this.filter||"share"===this.filter)&&(a=this.getFavoritedThumbnails()),a},c.prototype.getFavoritedThumbnails=function(){var t=[],a=e.Main.xmlManager.getVariable("client_id"),n=(e.Main.xmlManager.getVariable("id"),JSON.parse(localStorage[a]));return"undefined"!=typeof n[e.Main.xmlManager.getVariable("id")]&&(t=n[e.Main.xmlManager.getVariable("id")].favoritedPages),t},c.prototype.getToastData=function(){var a=document.createElement("div"),n=e.Main.thumbnailListManager.getFavoritedThumbnails(),i=e.Utils.getVisiblePages(),r=JSON.stringify(i[0]),o=JSON.stringify(i[1]),s={pageLeft:r,pageRight:o,pageLeftFavorited:-1!==n.indexOf(r),pageRightFavorited:-1!==n.indexOf(o)};return e.Main.templateManager.loadAppend(e.Param.pathTemplate+"component/favoriteToast.html",a,s).then(function(a){a=a[0];var n=a.querySelectorAll("[data-favorite]");Array.prototype.forEach.call(n,function(a){a.addEventListener(e.Param.eventClick,t)});var i=a.querySelector(".webpub-toast__position--text-info--link");return i.addEventListener(e.Param.eventClick,function(){e.Main.thumbnailListManager.show("favorite")}),Promise.resolve(a)}.bind(this))},c.prototype.initFavoritedStorage=function(){var t=e.Main.xmlManager.getVariable("client_id"),a=e.Main.xmlManager.getVariable("id"),n=localStorage[t]?JSON.parse(localStorage[t]):{};if(localStorage[t]&&n[a]);else{var i={};i[a]={favoritedPages:[]},localStorage[t]=JSON.stringify(i)}},c.prototype.saveFavoritedThumbnails=function(t){var a=e.Main.xmlManager.get("locale","label_page")+" "+e.Utils.byOffsetIndex(t)+" ",n=e.Main.xmlManager.getVariable("client_id"),i=e.Main.xmlManager.getVariable("id"),r=JSON.parse(localStorage[n]),o=r[i].favoritedPages;if(-1===o.indexOf(t))o.push(t),a=a+e.Main.xmlManager.get("locale","favorites_added_to")+" ",a+=e.Main.xmlManager.get("locale","favorites_selection"),e.Main.trackerManager.trackEvent({name:"bookmark",variables:{1:t}});else{var s=o.indexOf(t);o.splice(s,1),a=a+e.Main.xmlManager.get("locale","favorites_removed_from")+" ",a+=e.Main.xmlManager.get("locale","favorites_selection"),e.Main.trackerManager.trackEvent({name:"unbookmark",variables:{1:t}})}this.showToast(a),localStorage[n]=JSON.stringify(r)},c.prototype.showToast=function(t){var a=document.querySelector(".webpub-toast--active");a?(document.querySelector(".webpub-toast__position--text-info")&&(a=document.querySelector(".webpub-toast__position--text-info")),a.innerText=t):e.Utils.toast({text:t,duration:3e3})},e.Class.ThumbnailListManager=c}(webpublicationNamespace),function(e){function t(e){e.addEventListener("mouseenter",i)}function a(t){return clearTimeout(e.Main.tooltipManager._mouseIdleTimer),"mouseleave"===t.type?(e.Utils.preventDefault(t),void r(t)):void(e.Main.tooltipManager._mouseIdleTimer=setTimeout(function(e){o(e)}.bind({},t),500))}function n(t){var a=document.querySelector(".webpub-tooltip");if(a){var i=e.Utils.getClosestByAttribute(t.target,"data-tooltip");i.removeEventListener("mousemove",n),a.parentNode.removeChild(a)}}function i(e){e.target.addEventListener("mousemove",a),e.target.addEventListener("mouseleave",a)}function r(t){var i=e.Utils.getClosestByAttribute(t.target,"data-tooltip");n(t),i.removeEventListener("mousemove",a),i.removeEventListener("mouseleave",a)}function o(t){var a=e.Utils.getClosestByAttribute(t.target,"data-tooltip"),i={X:t.clientX,Y:t.clientY+25};a.addEventListener("mousemove",n),e.Main.tooltipManager.show(a.getAttribute("data-tooltip"),i)}var s=function(){};s.prototype.show=function(t,a,n){if(e.Param.isDesktop!==!1){t=t||"";var i=document.createElement("div");i.classList.add("webpub-tooltip"),i.innerText=t,i.style.transform="translate("+a.X+"px,"+a.Y+"px) scale(0)",i.style.webkitTransform="translate("+a.X+"px,"+a.Y+"px) scale(0)";var r=document.querySelector(".webpub-tooltip");r&&r.parentNode.removeChild(r),i.addEventListener("animationstart",function(e){e.target.style.transform="translate("+a.X+"px,"+a.Y+"px) scale(1)",e.target.style.webkitTransform="translate("+a.X+"px,"+a.Y+"px) scale(1)"},!1),i.addEventListener("animationend",function(e){var t=document.body.getBoundingClientRect().width;if(e.target.getBoundingClientRect().right>t){var n=e.target.getBoundingClientRect().width,i=Math.floor(t-n);e.target.style.transform="translate("+i+"px,"+a.Y+"px) scale(1)",e.target.style.webkitTransform="translate("+i+"px,"+a.Y+"px) scale(1)"}else e.target.getBoundingClientRect().left<0&&(e.target.style.transform="translate( 0px,"+a.Y+"px) scale(1)",e.target.style.webkitTransform="translate( 0px,"+a.Y+"px) scale(1)")},!1),document.body.appendChild(i)}},s.prototype.hide=n,s.prototype.register=t,e.Class.TooltipManager=s}(webpublicationNamespace),function(e){e.Class.WishList=function(){NIApi.register("wishlist.addProduct",function(e,t){for(var a,n=parseInt(t,10),i=0;i<wishList.list.data.length;i++)wishList.list.data[i].id===e&&(a=i);if("number"==typeof a){var r=wishList.list.data[a].quantity+n;wishList.list.data[a].quantity=r}else window.wishList.list.addProductInMemory(e,n);return Promise.resolve()}),0!=e.Main.xmlInterface.xmlContentsConnector.rootXml.find("#products").length?(window.wishList=new e.Class.WishList.prototype.WLMain,window.wishList.init()):e.Main.xmlManager.get("common-ui","assets","products")&&e.Main.xmlManager.parse("pubinfo",e.Param.pathRoot+"contents/pubinfo.xml").then(function(){return e.Main.xmlManager.parse("contents",e.Main.xmlManager.get("pubinfo","contents"))}).then(function(){return e.Main.xmlManager.parse("template",e.Main.xmlManager.get("pubinfo","template"))}).then(function(){var t=e.Main.xmlManager.get("common-ui","assets","config");return configUrl=e.Utils.resolveVariable(t.url||t),e.Main.xmlManager.parse("config",configUrl)}).then(function(){var t=e.Main.xmlManager.get("common-ui","assets","interface");return uiUrl=e.Utils.resolveVariable(t.url||t),e.Main.xmlManager.parse("ui",uiUrl)}).then(function(){window.wishList=new e.Class.WishList.prototype.WLMain,window.wishList.init()})};var t=e.Class.WishList.prototype;t.WLMain=function(){if(0!==e.Main.xmlInterface.xmlContentsConnector.rootXml.find("#products").length||e.Main.xmlManager.get("common-ui","assets","products")){var a=!1;this.conf,this.data,this.list,this.locale,this.format,this.exportFormats,this.sendRequest,this.listPanel,this.addPanel,this.checkoutPanel,this.pageProductsPanel,this.templates,this.activePopup,this.activeView,this.onViewOpen,this.checkAllReady=function(){this.conf.ready&&this.data.loaded&&this.templates&&t.ContextManager().ready&&this.continueInit()},this.onTemplatesLoaded=function(e){
this.trace("template fragments loaded");var t=new window.DOMParser;this.templates=t.parseFromString(e,"text/xml").firstChild,wishList.checkAllReady()},this.onConfParsed=function(){wishList.checkAllReady()},this.onDataLoaded=function(){wishList.checkAllReady()},this.continueInit=function(){this.locale.init(),this.format.init(this.conf.format),this.data.indexRawsById(this.format),this.listPanel.init(this.conf.listPanel),this.addPanel.init(this.conf.addPanel),this.checkoutPanel.init(this.conf.checkoutPanel),console.log("wishlist init"),this.conf.pageProductsPanel&&this.pageProductsPanel.init(this.conf.pageProductsPanel),this.exportFormats.init(this.conf.exportFormats),this.sendRequest.init(this.conf.sendRequest),this.pageProductsPanel.open(this.onViewOpen),e.Param.overload.clickLink=function(e,t,a,n){return n.info=!0,"addProduct"==a.getNamedItem("type").value&&null!=a.getNamedItem("param")?(wishList.trace("addProduct called"),wishList.list.addProduct(a.getNamedItem("param").value),!0):(wishList.trace(a.getNamedItem("type").value+" called"),!1)}},this.onViewOpen=function(e,t){wishList.activePopup&&t!=wishList.activeView&&wishList.activePopup.close(),wishList.activePopup=e,wishList.activeView=t},this.trace=function(e){a&&console.log("WishList - "+e)},this.onContextReady=function(){wishList.trace("onContextReady"),wishList.checkAllReady()},this.init=function(){this.conf=new t.WLConf,WLConf=this.conf,this.data=new t.WLData,this.list=new t.WLProducts,this.locale=new t.WLLocale,this.format=new t.WLFormat,this.exportFormats=new t.WLExportFormats,this.sendRequest=new t.WLSendRequest,this.listPanel=new t.WLListPanel(this.onViewOpen),this.addPanel=new t.WLAddPanel(this.onViewOpen),this.checkoutPanel=new t.WLCheckoutPanel(this.onViewOpen),this.pageProductsPanel=new t.WLPageProductsPanel(this.onViewOpen),t.ContextManager().init(e.Main.xmlManager.getXml("pubinfo").firstChild,e.Main.xmlManager.getXml("contents").firstChild,e.Main.xmlManager.getXml("template").firstChild,this.onContextReady),this.conf.init(this.onConfParsed),this.data.init(this.onDataLoaded),t.WLUtils.load(this.conf.templateUrl+"wishListTemplate.xml",this.onTemplatesLoaded,this)}}}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.ContextManager=function(){function t(){i.ContextManager().ready=!0,l()}function a(e){for(var t in e.globalVars)e.globalVars[t]=i.WLUtils.resolveVars(e.globalVars[t],e.globalVars,"$")}function n(e,t){for(var a=0;a<e.childNodes.length;a++){var n=e.childNodes[a];1==n.nodeType&&(t.globalVars[n.nodeName]=i.WLUtils.resolveVars(n.getAttribute("value"),t.globalVars,"$"))}}if(arguments.callee._singletonInstance)return arguments.callee._singletonInstance;arguments.callee._singletonInstance=this;var i=e.Class.WishList.prototype;this.contentManager,this.assetManager;var r,o,s,l;return this.globalVars={},this.ready=!1,this.init=function(e,u,c,d){r=e,o=u,s=c,l=d,n(r.querySelector("variables"),this),n(s.querySelector("variables"),this),n(o.querySelector("variables"),this),a(this),this.contentManager=new i.ContentManager,this.contentManager.init(o.querySelector("contents"),this.globalVars),this.assetManager=new i.AssetManager,this.assetManager.init(s,t)},this.resolveGlobalVars=function(e){return i.WLUtils.resolveVars(e,this.globalVars,"$")},this}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.AssetManager=function(){function e(e,a,n){o++,r[a]=new t.AssetLoader(e,a,t.ContextManager().resolveGlobalVars(n),t.ContextManager().assetManager.onAssetLoaded)}var a,n,i,r={},o=0,s=["main_lib","config","interface","css","css_flash","css_html5","description_css","locale","font","shop_lib"],l=["locale_cart","tpl","tpl2"];this.init=function(t,r){a=t,i=r,n=a.querySelector("assets");for(var o=0;o<n.childNodes.length;o++){var u=n.childNodes[o];if(1==u.nodeType){var c=u.getAttribute("id");if(!(l&&-1==l.indexOf(c)||!l&&s&&-1!=s.indexOf(c))){var d=u.getAttribute("onstart");(void 0==d||"true"==d)&&e(u.getAttribute("type"),c,u.getAttribute("url"))}}}},this.onAssetLoaded=function(e,t){o--,0==o&&i&&i()},this.getAsset=function(e){return r[e]?r[e].content:(console.log("Asset not declared : "+e),null)}}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.AssetLoader=function(a,n,i,r){var o=(e.Class.Wishlist,r);this.content,this.onLoaded=function(e){this.content=e,o(this,this.content)},t.WLUtils.load(i,this.onLoaded,this)}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.ContentManager=function(){var e,a="0000000000000000",n="num",i="%",r=i+n+i,o={},s={},l={},u={},c={},d={},h="",p="",g=0,m=0;this.init=function(a,n){e=a,p=e.getAttribute("prefix")?e.getAttribute("prefix"):"",h=e.getAttribute("sufix")?e.getAttribute("suffix"):"",g=e.getAttribute("padding")?parseInt(e.getAttribute("padding")):0,m=e.getAttribute("shift")?parseInt(e.getAttribute("shift")):0;for(var i,r,f=0;f<e.childNodes.length;f++)r=e.childNodes[f],1==r.nodeType&&(i=r.getAttribute("id"),o[i]=t.WLUtils.resolveVars(r.getAttribute("path",n,"$")),c[i]=r.getAttribute("type")?r.getAttribute("type"):"",s[i]=r.getAttribute("prefix")?r.getAttribute("prefix"):p,l[i]=r.getAttribute("suffix")?r.getAttribute("suffix"):h,u[i]=r.getAttribute("padding")?parseInt(r.getAttribute("padding")):g,d[i]=r.firstChild&&r.firstChild.nodeValue?r.firstChild.nodeValue.trim():"")},this.getFilePath=function(e,h){var p;if(null==h)return o[e]+d[e]+"."+c[e];var g=u[e]-h.toString().length;g&&(g=0);var m={};return m[n]=(h+1).toString(),-1!=o[e].indexOf(r)?(p=o[e]+s[e]+a.substr(0,g)+l[e]+"."+c[e],p=t.WLUtils.resolveVars(p,m,i)):p=o[e]+s[e]+a.substr(0,g)+(h+1).toString()+l[e]+"."+c[e],p}}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype.WLUtils=function(){};t.resolveVars=function(e,t,a){var n=0;for(null==e&&console.log("WLUtils.resolveVars can't take null input");;){var i=e.indexOf(a,n);if(-1==i)break;var r=e.indexOf(a,i+1);if(-1==r)break;var o=e.substring(i+1,r);if(null!=t[o]){var s=t[o];e=e.substr(0,i)+s+e.substr(r+1),n=i}else n=r}return e=e.replace(/^~\//g,"publication/")},t.createPopup=function(t,a,n,i,r,o){r=null==r?!0:r;var s={id:t,header:r?"visible":"none",onload:function(t){e.Main.templateOldManager.callbacks.icons($(t)),o.onload&&o.onload.call(this,t)},html:a};return n&&(s.title=n),new e.Class.LightboxManagerNew(s)},t.getTimeStamp=function(){function e(e){return(10>e?"0":"")+e}var t=new Date;return t.getFullYear()+e(t.getMonth()+1)+e(t.getDate())+e(t.getHours())+e(t.getMinutes())+e(t.getSeconds())},t.paddStr=function(e,t,a,n){null==n&&(n=!0);for(var i=String(e);i.length<a;)1==n?i=t+e:i+=t;return i},t.getTodayDate=function(e){var a,n,i=[],r=new Date;return null!=e?(a=e.hasAttribute("separator")?e.getAttribute("separator"):"/",n=e.hasAttribute("format")?e.getAttribute("format"):"fr"):(a="/",n="fr"),"fr"==n?(i.push(t.paddStr(r.getDate(),"0",2)),i.push(t.paddStr(r.getMonth()+1,"0",2)),i.push(t.paddStr(r.getFullYear(),"0",4))):"us"==n&&(i.push(t.paddStr(r.getFullYear(),"0",4)),i.push(t.paddStr(r.getMonth()+1,"0",2)),i.push(t.paddStr(r.getDate(),"0",2))),i.join(a)},t.load=function(e,t,a){null==t&&wishList.trace("can't load without callback "+e),(void 0==e||-1!=e.indexOf("undefined"))&&wishList.trace("can't load an undefined url");var n=new XMLHttpRequest;n.open("GET",e,!0),n.onreadystatechange=function(i){4==n.readyState&&(200==n.status?t.apply(a,[n.responseText]):wishList.trace("Erreur pendant le chargement de "+e))},n.send(null)}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.WLData=function(){function e(e){for(var t=e.split("\r\n"),a=0;a<t.length;a++)t[a]=t[a].split(";");return t}this.raw=null,this.data={},this.headers={};var a=0;this.onLoaded=null;var n;this.ready=!1,this.loaded=!1,this.init=function(e){this.onLoaded=e,t.WLUtils.load(wishList.conf.productDataUrl,this.onCSVLoaded,this)},this.onCSVLoaded=function(t){var a=(new Date).getTime();this.raw=e(t),wishList.trace("csv parsed in "+((new Date).getTime()-a)+"ms, line number = "+this.raw.length+", column number = "+this.raw[0].length),this.loaded=!0,this.onLoaded()},this.getProductById=function(e){return this.data[e]},this.getProductsByPage=function(e){var t=[],a=wishList.data.headers[wishList.format.props.page];for(var n in this.data){var i=this.data[n].data[a];if("string"==typeof i&&-1!=i.indexOf(",")){i.split(",")}(i&&i==e||"string"==typeof i&&-1!=i.indexOf(",")&&-1!=i.split(",").indexOf(String(e)))&&t.push(this.data[n])}return t},this.indexRawsById=function(e){var i=(new Date).getTime();if(n=e,this.raw.length<2)return void wishList.trace("Error WLData shorter than 2");a=this.raw[0].indexOf(n.props.id);for(var r=0;r<this.raw[0].length;r++){var o=this.raw[0][r];this.headers[o]=r,n.fieldsIndex[n.fields[o]]=r}for(var s=1;s<this.raw.length;s++){var l=this.raw[s],u=l[a],c=this.data[u];void 0==c?this.data[u]=new t.WLProduct(u,l,new t.WLPrice(1,l[n.fieldsIndex[n.priceId]])):c.addVariant(l)}wishList.trace("product data mounted in "+((new Date).getTime()-i)+"ms"),this.ready=!0}}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype,a=t.WLProduct=function(e,t,a,n){this.id=e,this.data=t,this.price=a,this.quantity,this.variants,n?this.variants=n:this.addVariant(this.data)};a.prototype.addVariant=function(e){void 0==this.variants?this.variants=[this.data]:this.variants.push(e)},a.prototype.clone=function(){return new a(this.id,this.data.concat(),this.price,this.variants.concat())}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.WLLocale=function(){this.strings={},this.init=function(){var e=t.ContextManager().assetManager.getAsset("locale_cart");return null==e?void console.log("WLLocale can't init, asset locale_cart not found in the template"):void this.parse(e)},this.parse=function(e){var a=new window.DOMParser,n=a.parseFromString(e,"text/xml"),i=n.querySelectorAll("strings");0==i.length&&(i=n.querySelectorAll("message"));for(var r=0;r<i.length;r++){var o=i[r];this.strings[o.getAttribute("id")]=o.firstChild.data}t.WLPrice.NO_PRICE_LABEL=this.strings.price_noprice,wishList.trace("locale parsed "+i.length+" strings")},this.getString=function(e){return this.strings[e]},this.resolveStrings=function(e){return t.WLUtils.resolveVars(e,this.strings,"#")}}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.WLPageProductsPanel=function(a){function n(){t.WLUtils.load(y,i,f)}function i(e){w=t.WLUtils.resolveVars(e,{onPrevDownCode:X,onNextDownCode:W,onNextUpCode:j,onPrevUpCode:Y,onProductClickCode:Z,onToggleOpenCode:Q},"$"),w=wishList.locale.resolveStrings(w),H=!0,r()}function r(){b&&f.open(b)}function o(t){O=e.Utils.getVisiblePages(),m(),h()}function s(t){O=e.Utils.getVisiblePages(),m()}function l(){ne=!ne,null==f.popupElement.getAttribute("style")||""==f.popupElement.getAttribute("style")?f.popupElement.setAttribute("style",$):f.popupElement.setAttribute("style","")}function u(e){J=!J,ee=e?J:ee,N.textContent=J?D:A,J?f.popupElement.classList.remove("webpub-wlpanel-slider__wrapper-close"):f.popupElement.classList.add("webpub-wlpanel-slider__wrapper-close")}function c(e){return startInterpolation=startInterpolation||e,R&&e-startInterpolation>B/2?(startInterpolation=e-B/2,elapsed=B/2,G=T.scrollLeft-.7*q,T.scrollLeft+=(e-lastTimeStamp)/B*q,z=window.requestAnimationFrame(c),void(lastTimeStamp=e)):(elapsed=e-startInterpolation,lastTimeStamp=e,elapsed>=B?(T.scrollLeft=G+q,void(startInterpolation=null)):(T.scrollLeft=d(elapsed,G,q,B),void(z=window.requestAnimationFrame(c))))}function d(e,t,a,n){return-a*(e/=n)*(e-2)+t}function h(){_.scrollWidth>=T.scrollWidth&&(U.style.display="none",F.style.display="none"),F.style.display=T.scrollLeft<=0?"none":"",U.style.display=T.scrollLeft>=T.scrollWidth-_.scrollWidth?"none":""}function p(){T.innerHTML="",k=[],E=[]}function g(e){if(-1!=e.indexOf(",")){var t=e.split(",");return t[0]}return e}function m(){p();for(var e=[],a=0;a<O.length;a++)e=e.concat(wishList.data.getProductsByPage(O[a]));if(ne&&0==e.length?l():!ne&&e.length>0&&l(),J&&0==e.length)return void u();!J&&ee&&e.length>0&&u();for(var a=0;a<e.length;a++){var n=e[a],i=n.data[wishList.data.headers[wishList.format.props[labelPropName]]],r=n.data[wishList.data.headers[wishList.format.props[M]]];r=g(r).trim();var o=P+r+x,s=T.appendChild(document.createElement("li")),c=t.WLUtils.resolveVars(C,{onProductClickCode:Z,imageUrl:o,labelText:i},"$");s.outerHTML=c,s=T.lastChild,k.push(s),E.push(n)}if(s){var d=s.offsetWidth*(k.length-1),m=d-s.offsetLeft,f=m/k.length;V=(s.offsetLeft-f)/(k.length-1)}T.addEventListener("scroll",h),window.addEventListener("resize",h)}this.onViewOpen=a;var f=this;this.elementId="pageProductsPanel",this.popupElement;var v,b,y,w,C,M,P,x,S,L,I,T,_,O,k,E,N,A,D,F,U,G,q,B,V,R,z,H=!1,X="wishList.pageProductsPanel.onPrevDown()",W="wishList.pageProductsPanel.onNextDown()",j="wishList.pageProductsPanel.onNextUp()",Y="wishList.pageProductsPanel.onPrevUp()",Z="wishList.pageProductsPanel.onProductClick(this)",Q="wishList.pageProductsPanel.onToggleOpen()",$="display:none;",K=".webpub-wlpanel-slider__display-button",J=!1,ee=!1,te="pagePanelArrowLeft",ae="pagePanelArrowRight",ne=!0;this.init=function(a){v=a,y=wishList.conf.templateUrl+v.getAttribute("htmlTemplate"),C=wishList.templates.querySelector(v.getAttribute("productTemplate")).firstChild.data,A=wishList.locale.getString("pageproductpanel_toggleopen_open"),D=wishList.locale.getString("pageproductpanel_toggleopen_close");var n=v.querySelector("image");M=n.getAttribute("propName")||"image",P=t.ContextManager().resolveGlobalVars(n.getAttribute("path")),x=n.getAttribute("extension")||"jpg",null==P&&(S=!1),L=v.querySelector("pageChange").getAttribute("propName")||"page";var i=v.querySelector("layout");I=parseInt(i.getAttribute("maxProductAdded"))||7;var r=v.querySelector("label");labelPropName=r.getAttribute("propName")||"name",maxLabelChar=parseInt(r.getAttribute("maxLabelChar"))||35,e.Utils.prodTools.onPageChange(o),window.addEventListener(e.Param.eventResize,s)},this.onNextUp=function(){R=!1},this.onPrevUp=function(){R=!1},this.onPrevDown=function(){R=!0,startInterpolation=null,G=T.scrollLeft,q=-V,B=350,null!=z&&cancelAnimationFrame(z),z=window.requestAnimationFrame(c)},this.onNextDown=function(){R=!0,startInterpolation=null,G=T.scrollLeft,q=V,B=350,null!=z&&cancelAnimationFrame(z),z=window.requestAnimationFrame(c)},this.onProductClick=function(e){if(k){for(var t=0;t<k.length;t++)k[t].classList.remove("webpub-wlpanel-slider__item-active");e.classList.add("webpub-wlpanel-slider__item-active")}productData=E[k.indexOf(e)],wishList.list.addProduct(productData.id)},this.onToggleOpen=function(){if(e.Main.menuManager.hideMenu(),u(!0),J){var t=O;O=e.Utils.getVisiblePages(),O.length>0&&(O.length!=t.length||0==t.length||O[0]!=t[0])&&m()}},this.isVisible=function(){return J},this.isActivated=function(){return null==v?!1:!0},this.open=function(){if(null!=v){if(!H)return b=!0,void n();var t=document.createElement("div");t.setAttribute("id",this.elementId),this.popupElement=e.Param.viewMain.appendChild(t),this.popupElement.classList.add("webpub-wlpanel-slider__wrapper"),this.popupElement.classList.add("webpub-wlpanel-slider__wrapper-close"),this.popupElement.innerHTML=w,this.onViewOpen(this.popupElement);{this.popupElement=document.getElementById(this.elementId)}T=this.popupElement.querySelector(".webpub-wlpanel-slider"),_=T.parentElement,O=e.Utils.getVisiblePages(),m(),N=this.popupElement.querySelector(K),U=document.getElementById(ae),F=document.getElementById(te),h()}}}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.WLConf=function(){this.templateUrl=e.Main.xmlManager.getVariable("template"),this.localeUrl,this.listPanel=null,this.format=null,this.addPanel=null,this.price=null,this.sendRequest=null,this.exportFormats=null,this.checkoutPanel=null,this.conf=null,this.ready=!1,this.decimalMark,this.currency,this.currencyOrder,this.configXml,this.tax,this.cartType,this.sendCartUrl,this.allowDoubleForm,this.printUseFinalForm,this.showListAfterAddProduct,this.autoCloseAfterAddProduct,this.confirmAddProduct,this.onLoaded=function(e){wishList.trace("conf loaded");var t=new window.DOMParser,a=t.parseFromString(e,"text/xml");this.conf=a,this.listPanel=a.querySelector("shopCartPanel"),this.format=a.querySelector("config > productFormat"),this.addPanel=a.querySelector("config > addPanel"),this.price=a.querySelector("config > price"),this.sendRequest=a.querySelectorAll("config > sendRequest"),this.exportFormats=a.querySelector("config > exportFormats"),this.checkoutPanel=a.querySelector("config > checkoutPanel"),console.log("config > pageProductsPanel"),this.pageProductsPanel=a.querySelector("config > pageProductsPanel"),this.decimalMark=this.price.querySelector("decimalMark").textContent,this.currency=this.price.querySelector("currency").textContent,this.currencyOrder=this.price.querySelector("currency").getAttribute("order"),this.ready=!0,this.readConfig(),this.onReady()},this.init=function(e){this.onReady=e,this.confUrl=t.ContextManager().contentManager.getFilePath("shopcart_description"),this.productDataUrl=t.ContextManager().contentManager.getFilePath("products"),this.confUrl=t.ContextManager().resolveGlobalVars(this.confUrl),this.productDataUrl=t.ContextManager().resolveGlobalVars(this.productDataUrl),t.WLUtils.load(this.confUrl,this.onLoaded,this)},this.readConfig=function(){var t=this.configXml=e.Main.xmlManager.getXml("config").querySelector("shopCart"),a=t.querySelector("dependencies");if(a){var n=a.querySelector("cartTax");n&&(this.cartTax=n.getAttribute("value"),wishList.locale.strings.cartTax="#"+this.cartTax+"#");var i=a.querySelector("cartType");i&&(this.cartType=i.getAttribute("value"),wishList.locale.strings.cartType="#"+this.cartType+"#");var r=a.querySelector("cartTypeMy");r&&(this.cartTypeMy=r.getAttribute("value"),wishList.locale.strings.cartTypeMy="#"+this.cartTypeMy+"#");var o=a.querySelector("cartTypeTo");o&&(this.cartTypeTo=o.getAttribute("value"),wishList.locale.strings.cartTypeTo="#"+this.cartTypeTo+"#");var s=a.querySelector("cartTypeOf");s&&(this.cartTypeOf=s.getAttribute("value"),wishList.locale.strings.cartTypeOf="#"+this.cartTypeOf+"#")}var l=t.querySelector("options");if(l){var u=l.querySelector("sendCart");u&&(this.sendCartUrl=e.Utils.resolveVariable(u.getAttribute("url")));var c=l.querySelector("finalForm");c&&(this.allowDoubleForm="true"==c.getAttribute("allowDoubleForm"));var d=l.querySelector("print");d&&(this.printUseFinalForm="true"==d.getAttribute("useFinalForm"));var h=l.querySelector("showListAfterAddProduct");h&&(this.showListAfterAddProduct="true"==h.getAttribute("value"));var p=l.querySelector("autoCloseAfterAddProduct");p&&(this.autoCloseAfterAddProduct="true"==p.getAttribute("value"));var g=l.querySelector("confirmAddProduct");g&&(this.confirmAddProduct=g.getAttribute("elementId"));var m=l.querySelector("quantityPopup");m&&(this.quantityPopup="true"==m.getAttribute("value"))}}}}(webpublicationNamespace),function(e){{var t=e.Class.WishList.prototype;t.WLPrice=function(e,a,n){var i=parseInt(e);"string"==typeof a&&(a=a.replace(",","."),a=a.replace(" ","")),this.value=parseFloat(a),isNaN(a)&&(wishList.trace("NaN Price "+a),this.value=-1);var r=parseFloat(n),o=wishList.conf.currency,s=wishList.conf.currencyOrder,l=wishList.conf.decimalMark;t.WLPrice.prototype.getLabel=function(e,t){return t=null==t?!0:t,this.createLabel(this.getValue(e),t)},t.WLPrice.prototype.getNetLabel=function(e,t){return t=null==t?!0:t,this.createLabel(this.getNetValue(e),t)},t.WLPrice.prototype.getValue=function(e){return this.value<0?this.value:parseInt(this.value*e*1e3+.5)/1e3},t.WLPrice.prototype.getNetValue=function(e){return this.value<0?this.value:int(this.value*e*r*1e3+.5)/1e3},t.WLPrice.prototype.getSpecialLabel=function(){var e=t.WLPrice.NO_PRICE_LABEL;return"empty"==e&&(e="NC"),e},t.WLPrice.prototype.createLabel=function(e,t,a){if(t=null==t?!0:t,a=null==a?2:a,0>e)return this.getSpecialLabel();var n=Math.pow(10,a),i=0==t?"":o,r=parseInt(e*n)/n,l=this.paddCents(r.toString());return s?l+i:i+l},t.WLPrice.prototype.paddCents=function(e){var t=e.split(".");return void 0==t[1]?t[0]+=l+"00":1==t[1].length&&(t[1]+="0"),t.join(l)},t.WLPrice.prototype.getMinQuantity=function(){return i}}}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.WLFormat=function(){this.props={},this.fields={},this.fieldsIndex={},this.formatConf,this.errorValue,this.separator,this.lineSeparator,this.priceField,this.priceId,this.init=function(e){this.formatConf=e,this.errorValue=e.getAttribute("error_value"),this.separator=e.getAttribute("separator"),this.lineSeparator=e.getAttribute("lineSeparator");for(var t=(e.querySelectorAll("string"),0);t<e.childNodes.length;t++){var a=e.childNodes[t];if(1==a.nodeType){var n=a.getAttribute("id"),i=a.getAttribute("field");this.props[n]=i,this.fields[i]=n}}var r=e.querySelector("price");if(r){var o=this.priceId=r.getAttribute("id"),s=r.getAttribute("field");this.props[o]=s,this.priceField=s}wishList.trace("format parsed")}}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.WLProducts=function(){function a(e,t){return null==e.variants?-1:e.variants.indexOf(t)}function n(e,t){for(var a=[],n=0;n<e.length;n++)a[n]=null!=t[n]&&""!=t[n]?t[n]:e[n];return a}this.data=[],this.addProduct=function(e){wishList.conf.quantityPopup?this.promptAddProduct(e,1):this.addProductInMemory(e,1)},this.promptAddProduct=function(e){wishList.addPanel.open(e)},this.addProductInMemory=function(e,t,i,r){t=parseInt(t);var o=wishList.data.getProductById(e).clone();if(null!=r){var s=a(o,r);console.log(s),-1!=s&&(o.variantId=s,o.data=n(o.data,o.variants[s]))}for(var l=!1,u=0;u<this.data.length;u++)if(null==s&&this.data[u].id==e||null!=s&&this.data[u].id==e&&s==this.data[u].variantId){this.data[u].quantity=t,l=!0;break}if(!l){void 0==o.quantity&&(o.quantity=t),i&&(o.quantityComment=i),this.data.push(o);var u=this.data.length-1}this.onProductAdded(u)},this.getProductData=function(e){return-1!=e.variantId||null!=e.variantId?n(e,e.variants[e.variantId]):void 0},this.onProductAdded=function(){e.Utils.callEvent(window,"wishList-changeProductList"),wishList.conf.showListAfterAddProduct&&wishList.listPanel.open()},this.removeProduct=function(t,a){var n=this.data.indexOf(a);this.data[n].quantity=null,this.data.splice(n,1),t.parentElement.removeChild(t),e.Utils.callEvent(window,"wishList-changeProductList")},this.deleteAll=function(){this.data=[],e.Utils.callEvent(window,"wishList-changeProductList")},this.onQuantityChange=function(e,t){e.quantity=parseInt(t)},this.getTotalPriceValue=function(){for(var e=0,t=(wishList.list.data,0);t<this.data.length;t++){var a=this.data[t],n=a.price.getValue(a.quantity);e+=-1!=n?n:0}return e},this.getTotalPriceLabel=function(){return new t.WLPrice(1,this.getTotalPriceValue()).getLabel(1)}}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.WLSerialProfile=function(e,t){function a(e){return null==e?null:null==e.firstChild.data?e.value:e.firstChild.data}this.id=e,this.prefix=a(t.querySelector("prefix")),this.suffix=a(t.querySelector("suffix")),this.productPrefix=a(t.querySelector("productPrefix")),this.productPrefixAlt=a(t.querySelector("productPrefixAlt")),this.productSuffix=a(t.querySelector("productSuffix")),this.productColor="true"==a(t.querySelector("productColor")),this.productSeparator=a(t.querySelector("productSeparator")),this.propSeparator=a(t.querySelector("propSeparator")),this.useRawHeader="true"==a(t.querySelector("useRawHeader")),this.useHeader="true"==a(t.querySelector("useHeader")),this.headers=[];for(var n=t.querySelectorAll("headers > header"),i=0;i<n.length;i++)this.headers.push(a(n[i]));this.fields=[];for(var r=t.querySelectorAll("fields > field"),i=0;i<r.length;i++)this.fields.push(a(r[i]))}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.WLExportFormats=function(){this.expFormatsConf,this.formats={},this.init=function(e){expFormatsConf=e;for(var a=expFormatsConf.querySelectorAll("format"),n=0;n<a.length;n++){var i=a[n];if(i){var r=i.getAttribute("id");this.formats[r]=new t.WLSerialProfile(r,i)}}},this.getSerializedList=function(e){var t=this.formats[e],a=wishList.list.data;if("json"==e){for(var n=[],i=wishList.locale.getString("export_format_null_value"),r=null!=i?i:"",o=0;o<a.length;o++){for(var s=a[o],l={},u=0;u<t.fields.length;u++){var c,d=t.fields[u],h=t.headers[u];switch(d){case"id":c=s.id;break;case"totalprice":c=s.price.getLabel(s.quantity);break;case"quantityComment":c=null!=s.quantityComment&&""!=s.quantityComment?s.quantityComment:r;break;case"qty":c=s.quantity;break;default:var p=s.data[wishList.data.headers[wishList.format.props[d]]];c=null!=p&&""!=p?p:r}l[h]=c}n.push(l)}return n}var g=t.prefix;t.useHeader&&(g+=this.getSerializedHeader(t));for(var i=wishList.locale.getString("export_format_null_value"),r=null!=i?i:"",o=0;o<a.length;o++){var s=a[o];g+=t.productPrefix;for(var m=0;m<t.fields.length;m++){0!=m&&(g+=t.propSeparator);var f,d=t.fields[m];switch(d){case"id":f=s.id;break;case"totalprice":f=s.price.getLabel(s.quantity);break;case"quantityComment":f=null!=s.quantityComment&&""!=s.quantityComment?s.quantityComment:r;break;case"qty":f=s.quantity;break;default:var p=s.data[wishList.data.headers[wishList.format.props[d]]];f=null!=p&&""!=p?p:r}"string"==typeof f&&(f=f.replace("\n",""),f=f.replace("\r","")),g+=f}g+=t.productSuffix+t.productSeparator}return g+=t.suffix},this.getSerializedHeader=function(e){var t="";t+=e.productPrefix;for(var a=0;a<e.headers.length;a++){0!=a&&(t+=e.propSeparator);var n=wishList.locale.strings[e.headers[a]];t+=n}return t+=e.productSuffix+e.productSeparator}}}(webpublicationNamespace),function(w){var WishListProto=w.Class.WishList.prototype;WishListProto.WLSendRequest=function(){function showNotification(e){if(null!=callBackNotif){var t=wishList.locale.getString(e);t=WishListProto.WLUtils.resolveVars(t,responseVars,"$"),callBackNotif(success,t)}else alert(wishList.locale.getString(e))}function parseResponse(e){var t={},a=e.split("&");for(var n in a){var i=a[n].split("=");2==i.length&&(t[i[0]]=i[1])}return t}function getVarsFromStructure(e,t,a){if(null==t&&(t={}),null==a&&(a=""),e instanceof Array)for(var n=0;n<e.length;n++){var i=e[n];"string"==typeof i||"number"==typeof i?t[a+"_"+n]=i:getVarsFromStructure(i,t,a+"_"+n)}else for(var r in e){var i=e[r],o=""!=a?a+"_":"";"string"==typeof i||"number"==typeof i?t[o+r]=i:getVarsFromStructure(i,t,o+r)}return t}function insertObjectStructure(e,t,a){if(-1!=t.indexOf("."))for(var n=t.split("."),i=0;i<n.length;i++){var r=n[i];i==n.length-1?e[r]=a:(e.hasOwnProperty(r)||(e[r]={}),e=e[r])}else e[t]=a}function getValueFromPath(e,t){if(-1!=t.indexOf(".")){for(var a=t.split("."),n=0;n<a.length;n++){var i=a[n];if(n==a.length-1&&e.hasOwnProperty(i))return e[i];if(!e.hasOwnProperty(i))return null;e=e[i]}return null}return e[t]}function nodeNameHandler(nodes){function addToData(e){requestType==ENCODED_FORM_TYPE?requestParams[requestId]=e:insertObjectStructure(requestParams,requestId,e)}function exportFormat(){var e=requestParamConf.getAttribute("type");e&&""!=e?(temp=wishList.exportFormats.getSerializedList(e),requestType!=JSON_TYPE&&(temp=wishList.locale.resolveStrings(temp)),addToData(temp)):wishList.trace("WLSendRequest - nodeNameHandler exportFormat error : parameter "+requestId+", type not defined or empty")}function formDataValue(){var e=requestParamConf.getAttribute("dataId");e&&""!=e?formDataHash.hasOwnProperty(e)?addToData(formDataHash[e]):wishList.trace("WLSendRequest.nodeNameHandler() formDataValue error, dataId "+e+" undefined in formData "):wishList.trace("WLSendRequest.nodeNameHandler() formDataValue error, dataId is undefined")}function formData(){wishList.checkoutPanel.insertFormaData(requestParams)}function asset(){var e=requestParamConf.getAttribute("id");if(e&&""!=e){var t=WishListProto.ContextManager().assetManager.getAsset(e);t&&""!=t?(null!=responseVars&&(t=WishListProto.WLUtils.resolveVars(t,responseVars,"$")),addToData(wishList.locale.resolveStrings(t))):wishList.trace("WLSendRequest - nodeNameHandler asset error, parameter "+requestId+" : asset "+e+" content is empty or undefined")}else wishList.trace("WLSendRequest - nodeNameHandler asset error : parameter "+requestId+", assetId not defined or empty")}function time(){addToData(WishListProto.WLUtils.getTimeStamp())}function date(){addToData(WishListProto.WLUtils.getTodayDate(requestParamConf))}function text(){temp=wishList.locale.resolveStrings(requestParamConf.textContent),temp=WishListProto.WLUtils.resolveVars(temp,formDataHash,"$"),addToData(WishListProto.ContextManager().resolveGlobalVars(temp))}function itemNum(){addToData(wishList.list.data.length)}function priceLabel(){addToData(wishList.list.getTotalPriceLabel())}function messagesHash(){var e=requestParamConf.getAttribute("labelId");e&&""!=e?(temp=wishList.locale.strings[e],temp=wishList.locale.resolveStrings(temp),temp=WishListProto.WLUtils.resolveVars(temp,formDataHash,"$"),addToData(WishListProto.ContextManager().resolveGlobalVars(temp))):wishList.trace("WLSendRequest - nodeNameHandler messagesHash error, parameter "+requestId+" : labelId not defined or empty")}for(var requestParams={},temp,formDataHash=wishList.checkoutPanel.insertFormaData({}),i=0;i<nodes.childNodes.length;i++){var requestParamConf=nodes.childNodes[i];if(1==requestParamConf.nodeType){var requestId=requestParamConf.getAttribute("requestId"),nestedNameFunction=eval(requestParamConf.nodeName);void 0!=nestedNameFunction?(nestedNameFunction(),requestId&&""!=requestId&&!requestParams[requestId]&&requestType!=JSON_TYPE&&wishList.trace("WLSendRequest - nodeNameHandler error, request param named "+requestId+" hasn't been created")):wishList.trace("WLSendRequest - nodeNameHandler error : "+requestParamConf.nodeName+" name handler is not declared")}}return requestParams}function serializeObject(e){var t=0,a="";for(var n in e)""!=a&&(a+="&"),a+=n+"="+e[n],t++;return{str:a,count:t}}var responseId,sendRequestConf,JSON_TYPE="application/json; charset=utf-8",ENCODED_FORM_TYPE="application/x-www-form-urlencoded; charset=utf-8",requestIndex,reponseType,requestType,responseVars,notificationSuccessTextId="confirmpopup_confirm_message",notificationFailureTextId="confirmpopup_error_message",callBackNotif,success;this.init=function(e){sendRequestConf=e,requestIndex=0},this.send=function(e){null!=e&&(callBackNotif=e);var t,a=sendRequestConf[requestIndex];t=null!=a.getAttribute("url")?WishListProto.ContextManager().resolveGlobalVars(a.getAttribute("url")):wishList.conf.sendCartUrl;var n;n=null!=a.getAttribute("method")?a.getAttribute("method"):"POST",requestType=null!=a.getAttribute("type")&&"json"==a.getAttribute("type")?JSON_TYPE:ENCODED_FORM_TYPE,reponseType=null!=a.getAttribute("reponseType")&&"json"==a.getAttribute("reponseType")?JSON_TYPE:ENCODED_FORM_TYPE,responseId=a.getAttribute("responseId"),(""==responseId||null==responseId)&&(responseId="response");var i=new XMLHttpRequest;i.open(n,t,!0);var r,o=nodeNameHandler(a);r=requestType==JSON_TYPE?{str:JSON.stringify(o)}:serializeObject(o),a.hasAttribute("username")&&a.hasAttribute("password")&&(i.withCredentials=!0,i.setRequestHeader("Authorization","Basic "+btoa(a.getAttribute("username")+":"+a.getAttribute("password")))),i.setRequestHeader("Content-type",requestType),i.observer=this,i.onreadystatechange=function(e){4==i.readyState&&(200==i.status?i.observer.onRequestResponse(i.responseText):wishList.trace("Erreur pendant le chargement de "+this.htmlItemTemplateUrl))},i.send(r.str)},this.onRequestResponse=function(e){if(reponseType==ENCODED_FORM_TYPE)response=parseResponse(e),success="true"==response[responseId]||"ok"==response[responseId]||"yes"==response[responseId]||"1"==response[responseId]?!0:!1;else if(reponseType==JSON_TYPE){var t=JSON.parse(e),a=getValueFromPath(t,responseId);null!=a?(success=!0,responseVars=getVarsFromStructure(t)):success=!1}return requestIndex<sendRequestConf.length-1?(requestIndex++,void this.send()):(requestIndex=0,
success?(showNotification(notificationSuccessTextId),wishList.list.deleteAll()):showNotification(notificationFailureTextId),void wishList.trace(""))}}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.WLListPanel=function(a){function n(e,t){if(-1!=e.indexOf(",")){var a=e.split(",");if(null!=t){for(var n=0;n<a.length;n++)if(-1!=a[n].indexOf(t))return a[n];return a[0]}return a[0]}return e}function i(e,t){var a=e.data[wishList.format.fieldsIndex.variant_id];a=""!=a&&null!=a?a:null;var i=n(e.data[wishList.format.fieldsIndex[v]],a).trim();""==i&&console.log("erreur image data"),t.imageUrl=f+i+b}function r(e,t){for(var a in wishList.format.fieldsIndex)t["data_"+a]=e.data[wishList.format.fieldsIndex[a]]}function o(){for(u=document.getElementById(S.productListContainerId);u.fisrtChild;)u.removeChild(u.fisrtChild);var e=document.getElementsByClassName("wishlist-cart-empty");e[0]&&e[0].parentElement.removeChild(e[0]),y=null}function s(){o(),u=document.getElementById(S.productListContainerId),y=[];for(var e=wishList.list.data,a=0;a<e.length;a++){var n=e[a],s=document.createElement("div"),l={change:"wishList.list.onQuantityChange(this.parentElement.parentElement.productData,this.value);wishList.listPanel.onQuantityChange(this.value,this.parentElement)",quantity:n.quantity,totalPrice:n.price.getLabel(n.quantity),unitPrice:n.price.getLabel(1)};l[M]="wishList.listPanel.onMinusClick(this)",l[P]="wishList.listPanel.onPlusClick(this)",l[x]="wishList.listPanel.onDeleteClick(this);wishList.listPanel.onListChanged()",g&&i(n,l),r(n,l);var c=t.WLUtils.resolveVars(S.htmlItemTemplate,l,S.separateChr),s=u.appendChild(s);s.outerHTML=c,s=u.lastChild,s.productData=n,y.push(s)}var d=document.getElementById(S.sendElementId);d.onclick=wishList.listPanel.onSendClicked,0==e.length?wishList.listPanel.displayEmptyLabel():document.getElementById(S.sendElementId).classList.remove("display-none")}function l(e){for(;-1==y.indexOf(e);)e=e.parentElement;return e}this.onViewOpen=a,this.productLine,this.buttons,this.listConf,this.displayTotal,this.elementId="productList",this.containerId="wishlist-cart",this.totalContainerId="wishListTotalPriceContainer",this.totalContainer,this.totalId="wishListTotalPrice",this.total="wishListTotalPrice",this.deleteAllId="deleteAllWishList",this.sendElementId="sendWishlist",this.separateChr="$";var u;this.htmlTemplateUrl,this.htmlTemplate,this.htmlItemTemplateUrl,this.htmlItemTemplate;var c,d,h,p=!1;this.productList;var g,m,f,v,b,y,w,C,M,P,x,S=this;this.init=function(e){this.listConf=e,this.productLine=this.listConf.querySelector("productline"),this.productList=this.listConf.querySelector("productList"),this.buttons=this.listConf.querySelector("buttons"),this.displayTotal=this.listConf.querySelector("totalPrice"),this.displayTotal&&(this.displayTotal=this.displayTotal.getAttribute("displayed"),this.displayTotal="true"==this.displayTotal),h=null!=e.getAttribute("header")?"true"==e.getAttribute("header"):h,d=null!=e.getAttribute("refresh")?"true"==e.getAttribute("refresh"):d;var a=this.listConf.getAttribute("htmlTemplate");if(this.htmlTemplateUrl=wishList.conf.templateUrl+a,this.productLine){var n=this.productLine.getAttribute("htmlItemTemplate");this.htmlItemTemplateUrl=wishList.conf.templateUrl+n}else if(this.productList){this.productListContainerId=this.productList.getAttribute("id");var i=this.productList.querySelector("item");null!=i&&(productListItemId=i.getAttribute("id"),this.htmlItemTemplate=wishList.templates.querySelector(productListItemId).firstChild.data,this.htmlItemTemplate=wishList.locale.resolveStrings(this.htmlItemTemplate),g=this.productList.querySelector("image"),g&&(m=g.getAttribute("id"),f=t.ContextManager().resolveGlobalVars(g.getAttribute("path")),v=g.getAttribute("propName"),b=g.getAttribute("extension")),w=this.productList.querySelector("quantity"),w&&(C=w.getAttribute("selector"),M=w.getAttribute("minusId"),P=w.getAttribute("plusId")),deleteConf=this.productList.querySelector("deleteButton"),deleteConf&&(x=deleteConf.getAttribute("id")))}},this.loadTemplate=function(){t.WLUtils.load(this.htmlTemplateUrl,this.onTemplateLoaded,this),null!=this.htmlItemTemplateUrl&&t.WLUtils.load(this.htmlItemTemplateUrl,this.onItemLoaded,this)},this.onTemplateLoaded=function(e){this.htmlTemplate=wishList.locale.resolveStrings(e),this.checkPreload(),wishList.trace("List template loaded")},this.checkPreload=function(){this.htmlTemplate&&(null==this.htmlItemTemplateUrl||this.htmlItemTemplate)&&(p=!0,this.onLoaded())},this.onLoaded=function(){c&&this.open()},this.onItemLoaded=function(e){this.htmlItemTemplate=wishList.locale.resolveStrings(e),this.checkPreload(),wishList.trace("List Item template loaded")},this.clearList=function(){if(u=document.getElementById(this.containerId),null!=u)for(var e=u.querySelectorAll("div"),t=0;t<e.length;t++)"wishlist-cart-item"==e[t].className&&e[t].parentElement.removeChild(e[t]);var a=document.getElementsByClassName("wishlist-cart-empty");a[0]&&a[0].parentElement.removeChild(a[0])},this.open=function(){if(!p)return c=!0,this.loadTemplate(),void e.Main.trackerManager.trackPage({name:"wishlist-list"});var a={close:"wishList.listPanel.close()"},n=t.WLUtils.resolveVars(S.htmlTemplate,a,S.separateChr);t.WLUtils.createPopup(this.elementId,n,null,d,h,{onload:function(){this.onViewOpen(this),this.productLine?this.bluidList():this.productList&&s()}.bind(this)})},this.close=function(){e.Class.LightboxManagerNew.close(this.elementId)},this.onDeleteClick=function(e){var t=l(e);wishList.list.removeProduct(t,t.productData)},this.onPlusClick=function(e){var t=l(e),a=t.querySelector(C),n=parseInt(a.value);t.productData.quantity=a.value=n+1},this.onMinusClick=function(e){var t=l(e),a=t.querySelector(C),n=parseInt(a.value);n>1&&(t.productData.quantity=a.value=n-1)},this.bluidList=function(){this.clearList();document.getElementById(this.elementId);u=document.getElementById(this.containerId),this.totalContainer=document.getElementById(this.totalContainerId),this.total=document.getElementById(this.totalId);var e=document.getElementById(this.deleteAllId);e.onclick=this.onDeleteAllClicked;for(var a=wishList.list.data,n=0;n<a.length;n++){var i=a[n],r=document.createElement("div");r.productData=i,r.className="wishlist-cart-item";var o={change:"wishList.list.onQuantityChange(this.parentElement.productData,this.value);wishList.listPanel.onQuantityChange(this.value,this.parentElement)",quantity:i.quantity,"delete":"wishList.list.removeProduct(this.parentElement,this.parentElement.productData);wishList.listPanel.onListChanged()",totalPrice:i.price.getLabel(i.quantity),unitPrice:i.price.getLabel(1)},s=0;for(var l in wishList.format.props)o[l]=i.data[wishList.data.headers[wishList.format.props[l]]],s++;r.innerHTML=t.WLUtils.resolveVars(this.htmlItemTemplate,o,this.separateChr),this.totalContainer?u.insertBefore(r,this.totalContainer):u.appendChild(r)}0==a.length?wishList.listPanel.displayEmptyLabel():document.getElementById(this.sendElementId).classList.remove("display-none");var c=document.getElementById(this.sendElementId);c.onclick=wishList.listPanel.onSendClicked,this.updateTotalPrice()},this.updateTotalPrice=function(){this.total&&(this.total.innerHTML=wishList.list.getTotalPriceLabel())},this.onListChanged=function(){wishList.listPanel.updateTotalPrice(),0===wishList.list.data.length&&this.displayEmptyLabel()},this.onSendClicked=function(){wishList.checkoutPanel.open(),wishList.trace("onSendClicked")},this.onDeleteAllClicked=function(){wishList.list.deleteAll(),u.innerHTML="",wishList.listPanel.displayEmptyLabel(),wishList.listPanel.onListChanged(),wishList.trace("onSendClicked")},this.displayEmptyLabel=function(){var e=document.createElement("div");e.className="wishlist-cart-empty text-big",e.innerText=wishList.locale.getString("shoplist_empty"),this.totalContainer?u.insertBefore(e,this.totalContainer):u.appendChild(e),document.getElementById(this.sendElementId).classList.add("display-none")},this.onQuantityChange=function(e,t){if(this.displayTotal){var a=t.getElementsByClassName("wishlist-cart-ttc");a[0]&&(a[0].innerHTML=t.productData.price.getLabel(parseInt(e)))}wishList.listPanel.onListChanged()}}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.WLCheckoutPanel=function(a){function n(e,t,a){b=[];for(var n=0;n<a.length;n++){var i=a[n];if(1==i.nodeType){var r=i.querySelector("label");if(r)var o=r.getAttribute("id");var s=i.querySelector("input");if(s)var l=s.getAttribute("id");var u=i.getAttribute("requestId");switch(i.nodeName){case"radiobutton":var c=r.textContent,d=i.querySelector("button");if(d)var h=d.getAttribute("id");var p=document.getElementById(h);p.setAttribute("name",u);var g=i.querySelector("data"),m=g.textContent;p.setAttribute("value",m);var f=document.getElementById(o);if(c=wishList.locale.resolveStrings(c),f.textContent=c,null!=v[u])if("array"!=typeof v[u]){var y=v[u];v[u]=[y,p]}else v[u].push(p);else v[u]=p;p.conf=i,p.parentElement.setAttribute("data-error",c.replace(/(\([^\)]+\))/gim,""));break;case"checkbox":break;case"statusfield":var w=document.getElementById(o);null!=w&&b.push(w);break;case"textfield":var c=s.textContent,f=document.getElementById(o),C=document.getElementById(l);C.setAttribute("name",u),c=wishList.locale.resolveStrings(c),C.setAttribute("placeHolder",c),v[u]=C,C.conf=i,C.parentElement.setAttribute("data-error",c.replace(/(\([^\)]+\))/gim,""))}}}}function i(e,a,n){for(var i=0;i<n.length;i++){var r=n[i];if(-1!=["combobox","textfield"].indexOf(r.nodeName)){if("combobox"==r.nodeName){var o="label"==r.getAttribute("requestType"),s=document.createElement("div");S.firstLineElement||(S.firstLineElement=s),s.className="form-field-wrapper";var l={inputName:r.getAttribute("requestId")};s.innerHTML=wishList.locale.resolveStrings(t.WLUtils.resolveVars(S.itemSelectTemplate,l,S.separateChr));for(var u=s.querySelector("select"),c=r.childNodes,d=0;d<c.length;d++){var h=c[d];if(3!=h.nodeType){var p=document.createElement("option"),g=document.createTextNode(h.firstChild.data);o||(p.value=h.getAttribute("data")),p.appendChild(g),u.appendChild(p)}}}else if("textfield"==r.nodeName){var s=document.createElement("div");null==S.firstLineElement&&(S.firstLineElement=s),s.className="form-field-wrapper";var l={label:r.querySelector("label").textContent,inputName:r.getAttribute("requestId")};s.innerHTML=wishList.locale.resolveStrings(t.WLUtils.resolveVars(S.itemTemplate,l,S.separateChr)),s.setAttribute("data-error",wishList.locale.resolveStrings(t.WLUtils.resolveVars(l.label,l,S.separateChr))),s.conf=r}v[r.getAttribute("requestId")]=s,a.appendChild(s)}}}function r(e){return null!=e}function o(e,t){return e.length<=t}function s(e){return""!=e}function l(e){return!isNaN(parseInt(e.split(" ").join("")))}function u(t){return e.Utils.mailStringToArray(t).length>0}function c(t){"input"===t.nodeName.toLowerCase()||"textarea"===t.nodeName.toLowerCase()?t.value=e.Utils.mailStringToArray(t.value).join(";"):!t.firstChild||"input"!==t.firstChild.nodeName&&"textarea"!==t.nodeName.toLowerCase()||(t.firstChild.value=e.Utils.mailStringToArray(t.firstChild.value).join(";"))}function d(e){var t=e.split("/"),a=Number(t[0]),n=Number(t[1]),i=Number(t[2]),r=!0,o=new Date(Number(i),Number(n)-1,Number(a)),s=new Date;return r=r&&o.getDate()==a,r=r&&o.getMonth()==n-1,r=r&&o.getFullYear()==i,r=r&&o.valueOf()>=s.valueOf()}function h(e){var t=v[e.getAttribute("name")];if(t instanceof Array)for(var a in t)if(t[a].checked)return t[a].value;return null}function p(e){return"radio"===e.getAttribute("type")?h(e):"input"===e.nodeName.toLowerCase()||"textarea"===e.nodeName.toLowerCase()?e.value:!e.firstChild||"input"!==e.firstChild.nodeName&&"textarea"!==e.firstChild.nodeName?void 0:e.firstChild.value}function g(e){m(e==L?!1:!0)}function m(e){for(var t=0;t<b.length;t++){var a=b[t];e?a.classList.remove("alert"):a.classList.add("alert")}}var f="Erreur de connexion. Veuillez ressayer ultrieurement.";this.onViewOpen=a,this.checkoutConf,this.sendClick="wishList.checkoutPanel.onSendClicked()",this.closeClick="wishList.checkoutPanel.onCloseClick()",this.elementId="wishListCheckout",this.containerId="fieldContainer",this.separateChr="$",this.elementTemplate,this.htmlTemplateUrl,this.itemTemplate,this.itemSelectTemplate;var v,b;this.firstLineElement;var y,w,C,M=!1,P=!0,x=5e3,S=this,L="invalid",I="valid",T=".webpub-wlpanel-form__mandatory-comments-content",_=".webpub-wlpanel-form__complete";this.init=function(e){this.checkoutConf=e,this.htmlTemplateUrl=wishList.conf.templateUrl+this.checkoutConf.getAttribute("htmlTemplate"),P=null!=this.checkoutConf.getAttribute("header")?"true"==this.checkoutConf.getAttribute("header"):P,x=e.hasAttribute("requestEndCloseDelay")?parseInt(e.getAttribute("requestEndCloseDelay"),10):x,y=this.checkoutConf.getAttribute("generateHtmlFields"),y=null!=y?"true"==y:!0,this.itemTemplate=wishList.templates.querySelector("checkoutItem").firstChild.data,this.itemSelectTemplate=wishList.templates.querySelector("checkoutSelectItem"),this.itemSelectTemplate&&(this.itemSelectTemplate=this.itemSelectTemplate.firstChild.data)},this.loadTemplate=function(){t.WLUtils.load(this.htmlTemplateUrl,this.onTemplateLoaded,this)},this.onLoaded=function(){w&&this.open()},this.onTemplateLoaded=function(a){var n={};n.containerId=this.containerId,n.sendClick=this.sendClick,n.closeClick=this.closeClick,this.elementTemplate=wishList.locale.resolveStrings(t.WLUtils.resolveVars(a,n,"$")),M=!0,this.onLoaded();for(var i=document.querySelectorAll(".webpub-wlpanel__form input, .webpub-wlpanel__form textarea"),r=function(){var t,a=e.Utils.getClosestByClass(this,"alert");if(a)if("radio"===this.type){t=document.querySelectorAll(".webpub-wlpanel__form input[name='"+this.name+"']");for(var n=t.length;n--;)a=e.Utils.getClosestByClass(t[n],"alert"),a&&a.classList.remove("alert")}else"checkbox"===this.type&&a.classList.remove("alert")},o=function(){var t=e.Utils.getClosestByClass(this,"alert");t&&this.value.length>0&&t.classList.remove("alert")},s=i.length;s--;)"radio"===i[s].type||"checkbox"===i[s].type?i[s].addEventListener("change",r):i[s].addEventListener("keyup",o);wishList.trace("Checkout template loaded")},this.open=function(){return M?void t.WLUtils.createPopup(this.elementId,this.elementTemplate,null,!1,P,{onload:function(e){this.onViewOpen(this);var t=e[0],a=document.getElementById(this.containerId),r=document.getElementById("wishListCheckoutSubmit"),o=this.checkoutConf.childNodes;v={},y?i(t,a,o):n(t,a,o),C=$(e).find(T)[0],r&&r.addEventListener("click",function(){wishList.checkoutPanel.onSendClicked()})}.bind(this)}):(e.Main.trackerManager.trackPage({name:"wishlist-checkout"}),w=!0,void this.loadTemplate())},this.validate=function(){var e=!0;for(var t in v){var a=v[t];if(a instanceof Array){elements=a}else{if(!a.conf)continue;elements=[a]}for(var n=0;n<elements.length;n++){for(var a=elements[n],i=a.conf,h=i.querySelector("validation"),g=!0,m=p(a),f=0;f<h.childNodes.length;f++){var b=h.childNodes[f];if(1==b.nodeType)switch(b.nodeName){case"isMaxLength":g=g&&o(m,parseInt(b.getAttribute("value")));break;case"isNonEmpty":g=g&&s(m);break;case"isOnlyNumber":g=g&&l(m);break;case"isMail":g=g&&u(m),c(a);break;case"isMultipleMail":g=g&&u(m),c(a);break;case"isSet":g=g&&r(m);break;case"isDate":g=g&&d(m)}}var y;y="input"==a.nodeName.toLowerCase()?a.parentElement:a,g?y.classList.remove("alert"):y.classList.add("alert"),e=e&&g}}return e},this.getFormData=function(){return v},this.insertFormaData=function(e){for(var t in v)if(v[t]instanceof Array)for(var a=0;a<v[t].length;a++)e[t]=p(v[t][a]);else e[t]=p(v[t]);return e},this.close=function(){e.Class.LightboxManagerNew.close(this.elementId),e.Class.LightboxManagerNew.close(wishList.listPanel.elementId)},this.onCloseClick=function(){this.close()},this.onSendClicked=function(){this.validate()?(e.Main.trackerManager.trackEvent({name:"wishlist-submitted"}),wishList.sendRequest.send(this.onRequestEnd),g(I),C&&(document.querySelector(".webpub-wlpanel-cart-view__button").style.display="none")):g(L)},this.onRequestEnd=function(e,t){if(document.querySelector(".webpub-wlpanel-cart-view__button").style.display="block",C){if(e){C.innerHTML=t;for(var a=document.querySelectorAll(".webpub-wlpanel__form input, .webpub-wlpanel__form textarea"),n=a.length;n--;)a[n].value="",a[n].checked=!1;setTimeout(function(e){for(var t=!1,a=document.querySelectorAll(".webpub-wlpanel__form input, .webpub-wlpanel__form textarea"),n=a.length;n--;)if(("radio"===a[n].type||"checkbox"===a[n].type)&&a[n].checked||a[n].value.length>0){t=!0;break}t===!1&&e.close()}.bind({},S),x)}else C.innerHTML=f;C.parentElement.classList.add(_.substr(1))}else S.close()}}}(webpublicationNamespace),function(e){var t=e.Class.WishList.prototype;t.WLAddPanel=function(a){function n(e){if(V=e,q=wishList.conf.templateUrl+e.getAttribute("htmlTemplate"),oe=e.querySelector("buttons"),oe&&(se=null==oe.getAttribute("htmlHandler")?!0:"true"==oe.getAttribute("htmlHandler")),j=e.querySelector("productline"),j&&(H=wishList.templates.querySelector("addPanelStringField").firstChild.data,X=wishList.templates.querySelector("addPanelQuantityField").firstChild.data,W=wishList.templates.querySelector("addPanelTotalField").firstChild.data),J=e.querySelector("quantityComment"),te=wishList.templates.querySelector("checkoutItem"),te&&(te=te.firstChild.data),wt=null!=e.getAttribute("header")?"true"==e.getAttribute("header"):wt,Ct=null!=e.getAttribute("refresh")?"true"==e.getAttribute("refresh"):Ct,Y=e.querySelector("image")){le=Y.getAttribute("path"),le=t.ContextManager().resolveGlobalVars(le),ue=Y.getAttribute("thumbnailsPath"),ue=t.ContextManager().resolveGlobalVars(ue),ce=Y.getAttribute("extension"),de=Y.getAttribute("propName");var a=Y.querySelector("updateVariantRef");Pt=null==a?!1:!0,Pt&&(Ae=a.getAttribute("id"),De=a.getAttribute("propName"),Ne=a.getAttribute("value"));var n=Y.querySelector("arrows");n&&(he=n.getAttribute("nextId"),pe=n.getAttribute("prevId"));var i=Y.querySelector("mediumImage");i&&(ge=i.getAttribute("id"));var r=Y.querySelector("thumbnails");r&&(me=r.getAttribute("id"),thumbnailsItemId=r.getAttribute("itemId"),qe=r.getAttribute("classListAddSelected"),thumbnailsTemplate=wishList.templates.querySelector(thumbnailsItemId).firstChild.data)}Z=e.querySelectorAll("imageList"),fe=[];for(var o=0;o<Z.length;o++)fe[o]={},fe[o].id=Z[o].getAttribute("id"),fe[o].path=t.ContextManager().resolveGlobalVars(Z[o].getAttribute("path")),fe[o].extension=Z[o].getAttribute("extension"),fe[o].propName=Z[o].getAttribute("propName"),fe[o].template=wishList.templates.querySelector(Z[o].getAttribute("itemId")).firstChild.data;if(Q=e.querySelector("productData"),Q&&(ve="true"==Q.getAttribute("loadAll")),$=e.querySelector("extendableText")){be=$.getAttribute("id"),ye=$.getAttribute("buttonId");var s=$.querySelector("content");we=s.getAttribute("readLessContent"),Ce=s.getAttribute("readMoreContent");var l=$.querySelector("maxChar");Me=parseInt(l.getAttribute("value")),Pe="true"==l.getAttribute("autoHideButton")}if(K=e.querySelector("variantList")){xe=K.getAttribute("id");var u=K.querySelector("item");u&&(Se=u.getAttribute("id"),variantListItemTemplate=wishList.templates.querySelector(Se).firstChild.data),ke=K.querySelector("quantity"),ke&&(Le=ke.getAttribute("minusId"),Ie=ke.getAttribute("plusId"),Ee=ke.getAttribute("class"));var c=K.querySelector("button");c&&(Te=c.getAttribute("id"),_e=c.getAttribute("label"),Oe=c.getAttribute("onClick"))}var d=e.querySelectorAll("hideIfEmpty");if(d){Re={};for(var o=0;o<d.length;o++){var h=d[o];Re[h.getAttribute("propName")]=h.getAttribute("id")}}}function i(){t.WLUtils.load(q,o,$e)}function r(){ie&&$e.open(ie)}function o(e){var a={};a.onOkCode=lt,a.onCancelCode=ut,a.onSelectionCode=it,a.onThumbNextDownCode=dt,a.onThumbNextUpCode=ht,a.onThumbPrevDownCode=pt,a.onThumbPrevUpCode=gt,a.onExtendableClickCode=mt,B=t.WLUtils.resolveVars(e,a,"$"),B=wishList.locale.resolveStrings(B),wishList.trace("Add template loaded"),yt=!0,r()}function s(){if(null!=ee){for(var e=[],t=0;t<ee.length;t++){var a=ee[t],n=a.firstChild.value;""!=n&&e.push(n)}return e.join(",")}}function l(){if(oe&&se){var e=document.getElementById(Je);e.productId=R,e.onclick=$e.onOkClick;var t=document.getElementById(et);t.onclick=$e.onCancelClick}}function u(e,t){null==t&&(t=re.data);for(var a in wishList.format.fieldsIndex)e[a]=t[wishList.format.fieldsIndex[a]].replace(/\n/gim,"<br />")}function c(e){if(-1!=e.indexOf(",")){var t=e.split(",");return t[0]}return e}function d(e){var t=c(re.data[wishList.format.fieldsIndex[de]]).trim();e.imageUrl=le+t+ce}function h(){for(var e in Re){var t=document.getElementById(Re[e]);""==re.data[wishList.format.fieldsIndex[e]]?t&&(t.style.display="none"):t&&(t.style="")}}function p(){var e=document.getElementById(be);if(null!==e){var t=document.getElementById("addPanelExtendableTextButton");e.clientHeight===e.scrollHeight&&(t.style.display="none")}}function g(){if(Ye=[],Ze=[],K)for(var e=document.getElementById(xe),a=re.variants,n=0;n<a.length;n++){var i=a[n],r={};r.onVariantClickCode=ft,r.onVariantPlusClickCode=vt,r.onVariantMinusClickCode=bt,u(r),u(r,i);var o=t.WLUtils.resolveVars(variantListItemTemplate,r,"$");o=wishList.locale.resolveStrings(o);var s=document.createElement("div");e.appendChild(s),s.outerHTML=o,s=e.lastChild,Ye.push(s),Ze.push({productData:re,variant:i})}}function m(e,t){var a=e.querySelector("."+Ee),n=parseInt(a.value)+t;n=1>n?1:n,z=a.value=n}function f(){var t=wishList.locale.getString(Mt);e.Utils.toast({text:t,duration:3e3})}function v(e){for(;-1==Ye.indexOf(e);)e=e.parentElement;return e}function b(e){P()}function y(){for(var e=0;e<fe.length;e++){var a=fe[e],n=document.getElementById(a.id),i=re.data[wishList.format.fieldsIndex[a.propName]];if(i){i=i.trim().split(",");for(var r=0;r<i.length;r++)if(""!=i[e]){var o={};o.imageUrl=a.path+i[r].trim()+a.extension;var s=t.WLUtils.resolveVars(a.template,o,"$"),l=document.createElement("div");n.appendChild(l),l.outerHTML=s}}}}function w(){if(null!=Y){Fe=document.getElementById(me),Ue=Fe.parentElement,Ge=[];var e=re.data[wishList.format.fieldsIndex[de]];e=e.split(",");for(var a=0;a<e.length;a++){var n={};n.onClickCode=ct,n.imageFileName=e[a].trim(),n.imageUrl=ue+e[a]+ce;var i=t.WLUtils.resolveVars(thumbnailsTemplate,n,"$"),r=document.createElement("div");Fe.appendChild(r),r.outerHTML=i,r=Fe.lastChild,r.values=n,Ge.push(r)}Be=document.getElementById(pe),Ve=document.getElementById(he),Fe.addEventListener("scroll",b)}}function C(e){return startInterpolation=startInterpolation||e,We&&e-startInterpolation>Xe/2?(startInterpolation=e-Xe/2,elapsed=Xe/2,ze=Fe.scrollLeft-.7*He,Fe.scrollLeft+=(e-lastTimeStamp)/Xe*He,je=window.requestAnimationFrame(C),void(lastTimeStamp=e)):(elapsed=e-startInterpolation,lastTimeStamp=e,elapsed>=Xe?(Fe.scrollLeft=ze+He,void(startInterpolation=null)):(Fe.scrollLeft=M(elapsed,ze,He,Xe),void(je=window.requestAnimationFrame(C))))}function M(e,t,a,n){return-a*(e/=n)*(e-2)+t}function P(){if(Be&&Ve){if(Ue.scrollWidth>=Fe.scrollWidth)return Be.style.display="none",void(Ve.style.display="none");Be.style.display=Fe.scrollLeft<=0?"none":"",Ve.style.display=Fe.scrollLeft>=Fe.scrollWidth-Ue.scrollWidth?"none":""}}function x(e){if(Pt&&re.variants){-1!=e.src.indexOf(re.id)&&S(re.id);for(var t=0;t<re.variants.length;t++)productRecord=re.variants[t],variantId=productRecord[wishList.format.fieldsIndex[De]],-1!=e.src.indexOf(variantId)&&S(variantId)}}function S(e){var a={id:e},n=t.WLUtils.resolveVars(Ne,a,"$");n=wishList.locale.resolveStrings(n),L(n)}function L(e){var t=document.getElementById(Ae);t.textContent=e}function I(e){var t=document.getElementById(ge),a=t.querySelector("img");return a.src=le+e.trim()+ce,a}function T(e){var t=I(e.values.imageFileName);x(t)}function _(){if(Ge)for(var e=0;e<Ge.length;e++)Ge[e].classList.remove(qe)}function O(e){"undefined"==typeof e&&(e=document.querySelector(".webpub-wlpanel-product-slider__item-product")),e&&(_(),e.classList.add(qe))}function k(){null!=j&&null!=J&&(ee=[],N(z))}function E(){if(null!=j){G=document.getElementById(tt),G.innerHTML="",G.productId=R,G.productData=re;for(var e=0;e<j.childNodes.length;e++){var a=j.childNodes[e];if(1==a.nodeType){var n=wishList.locale.resolveStrings(a.getAttribute("header")),i=a.getAttribute("dataId");if(null!=i)var r=re.data[wishList.format.fieldsIndex[i]];var o,s={label:n,value:r,onChangeCode:rt,onPlusClickCode:st,onMinusClickCode:ot};switch(a.nodeName){case"string":o=H;break;case"quantity":s.value=1,o=X;break;case"totalprice":o=W,s.value=re.price.getLabel(1),s.id=at}o=t.WLUtils.resolveVars(o,s,"$");var l=document.createElement("div");G.appendChild(l),l.outerHTML=o,l=G.lastChild,"quantity"==a.nodeName&&(ne=l);var u=a.getAttribute("htmlClass"),c=l.className;!u||c&&""!=c||(l.className=u)}}}}function N(e){ae=e;for(var t=[],a=Math.max(e,ee.length),n=0;a>n;n++)n>=ee.length?A():n>=e&&t.push(ee[n]);for(ee.length=e,n=0;n<t.length;n++){var i=t[n];D(i)}}function A(){var e=document.createElement("div");e.className="form-field-wrapper";var a={label:J.getAttribute("placeHolder")};e.innerHTML=wishList.locale.resolveStrings(t.WLUtils.resolveVars(te,a,nt)),e.setAttribute("style","margin-top:1rem"),e=G.insertBefore(e,ne.nextSibling);e.querySelector("input");ee.push(e)}function D(e){G.removeChild(e)}function F(){var e=document.getElementById("addPanelQuantity");e.value=z}function U(){var e=document.getElementById(at);e&&(e.innerHTML=re.price.getLabel(z)),null!=J&&N(z)}var G,q,B,V,R,z,H,X,W,j,Y,Z,Q,$,K,J,ee,te,ae,ne,ie,re,oe,se,le,ue,ce,de,he,pe,ge,me,fe,ve,be,ye,we,Ce,Me,Pe,xe,Se,Le,Ie,Te,_e,Oe,ke,Ee,Ne,Ae,De,Fe,Ue,Ge,qe,Be,Ve,Re,ze,He,Xe,We,je,Ye,Ze,Qe=a,$e=this,Ke="addPanelPopup",Je="addPanelPopupButton",et="addPanelPopupCancelButton",tt="addPanelFieldContainer",at="wishlistAddPanelPrice",nt="$",it="wishList.listPanel.open();",rt="wishList.addPanel.onQuantityChange(this.value);",ot="wishList.addPanel.onMinusClick();",st="wishList.addPanel.onPlusClick();",lt="wishList.addPanel.onOkClick();",ut="wishList.addPanel.onCancelClick();",ct="wishList.addPanel.onThumbClick(this);",dt="wishList.addPanel.onThumbNextDown();",ht="wishList.addPanel.onThumbNextUp();",pt="wishList.addPanel.onThumbPrevDown();",gt="wishList.addPanel.onThumbPrevUp();",mt="wishList.addPanel.onExtendableClick(this);",ft="wishList.addPanel.onVariantClick(this);",vt="wishList.addPanel.onVariantPlusClick(this);",bt="wishList.addPanel.onVariantMinusClick(this);",yt=!1,wt=!0,Ct=!1,Mt="tooltip_product_added",Pt=!1;this.init=function(t){n(t),window.addEventListener(e.Param.eventResize,p)},this.onOkClick=function(){wishList.list.addProductInMemory(R,z,s()),wishList.conf.autoCloseAfterAddProduct&&$e.close()},this.onCancelClick=function(){$e.close()},this.close=function(){e.Class.LightboxManagerNew.close(Ke)},this.open=function(a){if(wishList.pageProductsPanel.isVisible()!==!0&&wishList.pageProductsPanel.isActivated()===!0&&wishList.pageProductsPanel.onToggleOpen(),re=wishList.data.getProductById(a),!yt)return e.Main.trackerManager.trackPage({name:"wishlist-product",variables:{1:a}}),ie=a,void i();R=a;var n={};Y&&d(n),ve&&u(n);var r=t.WLUtils.resolveVars(B,n,"$"),o=wishList.locale.getString("addpopup_title");t.WLUtils.createPopup(Ke,r,o,Ct,wt,{onload:function(){Qe(this),z=1,w(),l(),E(),k(),y(),g(),p(),h(),P(),O(),document.querySelector(".webpub-wlpanel-product__description-wrapper").scrollTop=1}})},this.onVariantClick=function(e){var t,a=v(e),n=a.querySelector("input");t=n?parseInt(n.value):1;var i=Ze[Ye.indexOf(a)];wishList.list.addProductInMemory(i.productData.id,t,s(),i.variant),f(),wishList.conf.autoCloseAfterAddProduct&&$e.close()},this.onVariantPlusClick=function(e){{var t=v(e);Ze[Ye.indexOf(t)]}m(t,1)},this.onVariantMinusClick=function(e){{var t=v(e);Ze[Ye.indexOf(t)]}m(t,-1)},this.onExtendableClick=function(e){var t=document.getElementById(be);t&&(t.classList.toggle("webpub-wlpanel-product__description-expanded"),e.textContent=wishList.locale.resolveStrings(t.classList.contains("webpub-wlpanel-product__description-expanded")?we:Ce))},this.onThumbNextDown=function(){if(Ue&&Ue.scrollWidth>0){var e=Fe.scrollWidth-Ue.scrollWidth,t=Ue.offsetWidth/2;We=!0,startInterpolation=null,ze=Fe.scrollLeft,He=Fe.scrollLeft+t>e?e-Fe.scrollLeft:t,Xe=550,null!=je&&cancelAnimationFrame(je),je=window.requestAnimationFrame(C)}},this.onThumbNextUp=function(){We=!1},this.onThumbPrevDown=function(){if(Ue&&Fe.scrollLeft>0){var e=Ue.offsetWidth/2;We=!0,startInterpolation=null,ze=Fe.scrollLeft,He=Fe.scrollLeft-e<-Fe.scrollLeft?0:-e,Xe=550,null!=je&&cancelAnimationFrame(je),je=window.requestAnimationFrame(C)}},this.onThumbPrevUp=function(){We=!1},this.onThumbClick=function(e){O(e),T(e)},this.onQuantityChange=function(e){z=parseInt(e),U()},this.onMinusClick=function(){z>1&&(z--,U(),F())},this.onPlusClick=function(){z++,U(),F()}}}(webpublicationNamespace);